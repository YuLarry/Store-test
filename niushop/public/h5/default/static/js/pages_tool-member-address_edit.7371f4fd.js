(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_tool-member-address_edit"],{"013c":function(t,e,a){"use strict";a("c975"),a("a9e3"),a("acd8"),a("ac1f"),a("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={type:"scrolldone",target:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},currentTarget:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},detail:{}},r={props:{backgroundTextStyle:{type:String,default:"dark",validator:function(t){return-1!==["dark","light"].indexOf(t)}},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created:function(){var t=this,e=getCurrentPages()[0];this.$pageVm=e.$vm||e,uni.onWindowResize((function(e){t.$emit("resize",e)})),this.$pageVm.$on("hook:onPageScroll",(function(e){t.$emit("scroll",e)})),this.$watch("backgroundTextStyle",(function(){t.setBackgroundTextStyle()})),this.$watch((function(){return[t.rootFontSize,t.pageStyle]}),(function(){t.setPageMeta()})),this.$watch((function(){return[t.backgroundColor,t.backgroundColorTop,t.backgroundColorBottom]}),(function(){t.setBackgroundColor()})),this.$watch((function(){return[t.scrollTop,t.scrollDuration]}),(function(){t.pageScrollTo()}))},beforeMount:function(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle(),this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh:function(t,e){t.setStyle({pullToRefresh:{support:e,style:"Android"===plus.os.name?"circle":"default"}})},setPageMeta:function(){uni.setPageMeta({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle:function(){},setBackgroundColor:function(){},pageScrollTo:function(){var t=this,e=String(this.scrollTop);if(-1!==e.indexOf("rpx")&&(e=uni.upx2px(e.replace("rpx",""))),e=parseFloat(e),!isNaN(e)){var a=function a(r){r.scrollTop===e&&(t.$pageVm.$off("hook:onPageScroll",a),t.$emit("scrolldone",i))};uni.pageScrollTo({scrollTop:e,duration:this.scrollDuration,success:function(){t.$pageVm.$on("hook:onPageScroll",a)}})}}}};e.default=r},2682:function(t,e,a){var i=a("fa2e");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("4f06").default;r("5257ff1e",i,!0,{sourceMap:!1,shadowMode:!1})},"59f26":function(t,e,a){"use strict";a.r(e);var i=a("8d73"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},"6b89":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var i={pageMeta:a("6d42").default,pickRegions:a("a0c7").default,loadingCover:a("d1a6").default},r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("page-meta",{attrs:{"page-style":t.themeColor}}),a("v-uni-view",{staticClass:"address-edit-content"},[a("v-uni-view",{staticClass:"edit-wrap"},[a("v-uni-view",{staticClass:"tip"},[t._v("地址信息")]),a("v-uni-view",{staticClass:"edit-item"},[a("v-uni-text",{staticClass:"tit"},[t._v(t._s(t.$lang("consignee"))),a("v-uni-text",[t._v("*")])],1),a("v-uni-input",{staticClass:"uni-input",attrs:{type:"text","placeholder-class":"placeholder-class",placeholder:t.$lang("consigneePlaceholder"),maxlength:"30",name:"name"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("v-uni-view",{staticClass:"edit-item"},[a("v-uni-text",{staticClass:"tit"},[t._v(t._s(t.$lang("mobile"))),a("v-uni-text",[t._v("*")])],1),a("v-uni-input",{staticClass:"uni-input",attrs:{type:"number","placeholder-class":"placeholder-class",placeholder:t.$lang("mobilePlaceholder"),maxlength:"11"},model:{value:t.formData.mobile,callback:function(e){t.$set(t.formData,"mobile",e)},expression:"formData.mobile"}})],1),a("v-uni-view",{staticClass:"edit-item"},[a("v-uni-text",{staticClass:"tit"},[t._v(t._s(t.$lang("telephone")))]),a("v-uni-input",{staticClass:"uni-input",attrs:{type:"text","placeholder-class":"placeholder-class",placeholder:t.$lang("telephonePlaceholder"),maxlength:"20"},model:{value:t.formData.telephone,callback:function(e){t.$set(t.formData,"telephone",e)},expression:"formData.telephone"}})],1),2==t.localType?[a("v-uni-view",{staticClass:"edit-item"},[a("v-uni-text",{staticClass:"tit"},[t._v(t._s(t.$lang("receivingCity"))),a("v-uni-text",[t._v("*")])],1),a("v-uni-view",{staticClass:"text_inp",class:{empty:!t.formData.full_address,"color-tip":!t.formData.full_address},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectAddress.apply(void 0,arguments)}}},[t._v(t._s(t.formData.full_address?t.formData.full_address:"请选择省市区县"))]),a("v-uni-text",{staticClass:"padding-left iconfont iconlocation",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectAddress.apply(void 0,arguments)}}})],1)]:[a("v-uni-view",{staticClass:"edit-item"},[a("v-uni-text",{staticClass:"tit"},[t._v(t._s(t.$lang("receivingCity"))),a("v-uni-text",[t._v("*")])],1),a("pick-regions",{attrs:{"default-regions":t.defaultRegions},on:{getRegions:function(e){arguments[0]=e=t.$handleEvent(e),t.handleGetRegions.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"select-address ",class:{empty:!t.formData.full_address,"color-tip":!t.formData.full_address}},[t._v(t._s(t.formData.full_address?t.formData.full_address:"请选择省市区县"))])],1)],1)],a("v-uni-view",{staticClass:"edit-item"},[a("v-uni-text",{staticClass:"tit"},[t._v(t._s(t.$lang("address"))),a("v-uni-text",[t._v("*")])],1),a("v-uni-input",{staticClass:"uni-input",attrs:{type:"text","placeholder-class":"placeholder-class",placeholder:t.$lang("addressPlaceholder"),maxlength:"50"},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address",e)},expression:"formData.address"}})],1)],2),a("v-uni-view",{staticClass:"btn"},[a("v-uni-button",{staticClass:"add",attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveAddress.apply(void 0,arguments)}}},[t._v(t._s(t.$lang("save")))])],1),a("loading-cover",{ref:"loadingCover"})],1)],1)},n=[]},"6d42":function(t,e,a){"use strict";a.r(e);var i=a("dfd6"),r=a("8f28");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);var s,l=a("f0c5"),o=Object(l["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=o.exports},7963:function(t,e,a){"use strict";a.r(e);var i=a("6b89"),r=a("59f26");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("c3b2");var s,l=a("f0c5"),o=Object(l["a"])(r["default"],i["b"],i["c"],!1,null,"3a8783b1",null,!1,i["a"],s);e["default"]=o.exports},"8d73":function(t,e,a){"use strict";var i=a("4ea4");a("ac1f"),a("841c"),a("1276"),a("498a"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a("a0c7")),n=i(a("e211")),s=i(a("9114")),l={components:{pickRegions:r.default},data:function(){return{formData:{id:0,name:"",mobile:"",telephone:"",province_id:"",city_id:"",district_id:"",community_id:"",address:"",full_address:"",latitude:0,longitude:0,is_default:1},address:"",addressValue:"",back:"",redirect:"redirectTo",flag:!1,defaultRegions:[],localType:1}},onLoad:function(t){if(t.back&&(this.back=t.back),t.redirect&&(this.redirect=t.redirect),t.type&&(this.localType=t.type),t.id&&!t.name)this.formData.id=t.id,this.getAddressDetail();else if(t.name){uni.getStorageSync("addressInfo")&&(this.formData=uni.getStorageSync("addressInfo")),this.formData.address=t.name,this.localType=2,this.getAddress(t.latng);var e=this.getQueryVariable("latng").split(",");this.formData.latitude=e[0],this.formData.longitude=e[1]}else this.$refs.loadingCover&&this.$refs.loadingCover.hide()},onBackPress:function(){uni.setStorageSync("addressInfo","")},onShow:function(){this.formData.id?uni.setNavigationBarTitle({title:"编辑收货地址"}):uni.setNavigationBarTitle({title:"新增收货地址"})},onReady:function(){this.$refs.loadingCover.hide()},onHide:function(){this.flag=!1},methods:{getAddressDetail:function(){var t=this;this.$api.sendRequest({url:"/api/memberaddress/info",data:{id:this.formData.id},success:function(e){var a=e.data;null!=a&&(t.formData.name=a.name,t.formData.mobile=a.mobile,t.formData.telephone=a.telephone,t.formData.address=a.address,t.formData.full_address=a.full_address,t.formData.latitude=a.latitude,t.formData.longitude=a.longitude,t.formData.is_default=a.is_default,t.localType=a.type,t.defaultRegions=[a.province_id,a.city_id,a.district_id]),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},getAddress:function(t){var e=this;this.$api.sendRequest({url:"/api/memberaddress/tranAddressInfo",data:{latlng:t},success:function(t){0==t.code?(e.formData.full_address="",e.formData.full_address+=void 0!=t.data.province?t.data.province:"",e.formData.full_address+=void 0!=t.data.city?"-"+t.data.city:"",e.formData.full_address+=void 0!=t.data.district?"-"+t.data.district:"",e.addressValue="",e.addressValue+=void 0!=t.data.province_id?t.data.province_id:"",e.addressValue+=void 0!=t.data.city_id?"-"+t.data.city_id:"",e.addressValue+=void 0!=t.data.district_id?"-"+t.data.district_id:""):e.showToast({title:"数据有误"})}})},handleGetRegions:function(t){this.formData.full_address="",this.formData.full_address+=void 0!=t[0]?t[0].label:"",this.formData.full_address+=void 0!=t[1]?"-"+t[1].label:"",this.formData.full_address+=void 0!=t[2]?"-"+t[2].label:"",this.addressValue="",this.addressValue+=void 0!=t[0]?t[0].value:"",this.addressValue+=void 0!=t[1]?"-"+t[1].value:"",this.addressValue+=void 0!=t[2]?"-"+t[2].value:""},selectAddress:function(){var t=this.formData;uni.setStorageSync("addressInfo",t);var e=s.default.h5Domain+"/pages_tool/member/address_edit?type="+this.localType;this.formData.id&&(e+="&id="+this.formData.id),this.back&&(e+="&back="+this.back),window.location.href="https://apis.map.qq.com/tools/locpicker?search=1&type=0&backurl="+encodeURIComponent(e)+"&key="+s.default.mpKey+"&referer=myapp"},getQueryVariable:function(t){for(var e=window.location.search.substring(1),a=e.split("&"),i=0;i<a.length;i++){var r=a[i].split("=");if(r[0]==t)return r[1]}return!1},vertify:function(){this.formData.name=this.formData.name.trim(),this.formData.mobile=this.formData.mobile.trim(),this.formData.address=this.formData.address.trim();var t=[{name:"name",checkType:"required",errorMsg:"请输入姓名"},{name:"mobile",checkType:"required",errorMsg:"请输入手机号"},{name:"mobile",checkType:"phoneno",errorMsg:"请输入正确的手机号"},{name:"full_address",checkType:"required",errorMsg:"请选择省市区县"},{name:"address",checkType:"required",errorMsg:"详细地址不能为空"}],e=n.default.check(this.formData,t);return!!e||(this.$util.showToast({title:n.default.error}),this.flag=!1,!1)},saveAddress:function(){var t=this;if(!this.flag&&(this.flag=!0,this.vertify())){var e=this.addressValue.split("-"),a={},i="";a={name:this.formData.name,mobile:this.formData.mobile,telephone:this.formData.telephone,province_id:e[0],city_id:e[1],district_id:e[2]?e[2]:"",community_id:0,address:this.formData.address,full_address:this.formData.full_address,latitude:this.formData.latitude,longitude:this.formData.longitude,is_default:this.formData.is_default,type:this.localType},i="add",this.formData.id&&(i="edit",a.id=this.formData.id,""!=this.back&&(a.is_default=1)),this.$api.sendRequest({url:"/api/memberaddress/"+i,data:a,success:function(e){t.flag=!1,0==e.code?(""!=t.back?t.$util.redirectTo(t.back,{},"redirectTo"):(t.$util.showToast({title:e.message}),uni.navigateBack({delta:1})),uni.removeStorageSync("addressInfo")):t.$util.showToast({title:e.message})},fail:function(e){t.flag=!1}})}}}};e.default=l},"8f28":function(t,e,a){"use strict";a.r(e);var i=a("013c"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},a0c7:function(t,e,a){"use strict";a.r(e);var i=a("ad86"),r=a("d4d4");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);var s,l=a("f0c5"),o=Object(l["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=o.exports},ad86:function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"pick-regions"},[a("v-uni-picker",{attrs:{mode:"multiSelector",value:t.multiIndex,range:t.multiArray},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.handleValueChange.apply(void 0,arguments)},columnchange:function(e){arguments[0]=e=t.$handleEvent(e),t.handleColumnChange.apply(void 0,arguments)}}},[t._t("default")],2)],1)},n=[]},c3b2:function(t,e,a){"use strict";var i=a("2682"),r=a.n(i);r.a},c92d:function(t,e,a){"use strict";var i=a("4ea4");a("4160"),a("d81d"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a("3835"));a("96cf");var n=i(a("1da1")),s={props:{defaultRegions:{type:Array},selectArr:{type:String}},data:function(){return{pickerValueArray:[],cityArr:[],districtArr:[],multiIndex:[0,0,0],isInitMultiArray:!1,isLoadDefaultAreas:!1}},watch:{defaultRegions:{handler:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];3===t.length&&t.join("")!==e.join("")&&this.handleDefaultRegions()},immediate:!0}},computed:{multiArray:function(){if(this.isLoadDefaultAreas){var t=this.pickedArr.map((function(t){return t.map((function(t){return t.label}))}));return t}},pickedArr:function(){return this.isInitMultiArray?"2"==this.selectArr?[this.pickerValueArray[0],this.pickerValueArray[1]]:[this.pickerValueArray[0],this.pickerValueArray[1],this.pickerValueArray[2]]:"2"==this.selectArr?[this.pickerValueArray[0],this.cityArr]:[this.pickerValueArray[0],this.cityArr,this.districtArr]}},created:function(){this.getDefaultAreas(0,{level:0})},methods:{handleColumnChange:function(t){var e=this;return(0,n.default)(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.isInitMultiArray=!1,i=t.detail.column,r=t.detail.value,e.multiIndex[i]=r,a.t0=i,a.next=0===a.t0?7:1===a.t0?14:2===a.t0?18:27;break;case 7:return a.next=9,e.getAreasAsync(e.pickerValueArray[0][e.multiIndex[i]].value);case 9:return e.cityArr=a.sent,a.next=12,e.getAreasAsync(e.cityArr[0].value);case 12:return e.districtArr=a.sent,a.abrupt("break",27);case 14:return a.next=16,e.getAreasAsync(e.cityArr[e.multiIndex[i]].value);case 16:return e.districtArr=a.sent,a.abrupt("break",27);case 18:if(e.cityArr.length){a.next=22;break}return a.next=21,e.getAreasAsync(e.pickerValueArray[0][0].value);case 21:e.cityArr=a.sent;case 22:if(e.districtArr.length){a.next=26;break}return a.next=25,e.getAreasAsync(e.cityArr[0].value);case 25:e.districtArr=a.sent;case 26:return a.abrupt("break",27);case 27:case"end":return a.stop()}}),a)})))()},handleValueChange:function(t){var e=(0,r.default)(t.detail.value,3),a=e[0],i=e[1],n=e[2],s=(0,r.default)(this.pickedArr,3),l=s[0],o=s[1],d=s[2],u="";u="2"==this.selectArr?[l[a],o[i]]:[l[a],o[i],d[n]],this.$emit("getRegions",u)},handleDefaultRegions:function(){var t=this,e=setInterval((function(){if(t.isLoadDefaultAreas){t.isInitMultiArray=!1;for(var a=0;a<t.defaultRegions.length;a++)for(var i=function(e){t.defaultRegions[a]==t.pickerValueArray[a][e].value&&1==t.pickerValueArray[a][e].level&&(t.$set(t.multiIndex,a,e),t.getAreas(t.pickerValueArray[a][e].value,(function(a){t.cityArr=a;for(var i=function(a){if(t.defaultRegions[1]==t.cityArr[a].value)return t.$set(t.multiIndex,1,a),t.getAreas(t.cityArr[a].value,(function(i){t.districtArr=i;for(var r=0;r<t.districtArr.length;r++)if(t.defaultRegions[2]==t.districtArr[r].value){t.$set(t.multiIndex,2,r),t.handleValueChange({detail:{value:[e,a,r]}});break}})),"break"},r=0;r<t.cityArr.length;r++){var n=i(r);if("break"===n)break}})))},r=0;r<t.pickerValueArray[a].length;r++)i(r);t.isLoadDefaultAreas&&clearInterval(e)}}),100)},getDefaultAreas:function(t,e){var a=this;this.$api.sendRequest({url:"/api/address/lists",data:{pid:t},success:function(t){if(0==t.code){var i=[],r=void 0;t.data.forEach((function(t,a){void 0!=e&&(0==e.level&&void 0!=e.province_id?r=e.province_id:1==e.level&&void 0!=e.city_id?r=e.city_id:2==e.level&&void 0!=e.district_id&&(r=e.district_id)),void 0==r&&0==a&&(r=t.id),i.push({value:t.id,label:t.name,level:t.level})})),a.pickerValueArray[e.level]=i,e.level+1<3?(e.level++,a.getDefaultAreas(r,e)):(a.isInitMultiArray=!0,a.isLoadDefaultAreas=!0)}}})},getAreasAsync:function(t){var e=this;return(0,n.default)(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$api.sendRequest({url:"/api/address/lists",data:{pid:t},async:!1});case 2:if(i=a.sent,0!=i.code){a.next=7;break}return r=[],i.data.forEach((function(t,e){r.push({value:t.id,label:t.name,level:t.level})})),a.abrupt("return",r);case 7:case"end":return a.stop()}}),a)})))()},getAreas:function(t,e){this.$api.sendRequest({url:"/api/address/lists",data:{pid:t},success:function(t){if(0==t.code){var a=[];t.data.forEach((function(t,e){a.push({value:t.id,label:t.name,level:t.level})})),e&&e(a)}}})}}};e.default=s},d4d4:function(t,e,a){"use strict";a.r(e);var i=a("c92d"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},dfd6:function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticStyle:{display:"none"}},[t._t("default")],2)},n=[]},fa2e:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n */[data-v-3a8783b1] pick-regions,\r\n.pick-regions[data-v-3a8783b1]{flex:1}.edit-wrap[data-v-3a8783b1]{background:#fff;overflow:hidden}.edit-wrap .tip[data-v-3a8783b1]{padding:%?20?% %?30?% %?10?%;background-color:#f8f8f8;color:#909399}.edit-item[data-v-3a8783b1]{display:flex;align-items:center;margin:0 %?30?%;min-height:%?100?%;background-color:#fff}.edit-item .text_inp[data-v-3a8783b1]{margin-left:%?20?%;flex:1}.edit-item .tit[data-v-3a8783b1]{width:%?148?%}.edit-item .tit uni-text[data-v-3a8783b1]{margin-left:%?10?%;color:#ff4544}.edit-item .tit.margin_tit[data-v-3a8783b1]{align-self:flex-start;margin-top:%?24?%}.edit-item .iconlocation[data-v-3a8783b1]{color:#606266;align-self:flex-start;margin-top:%?20?%}.edit-item .select-address[data-v-3a8783b1]{display:block;margin-left:%?10?%}.edit-item .select-address.empty[data-v-3a8783b1]{color:grey}.edit-item uni-textarea[data-v-3a8783b1],\r\n.edit-item uni-input[data-v-3a8783b1]{flex:1;font-size:%?28?%;margin-left:%?20?%;padding:0}.edit-item uni-textarea[data-v-3a8783b1]{margin-top:%?6?%;height:%?100?%;padding-bottom:%?20?%;padding-top:%?20?%;line-height:%?50?%}.edit-wrap > .edit-item + .edit-item[data-v-3a8783b1]{border-top:%?2?% solid #ebedf0}.add[data-v-3a8783b1]{margin-top:%?60?%;height:%?80?%;line-height:%?80?%!important;border-radius:%?10?%;font-weight:500;width:calc(100% - %?60?%);margin-left:%?30?%}.btn[data-v-3a8783b1]{position:fixed;width:100%;bottom:%?30?%;height:auto;padding-bottom:constant(safe-area-inset-bottom);\r\n  /*兼容 IOS<11.2*/padding-bottom:env(safe-area-inset-bottom)\r\n  /*兼容 IOS>11.2*/}',""]),t.exports=e}}]);