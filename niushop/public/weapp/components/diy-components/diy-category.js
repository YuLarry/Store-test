(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/diy-components/diy-category"],{821:function(t,e,n){"use strict";n.r(e);var o=n(822),r=n(824);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n(826);var s,c=n(14),a=Object(c["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],s);a.options.__file="components/diy-components/diy-category.vue",e["default"]=a.exports},822:function(t,e,n){"use strict";n.r(e);var o=n(823);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},823:function(t,e,n){"use strict";var o;n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return s})),n.d(e,"recyclableRender",(function(){return i})),n.d(e,"components",(function(){return o}));try{o={diyCategoryItem:function(){return n.e("components/diy-components/diy-category-item").then(n.bind(null,1180))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.categoryTree&&!t.categoryTree.length?t.$util.img("public/uniapp/category/empty.png"):null);t._isMounted||(t.e0=function(e){return t.$util.redirectTo("/pages_tool/goods/search")},t.e1=function(e){return t.$util.redirectTo("/pages/goods/cart")}),t.$mp.data=Object.assign({},{$root:{g0:n}})},i=!1,s=[];r._withStripped=!0},824:function(t,e,n){"use strict";n.r(e);var o=n(825),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},825:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,r,i,s=function(){Promise.all([n.e("common/vendor"),n.e("components/ns-goods-sku/ns-goods-sku-category")]).then(function(){return resolve(n(1187))}.bind(null,n)).catch(n.oe)},c={components:{nsGoodsSkuCategory:s},name:"diy-category",props:{value:{type:Object,default:function(){return{}}}},data:function(){return{select:0,categoryId:"category-0",categoryTree:null,scrollLock:!1,triggered:!0,heightArea:[],isSub:!1,token:null,carIconList:{},endTips:0,cartAnimation:{},loadType:""}},created:function(){this.getCategoryTree(),this.$store.dispatch("getCartNumber"),this.token=t.getStorageSync("token"),this.loadType=1==this.value.goodsLevel&&"all"==this.value.loadType?"all":"part"},mounted:function(){var e=this;r=t.createSelectorQuery().in(this),r.select(".content-wrap").boundingClientRect((function(t){t&&(o=t.height)})).exec(),setTimeout((function(){r.select(".end-tips").boundingClientRect((function(t){t&&t.top>o&&(e.endTips=1)})).exec(),r.select(".cart-icon").boundingClientRect((function(t){t&&(i=t)})).exec(),1==e.value.template&&e.getHeightArea(-1)}),500)},computed:{cartMoney:function(){var t=parseFloat(this.$store.state.cartMoney).toFixed(2);return t.split(".")},cartNumber:function(){return this.$store.state.cartNumber}},methods:{pageShow:function(){this.$store.dispatch("getCartNumber"),this.token=t.getStorageSync("token"),this.heightArea.length||this.getHeightArea(-1)},getHeightArea:function(t){var e=[];r.selectAll(".content-wrap .child-category").boundingClientRect((function(t){t&&t.length&&t.forEach((function(t,n){0==n?e.push([0,t.height]):e.push([e[n-1][1],e[n-1][1]+t.height])}))})).exec(),this.heightArea=e,-1!=t&&t<this.categoryTree.length-1&&this.$refs.categoryItem[t+1].getGoodsList()},getCategoryTree:function(){var t=this;this.$api.sendRequest({url:"/api/goodscategory/tree",data:{level:3},success:function(e){0==e.code&&(t.categoryTree=e.data)}})},switchOneCategory:function(t){t>=this.categoryTree.length||(this.select=t,this.categoryId="category-"+t,this.scrollLock=!0)},touchStart:function(){this.scrollLock=!1},listenScroll:function(t){if(!this.scrollLock){var e=t.detail.scrollTop;if(this.heightArea.length){for(var n=0;n<this.heightArea.length;n++)if(e>=this.heightArea[n][0]&&e<=this.heightArea[n][1]){this.select=n;break}1!=this.value.template&&"all"==this.value.loadType&&this.heightArea[this.select][1]-e-o<300&&this.$refs.categoryItem[this.select].getGoodsList()}}},onRefresh:function(){this.triggered=!1},onRestore:function(){this.triggered="restore"},toLogin:function(){this.$emit("tologin")},selectSku:function(t,e){var n=this;this.$api.sendRequest({url:"/api/goodssku/getinfoforcategory",data:{sku_id:t.sku_id},success:function(t){var e=t.data;e.unit=e.unit||"件",e.show_price=e.discount_price,e.sku_spec_format&&(e.sku_spec_format=JSON.parse(e.sku_spec_format)),e.goods_spec_format&&(e.goods_spec_format=JSON.parse(e.goods_spec_format)),n.$refs.skuSelect.show("join_cart",e,(function(){}))}})},settlement:function(){var e=this,n=Object.keys(this.$store.state.cartList),o=[];n.length&&!this.isSub&&(this.isSub=!0,n.forEach((function(t){o.push(e.$store.state.cartList[t].cart_id)})),t.removeStorageSync("delivery"),t.setStorage({key:"orderCreateData",data:{cart_ids:o.toString()},success:function(){e.$util.redirectTo("/pages/order/payment"),e.isSub=!1}}))},addCartPoint:function(t,e){if(2==this.value.template||value.quickBuy){var n=(new Date).getTime();this.$set(this.carIconList,n,{left:t,top:e,index:0,bezierPos:this.$util.bezier([{x:t,y:e},{x:t-200,y:t-120},{x:i.left+10,y:i.top}],6).bezier_points,timer:null}),this.startAnimation(n)}},startAnimation:function(e){var n=this,o=this.carIconList[e].bezierPos,r=this.carIconList[e].index;this.carIconList[e].timer=setInterval((function(){if(r<6)n.carIconList[e].left=o[r].x,n.carIconList[e].top=o[r].y,r++;else{clearInterval(n.carIconList[e].timer),delete n.carIconList[e],n.$forceUpdate(),setTimeout((function(){n.$store.commit("setCartChange")}),100);var i=t.createAnimation({duration:200,timingFunction:"ease"});i.scale(1.2).step(),n.cartAnimation=i.export(),setTimeout((function(){i.scale(1).step(),n.cartAnimation=i.export()}),300)}}),50)}}};e.default=c}).call(this,n(1)["default"])},826:function(t,e,n){"use strict";n.r(e);var o=n(827),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},827:function(t,e,n){}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/components/diy-components/diy-category.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/diy-components/diy-category-create-component',
    {
        'components/diy-components/diy-category-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(821))
        })
    },
    [['components/diy-components/diy-category-create-component']]
]);
