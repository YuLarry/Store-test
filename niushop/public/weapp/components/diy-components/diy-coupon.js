(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/diy-components/diy-coupon"],{1108:function(t,n,e){"use strict";e.r(n);var o=e(1109),u=e(1111);for(var i in u)"default"!==i&&function(t){e.d(n,t,(function(){return u[t]}))}(i);e(1113),e(1115);var r,c=e(14),s=Object(c["default"])(u["default"],o["render"],o["staticRenderFns"],!1,null,"81913918",null,!1,o["components"],r);s.options.__file="components/diy-components/diy-coupon.vue",n["default"]=s.exports},1109:function(t,n,e){"use strict";e.r(n);var o=e(1110);e.d(n,"render",(function(){return o["render"]})),e.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),e.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),e.d(n,"components",(function(){return o["components"]}))},1110:function(t,n,e){"use strict";var o;e.r(n),e.d(n,"render",(function(){return u})),e.d(n,"staticRenderFns",(function(){return r})),e.d(n,"recyclableRender",(function(){return i})),e.d(n,"components",(function(){return o}));try{o={nsLogin:function(){return Promise.all([e.e("common/vendor"),e.e("components/ns-login/ns-login")]).then(e.bind(null,742))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var u=function(){var t=this,n=t.$createElement,e=(t._self._c,t.computedCouponList.length>0?t.__get_style(["img"==t.value.couponType&&{backgroundImage:"url("+t.$util.img(t.value.couponBgUrl)+")"},"color"==t.value.couponType&&{backgroundColor:t.value.couponBgColor}]):null),o=t.computedCouponList.length>0&&"1"==t.value.style?t.__map(Math.ceil(t.computedCouponList.length/3),(function(n,e){var o=t.__get_orig(n),u=t.__map(t.computedCouponList,(function(n,o){var u=t.__get_orig(n),i=o>=[3*e]&&o<[e+3]?t.$util.img("public/uniapp/coupon/style1-bg.png"):null,r=o>=[3*e]&&o<[e+3]?parseInt(n.discount):null,c=o>=[3*e]&&o<[e+3]&&!r?t._f("moneyConduct")(n.money):null,s=o>=[3*e]&&o<[e+3]&&r?t._f("moneyConduct")(n.discount):null,a=o>=[3*e]&&o<[e+3]&&n.at_least>0?Number(n.at_least):null,l=o>=[3*e]&&o<[e+3]?parseInt(n.useState):null;return{$orig:u,g0:i,m0:r,f0:c,f1:s,m1:a,m2:l}}));return{$orig:o,l0:u}})):null,u=t.computedCouponList.length>0&&"2"==t.value.style?t.__map(Math.ceil(t.computedCouponList.length/3),(function(n,e){var o=t.__get_orig(n),u=t.__map(t.computedCouponList,(function(n,o){var u=t.__get_orig(n),i=o>=[3*e]&&o<[e+3]?t.$util.img("public/uniapp/coupon/coupon_bg1.png"):null,r=o>=[3*e]&&o<[e+3]?parseInt(n.discount):null,c=o>=[3*e]&&o<[e+3]&&!r?t._f("moneyConduct")(n.money):null,s=o>=[3*e]&&o<[e+3]&&r?t._f("moneyConduct")(n.discount):null,a=o>=[3*e]&&o<[e+3]&&n.at_least>0?Number(n.at_least):null,l=o>=[3*e]&&o<[e+3]?parseInt(n.useState):null;return{$orig:u,g1:i,m3:r,f2:c,f3:s,m4:a,m5:l}}));return{$orig:o,l2:u}})):null,i=t.computedCouponList.length>0&&"3"==t.value.style?t.__map(Math.ceil(t.computedCouponList.length/3),(function(n,e){var o=t.__get_orig(n),u=t.__map(t.computedCouponList,(function(n,o){var u=t.__get_orig(n),i=o>=[3*e]&&o<[e+3]?t.$util.img("public/uniapp/coupon/coupon_shu.png"):null,r=o>=[3*e]&&o<[e+3]?parseInt(n.discount):null,c=o>=[3*e]&&o<[e+3]&&!r?t._f("moneyConduct")(n.money):null,s=o>=[3*e]&&o<[e+3]&&r?t._f("moneyConduct")(n.discount):null,a=o>=[3*e]&&o<[e+3]&&n.at_least>0?Number(n.at_least):null,l=o>=[3*e]&&o<[e+3]?parseInt(n.useState):null;return{$orig:u,g2:i,m6:r,f4:c,f5:s,m7:a,m8:l}}));return{$orig:o,l4:u}})):null,r=t.computedCouponList.length>0&&"4"==t.value.style?t.__map(Math.ceil(t.computedCouponList.length/3),(function(n,e){var o=t.__get_orig(n),u=t.__map(t.computedCouponList,(function(n,o){var u=t.__get_orig(n),i=o>=[3*e]&&o<[e+3]?t.$util.img("public/uniapp/coupon/style4_bg.png"):null,r=o>=[3*e]&&o<[e+3]?parseInt(n.discount):null,c=o>=[3*e]&&o<[e+3]&&!r?t._f("moneyConduct")(n.money):null,s=o>=[3*e]&&o<[e+3]&&r?t._f("moneyConduct")(n.discount):null,a=o>=[3*e]&&o<[e+3]&&n.at_least>0?Number(n.at_least):null,l=o>=[3*e]&&o<[e+3]?parseInt(n.useState):null;return{$orig:u,g3:i,m9:r,f6:c,f7:s,m10:a,m11:l}}));return{$orig:o,l6:u}})):null,c=t.$util.img("public/uniapp/coupon/style5_bg.png"),s=t.computedCouponList.length>0&&"5"==t.value.style?t.__map(t.computedCouponList,(function(n,e){var o=t.__get_orig(n),u="0.00"==n.discount?t._f("moneyConduct")(n.money):null,i="0.00"!=n.discount?t._f("moneyConduct")(n.discount):null,r=n.at_least>0?Number(n.at_least):null,c=parseInt(n.useState);return{$orig:o,f8:u,f9:i,m12:r,m13:c}})):null,a=t.computedCouponList.length<=2?t.$util.img("public/uniapp/coupon/style6-bg-2.png"):null,l=t.computedCouponList.length>0&&"6"==t.value.style?t.__map(Math.ceil(t.computedCouponList.length/3),(function(n,e){var o=t.__get_orig(n),u=t.__map(t.computedCouponList,(function(n,o){var u=t.__get_orig(n),i=o>=[3*e]&&o<[e+3]?t.$util.img("public/uniapp/coupon/style6-bg-1.png"):null,r=o>=[3*e]&&o<[e+3]?t._f("moneyConduct")("0.00"==n.discount?n.money:n.discount):null,c=o>=[3*e]&&o<[e+3]?parseInt(n.useState):null,s=o>=[3*e]&&o<[e+3]?parseFloat(n.at_least):null,a=o>=[3*e]&&o<[e+3]&&s>0?t._f("moneyConduct")(n.at_least):null;return{$orig:u,g5:i,f10:r,m14:c,m15:s,f11:a}}));return{$orig:o,l9:u}})):null;t._isMounted||(t.e0=function(n,e,o){var u=arguments[arguments.length-1].currentTarget.dataset,i=u.eventParams||u["event-params"];e=i.item,o=i.index;return t.couponAction(e,o)},t.e1=function(n,e,o){var u=arguments[arguments.length-1].currentTarget.dataset,i=u.eventParams||u["event-params"];e=i.item,o=i.index;return t.couponAction(e,o)},t.e2=function(n,e,o){var u=arguments[arguments.length-1].currentTarget.dataset,i=u.eventParams||u["event-params"];e=i.item,o=i.index;return t.couponAction(e,o)},t.e3=function(n,e,o){var u=arguments[arguments.length-1].currentTarget.dataset,i=u.eventParams||u["event-params"];e=i.item,o=i.index;return t.couponAction(e,o)},t.e4=function(n,e,o){var u=arguments[arguments.length-1].currentTarget.dataset,i=u.eventParams||u["event-params"];e=i.item,o=i.index;return t.couponAction(e,o)},t.e5=function(n){return t.$util.redirectTo("/pages/goods/category")}),t.$mp.data=Object.assign({},{$root:{s0:e,l1:o,l3:u,l5:i,l7:r,g4:c,l8:s,g6:a,l10:l}})},i=!1,r=[];u._withStripped=!0},1111:function(t,n,e){"use strict";e.r(n);var o=e(1112),u=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(n,t,(function(){return o[t]}))}(i);n["default"]=u.a},1112:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e={name:"diy-coupon",props:{value:{type:Object,default:function(){return{}}}},data:function(){return{token:"",couponList:[],isHave:!0,couponBtnSwitch:!1,isSuccess:!1,load:!0}},created:function(){this.getCanReceiveCouponQuery()},computed:{computedCouponList:function(){var t=[];return this.couponList.filter((function(n){n.count!=n.lead_count&&t.push(n)})),t},couponItemHeight:function(){var n="",e=t.getSystemInfoSync().safeArea.width||t.getSystemInfoSync().screenWidth;return"1"==this.value.style||"2"==this.value.style?n=[e-3*this.rpxUpPx(210)-2*this.rpxUpPx(2*this.value.margin.both)]/6:"3"==this.value.style?n=[e-2*this.rpxUpPx(24)-3*this.rpxUpPx(194)-2*this.rpxUpPx(2*this.value.margin.both)]/6:"4"==this.value.style?n=[e-3*this.rpxUpPx(206)-2*this.rpxUpPx(2*this.value.margin.both)]/6:"6"==this.value.style&&(n=[e-3*this.rpxUpPx(208)-2*this.rpxUpPx(2*this.value.margin.both)]/6),n},couponBtnStyle:function(){var t="";return t+="color:"+this.value.btnStyle.textColor+";",t+="background-color:"+this.value.btnStyle.bgColor+";",t+="border-radius:"+2*this.value.btnStyle.aroundRadius+"rpx;",t}},methods:{rpxUpPx:function(n){var e=t.getSystemInfoSync().safeArea.width||t.getSystemInfoSync().screenWidth,o=e*parseInt(n)/750;return Math.floor(o)},couponTap:function(t,n){t.count!=t.lead_count?0==t.useState?this.receiveCoupon(t,n):this.toGoodsList(t):this.$util.showToast({title:"该优惠券已抢光"})},getCanReceiveCouponQuery:function(){var t=this,n={page:1,page_size:this.value.count,can_receive:1};"diy"==this.value.sources&&(n.coupon_type_id_arr=this.value.couponIds.toString()),this.$api.sendRequest({url:"/coupon/api/coupon/typepagelists",data:n,success:function(n){var e=n.data;null!=e&&(t.couponList=e.list,t.couponList.forEach((function(t){0!=t.max_fetch&&t.member_coupon_num&&t.member_coupon_num>=t.max_fetch?t.useState=1:t.useState=0})))}})},couponAction:function(t,n){0==t.useState?this.receiveCoupon(t,n):parseInt(t.useState)&&this.couponTap(t,n)},receiveCoupon:function(n,e){var o=this,u=this;if(!this.couponBtnSwitch){this.couponBtnSwitch=!0;var i=t.getStorageSync("token");""!=i?this.$api.sendRequest({url:"/coupon/api/coupon/receive",data:{coupon_type_id:n.coupon_type_id,get_type:2},success:function(t){t.data;var e=t.message;if(0==t.code)if(e="领取成功",1==t.data.is_exist)for(var i=0;i<u.couponList.length;i++)u.couponList[i].coupon_type_id==n.coupon_type_id&&u.$set(u.couponList[i],"useState",1);else for(var r=0;r<u.couponList.length;r++)u.couponList[r].coupon_type_id==n.coupon_type_id&&u.$set(u.couponList[r],"useState",2);o.$util.showToast({title:e}),o.$forceUpdate(),o.couponBtnSwitch=!1},fail:function(t){o.couponBtnSwitch=!1}}):(this.$refs.login.open("/pages/index/index"),this.couponBtnSwitch=!1)}},toGoodsList:function(t){1!=t.goods_type?this.$util.redirectTo("/pages/goods/list",{coupon:t.coupon_type_id}):this.$util.redirectTo("/pages/goods/list",{})}},filters:{moneyConduct:function(t){var n=t.split("."),e=parseInt(n[1].split("").reverse().join(""))+"";return e=e.split("").reverse().join(""),0==e?n[0]:n[0]+"."+e}}};n.default=e}).call(this,e(1)["default"])},1113:function(t,n,e){"use strict";e.r(n);var o=e(1114),u=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(n,t,(function(){return o[t]}))}(i);n["default"]=u.a},1114:function(t,n,e){},1115:function(t,n,e){"use strict";e.r(n);var o=e(1116),u=e.n(o);for(var i in o)"default"!==i&&function(t){e.d(n,t,(function(){return o[t]}))}(i);n["default"]=u.a},1116:function(t,n,e){}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/components/diy-components/diy-coupon.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/diy-components/diy-coupon-create-component',
    {
        'components/diy-components/diy-coupon-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(1108))
        })
    },
    [['components/diy-components/diy-coupon-create-component']]
]);
