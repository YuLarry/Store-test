(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages_tool/member/pay_password"],{391:function(e,t,n){"use strict";(function(e){n(5);s(n(4));var t=s(n(392));function s(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},392:function(e,t,n){"use strict";n.r(t);var s=n(393),i=n(395);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n(397);var c,r=n(14),a=Object(r["default"])(i["default"],s["render"],s["staticRenderFns"],!1,null,null,null,!1,s["components"],c);a.options.__file="pages_tool/member/pay_password.vue",t["default"]=a.exports},393:function(e,t,n){"use strict";n.r(t);var s=n(394);n.d(t,"render",(function(){return s["render"]})),n.d(t,"staticRenderFns",(function(){return s["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return s["recyclableRender"]})),n.d(t,"components",(function(){return s["components"]}))},394:function(e,t,n){"use strict";var s;n.r(t),n.d(t,"render",(function(){return i})),n.d(t,"staticRenderFns",(function(){return c})),n.d(t,"recyclableRender",(function(){return o})),n.d(t,"components",(function(){return s}));try{s={mypOne:function(){return n.e("components/myp-one/myp-one").then(n.bind(null,947))}}}catch(r){if(-1===r.message.indexOf("Cannot find module")||-1===r.message.indexOf(".vue"))throw r;console.error(r.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,t=e.$createElement,n=(e._self._c,0==e.step?e._f("mobile")(e.memberInfo.mobile):null);e.$mp.data=Object.assign({},{$root:{f0:n}})},o=!1,c=[];i._withStripped=!0},395:function(e,t,n){"use strict";n.r(t);var s=n(396),i=n.n(s);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o);t["default"]=i.a},396:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(){n.e("components/myp-one/myp-one").then(function(){return resolve(n(947))}.bind(null,n)).catch(n.oe)},i={components:{mypOne:s},data:function(){return{isClick:!1,step:1,key:"",code:"",password:"",repassword:"",isSub:!1,back:"",memberInfo:{},dynacodeData:{seconds:120,timer:null,codeText:"获取验证码",isSend:!1}}},methods:{input:function(e){0==this.step?4==e.length?(this.isClick=!0,this.code=e):this.isClick=!1:1==this.step?6==e.length?(this.isClick=!0,this.password=e):this.isClick=!1:6==e.length?(this.isClick=!0,this.repassword=e):this.isClick=!1},confirm:function(){var e=this;if(this.isClick)if(0==this.step)this.$api.sendRequest({url:"/api/member/verifypaypwdcode",data:{code:this.code,key:this.key},success:function(t){0==t.code?(e.$refs.input.clear(),e.isClick=!1,e.step=1):e.$util.showToast({title:t.message})}});else if(1==this.step)this.$refs.input.clear(),this.isClick=!1,this.step=2;else if(this.password==this.repassword){if(this.isSub)return;this.isSub=!0,this.$api.sendRequest({url:"/api/member/modifypaypassword",data:{key:this.key,code:this.code,password:this.password},success:function(t){t.code>=0?(e.$util.showToast({title:"修改成功"}),setTimeout((function(){e.back?e.$util.redirectTo(e.back,{},"redirectTo"):e.$util.redirectTo("/pages/member/index",{},"reLaunch")}),2e3)):(e.initInfo(),e.$util.showToast({title:t.message}))}})}else this.$util.showToast({title:"两次输入的密码不一致",success:function(t){e.initInfo()}})},initInfo:function(){this.isClick=!1,this.step=1,this.password="",this.repassword="",this.oldpassword="",this.isSub=!1,this.$refs.input.clear()},getMemberInfo:function(){var t=this;this.$api.sendRequest({url:"/api/member/info",success:function(n){0==n.code&&(t.memberInfo=n.data,""==t.memberInfo.mobile?e.showModal({title:"提示",content:"设置支付密码需要先绑定手机号,是否立即绑定?",success:function(e){e.confirm?t.$util.redirectTo("/pages_tool/member/info",{action:"mobile",back:t.back},"redirectTo"):t.back?t.$util.redirectTo(t.back):t.$util.redirectTo("/pages/member/index",{},"redirectTo")}}):(t.step=0,t.sendMobileCode()))}})},sendMobileCode:function(){var e=this;120==this.dynacodeData.seconds&&(this.dynacodeData.isSend||(this.dynacodeData.isSend=!0,this.$api.sendRequest({url:"/api/member/paypwdcode",success:function(t){e.dynacodeData.isSend=!1,t.code>=0?(e.key=t.data.key,120==e.dynacodeData.seconds&&null==e.dynacodeData.timer&&(e.dynacodeData.timer=setInterval((function(){e.dynacodeData.seconds--,e.dynacodeData.codeText=e.dynacodeData.seconds+"s后可重新获取"}),1e3))):e.$util.showToast({title:t.message})},fail:function(){e.$util.showToast({title:"request:fail"}),e.dynacodeData.isSend=!1}})))}},onLoad:function(t){t.back&&(this.back=t.back),e.getStorageSync("token")?this.getMemberInfo():this.$util.redirectTo("/pages_tool/login/login")},filters:{mobile:function(e){return e.substring(0,3)+"****"+e.substring(7)}},watch:{"dynacodeData.seconds":{handler:function(e,t){0==e&&(clearInterval(this.dynacodeData.timer),this.dynacodeData={seconds:120,timer:null,codeText:"获取动态码",isSend:!1})},immediate:!0,deep:!0}}};t.default=i}).call(this,n(1)["default"])},397:function(e,t,n){"use strict";n.r(t);var s=n(398),i=n.n(s);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o);t["default"]=i.a},398:function(e,t,n){}},[[391,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages_tool/member/pay_password.js.map