(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["promotionpages/guafen/guafen/index"],{2509:function(t,e,n){"use strict";n.r(e);var i=n("aa20"),o=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(e,t,(function(){return i[t]}))}(u);e["default"]=o.a},"28ea":function(t,e,n){"use strict";var i=n("6d07"),o=n.n(i);o.a},"299d":function(t,e,n){"use strict";n.r(e);var i=n("6b10"),o=n("2509");for(var u in o)"default"!==u&&function(t){n.d(e,t,(function(){return o[t]}))}(u);n("a298"),n("c290"),n("28ea");var s,r=n("f0c5"),a=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"1026a906",null,!1,i["a"],s);e["default"]=a.exports},"6b10":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i}));var i={uniCountDown:function(){return n.e("components/uni-count-down/uni-count-down").then(n.bind(null,"9fb1"))},uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"d7b6"))},nsLogin:function(){return Promise.all([n.e("common/vendor"),n.e("components/ns-login/ns-login")]).then(n.bind(null,"2bc6"))},loadingCover:function(){return n.e("components/loading-cover/loading-cover").then(n.bind(null,"4c1d"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,2!=t.groupInfoList.status?t.$util.img("/upload/uniapp/guafen/guafen_bg.png"):null),i=2!=t.groupInfoList.status?t.$util.img("/upload/uniapp/hongbao/index.png"):null,o=2!=t.groupInfoList.status&&""==t.groupInfoList&&1==t.guafenInfo.status?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,u=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,s=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)&&t.groupInfoList.member_list.length>0?t.__map(t.groupInfoList.member_list,(function(e,n){var i=t.__get_orig(e),o=""!=e.headimg?t.$util.img(e.headimg):null,u=""==e.headimg?t.$util.img("/upload/default/default_img/head.png"):null;return{$orig:i,g4:o,g5:u}})):null,r=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)?t.$util.img("/upload/uniapp/guafen/bg_left.png"):null,a=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)?t.$util.img("/upload/uniapp/guafen/bg_right.png"):null,g=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,p=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state&&t.groupInfoList.member_list.length>0?t.__map(t.groupInfoList.member_list,(function(e,n){var i=t.__get_orig(e),o=""!=e.headimg?t.$util.img(e.headimg):null,u=""==e.headimg?t.$util.img("/upload/default/default_img/head.png"):null;return{$orig:i,g9:o,g10:u}})):null,f=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state&&1==t.guafenInfo.is_limit?t._f("int")(t.guafenInfo.at_least):null,l=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state?t._f("date")(t.$util.timeStampTurnTime(t.start_time_coupon)):null,d=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state?t._f("date")(t.$util.timeStampTurnTime(t.end_time_coupon)):null,c=2!=t.groupInfoList.status&&(1!=t.groupInfoList.status&&-1==t.guafenInfo.status||1!=t.groupInfoList.status&&2==t.guafenInfo.status)?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,m=2!=t.groupInfoList.status&&1==t.guafenInfo.status&&1==t.g_member_state?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,_=2==t.groupInfoList.status?t.$util.img("upload/uniapp/order/status-wrap-bg.png"):null,I=2==t.groupInfoList.status&&t.groupInfoList.member_list.length>0?t.__map(t.groupInfoList.member_list,(function(e,n){var i=t.__get_orig(e),o=""!=e.headimg?t.$util.img(e.headimg):null,u=""==e.headimg?t.$util.img("/upload/default/default_img/head.png"):null;return{$orig:i,g14:o,g15:u}})):null,h=2==t.groupInfoList.status?t.$util.timeStampTurnTime(t.guafenInfo.start_time):null,b=2==t.groupInfoList.status?t.$util.timeStampTurnTime(t.guafenInfo.end_time):null,v=2==t.groupInfoList.status?t.$util.timeStampTurnTime(t.groupInfoList.start_time):null,$=t.$util.img("upload/uniapp/guafen/explain.png"),L=t.$util.timeStampTurnTime(t.guafenInfo.start_time),S=t.$util.timeStampTurnTime(t.guafenInfo.end_time),P="-1"!=t.poster?t.$util.img(t.poster):null,k=t.inviterInfo?t.$util.img("upload/uniapp/guafen/guafen_popup.png"):null,T=t.inviterInfo?t.$util.img(t.inviterInfo.headimg?t.$util.img(t.inviterInfo.headimg):t.$util.getDefaultImage().default_headimg):null,w=t.inviterInfo?t._f("guolv")(t.inviterInfo.nickname):null,x=t.inviterInfo?t.$util.img("/upload/uniapp/hongbao/close.png"):null,y=t.inviterInfo?null:t.$util.img("upload/uniapp/guafen/guafen_popup.png"),D=t.inviterInfo?null:t.$util.img(t.groupInfoList.header_headimg?t.$util.img(t.groupInfoList.header_headimg):t.$util.getDefaultImage().default_headimg),M=t.inviterInfo?null:t._f("guolv")(t.groupInfoList.header_nickname),R=t.inviterInfo?null:t.$util.img("/upload/uniapp/hongbao/close.png"),O=t.$util.img("upload/uniapp/guafen/guafen_success.png"),q=t._f("int")(t.guafenInfo.money),C=t.$util.img("upload/uniapp/guafen/guafen_popup.png"),G=t._f("guolv")(t.groupInfoList.header_nickname),U=t._f("int")(t.guafenInfo.money),F=t.$util.img("/upload/uniapp/hongbao/close.png");t._isMounted||(t.e0=function(e){t.inviterInfo.headimg=t.$util.getDefaultImage().default_headimg},t.e1=function(e){t.groupInfoList.header_headimg=t.$util.getDefaultImage().default_headimg}),t.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:o,g3:u,l0:s,g6:r,g7:a,g8:g,l1:p,f0:f,f1:l,f2:d,g11:c,g12:m,g13:_,l2:I,g16:h,g17:b,g18:v,g19:$,g20:L,g21:S,g22:P,g23:k,g24:T,f3:w,g25:x,g26:y,g27:D,f4:M,g28:R,g29:O,f5:q,g30:C,f6:G,f7:U,g31:F}})},u=[]},"6d07":function(t,e,n){},a298:function(t,e,n){"use strict";var i=n("bfaa"),o=n.n(i);o.a},aa20:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n("d7b6"))}.bind(null,n)).catch(n.oe)},o=function(){Promise.all([n.e("common/vendor"),n.e("components/ns-goods-recommend/ns-goods-recommend")]).then(function(){return resolve(n("4955"))}.bind(null,n)).catch(n.oe)},u={components:{nsGoodsRecommend:o,uniPopup:i},data:function(){return{guafenInfo:{},groupInfoList:[],goodsRecommend:[],isShow:!1,isNow:!1,seckillH:"",seckillI:"",seckillS:"",seckillInterval:null,poster:"-1",posterMsg:"",posterHeight:0,couponId:"",groupId:"",memberInfo:{},money:"",memberList:[],inviterId:"",inviterInfo:{},is_exit:0,g_member_state:0,start_time_coupon:"",end_time_coupon:"",token:null,memberId:0}},onLoad:function(e){var n=this;if(e.source_member&&t.setStorageSync("source_member",e.source_member),e.scene){var i=decodeURIComponent(e.scene);i=i.split("&"),i.length&&i.forEach((function(e){-1!=e.indexOf("cid")&&(n.couponId=e.split("-")[1]),-1!=e.indexOf("id")&&(n.inviterId=e.split("-")[1]),-1!=e.indexOf("gid")&&(n.groupId=e.split("-")[1]),-1!=e.indexOf("m")&&t.setStorageSync("source_member",e.split("-")[1]),-1!=e.indexOf("is_test")&&t.setStorageSync("is_test",1)}))}else e.cid?(e.cid&&(this.couponId=e.cid),e.id&&(this.inviterId=e.id),e.gid&&(this.groupId=e.gid)):(e.coupon_id&&(this.couponId=e.coupon_id),e.inviter_id&&(this.inviterId=e.inviter_id),e.group_id&&(this.groupId=e.group_id))},filters:{date:function(t){return String(t).slice(0,10)},guolv:function(t){return t=String(t),t.length>=6?t.substr(0,1)+"****"+t.substr(t.split("").length-1,t.split("").length):t},int:function(t){var e=String(t),n=e.split(".");return parseInt(n[1])>0?e:n[0]}},onShow:function(){this.getInfo(),this.getMemberInfo(),this.getMemberId(),t.getStorageSync("token")&&t.getStorageSync("source_member")&&this.$util.onSourceMember(t.getStorageSync("source_member"))},methods:{getMemberId:function(){var t=this;this.$api.sendRequest({url:"/api/member/id",success:function(e){e.code>=0&&(t.memberId=e.data)}})},closeGetItNow:function(){this.$refs.linkSuccessPopup.close()},openSharePopup:function(){this.$refs.sharePopup.open(),this.getGoodsPoster()},closeSharePopup:function(){this.$refs.sharePopup.close()},showPrice:function(t){var e=t.discount_price;return t.member_price&&parseFloat(t.member_price)<parseFloat(e)&&(e=t.member_price),e},openRulePopup:function(){this.$refs.rulePopup.open()},closeRulePopup:function(){this.$refs.rulePopup.close()},toIndex:function(){this.$util.redirectTo("/pages/index/index/index",{})},toList:function(){var t=this.guafenInfo.goods_ids.split(",").filter((function(t){return t&&t.trim()}));this.$util.redirectTo("/pages/goods/list/list",{goods_id_arr:t})},toGuaFen:function(){this.$util.redirectTo("/promotionpages/guafen/guafen/list",{})},toDetail:function(t){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.sku_id})},closeFriend:function(){this.$refs.friendsPopup.close()},friend:function(){this.$refs.friendsPopup.open()},goFriend:function(){this.closeFriend(),this.openSharePopup()},GetItNowPopup:function(){this.$refs.linkSuccessPopup.open()},getInfo:function(){var t=this;this.$api.sendRequest({url:"/divideticket/api/divideticket/info",data:{coupon_id:this.couponId,inviter_id:""==this.inviterId?0:this.inviterId,group_id:""==this.groupId?0:this.groupId},success:function(e){if(e.code>=0&&(t.guafenInfo=e.data,t.groupInfoList=e.data.group_info,t.memberList=e.data.group_info.member_list,t.groupId=e.data.group_info.group_id,t.guafenInfo.inviter_info&&(t.inviterInfo=e.data.inviter_info),t.memberList&&t.memberList.forEach((function(e){t.guafenInfo.member_id==e.member_id&&(t.money=e.money,t.start_time_coupon=e.coupon_start_time,t.end_time_coupon=e.coupon_end_time)})),""!=e.data.group_info)){var n=Date.parse(new Date)/1e3,i=t.$util.countDown(t.groupInfoList.end_time-n);if(t.seckillH=i.h,t.seckillI=i.i,t.seckillS=i.s,e.data.member_id!=e.data.group_info.header_id){var o=0;e.data.group_info.member_list.some((function(t){t.member_id==e.data.member_id&&(o+=1)})),1==e.data.group_info.status&&0==o?t.g_member_state=1:0==o&&(o+=1,t.$refs.linkPopup.open())}}}})},join:function(){var e=this;t.getStorageSync("token")?this.$api.sendRequest({url:"/divideticket/api/divideticket/divideticket",data:{group_id:this.groupId},success:function(t){t.code>=0?(e.$util.showToast({title:"加入成功"}),e.closeLinkPopup(),e.getInfo(),e.groupInfoList.num-e.groupInfoList.member_list.length>1&&e.friend(),e.groupInfoList.num-e.groupInfoList.member_list.length<=1&&e.GetItNowPopup()):(e.$util.showToast({title:t.message}),e.closeLinkPopup())}}):setTimeout((function(){e.$refs.login.open("/otherpages/hongbao/index/index?coupon_id="+e.couponId+"&group_id="+e.groupId)}))},getLaunch:function(){var e=this;t.getStorageSync("token")?this.$api.sendRequest({url:"/divideticket/api/divideticket/launch",data:{coupon_id:this.couponId},success:function(t){t.code>=0?(e.groupId=t.data,e.isShow,e.getInfo()):e.$util.showToast({title:"优惠券已被瓜分完，下次再来吧"}),e.$forceUpdate()}}):setTimeout((function(){e.$refs.login.open("/promotionpages/guafen/guafen/index?coupon_id="+e.couponId+"&group_id="+e.groupId)}))},openPosterPopup:function(){this.$util.redirectTo("/promotionpages/guafen/guafen/poster",{coupon_id:this.couponId,group_id:this.groupId,inviter_id:this.guafenInfo.member_id})},getGoodsPoster:function(){var t=this;this.$api.sendRequest({url:"/divideticket/api/divideticket/poster",data:{coupon_id:this.couponId,group_id:""==this.groupId?0:this.groupId},success:function(e){0==e.code?t.poster=e.data.path+"?time="+(new Date).getTime():t.posterMsg=e.message}})},closePosterPopup:function(){this.$refs.posterPopup.close()},closeLinkPopup:function(){this.$refs.linkPopup.close()},copyUrl:function(){var t=this,e=this.$config.h5Domain+"/promotionpages/guafen/guafen/index";this.couponId&&(e+="?coupon_id="+this.couponId+"&group_id="+this.groupInfoList.group_id+"&inviter_id="+this.guafenInfo.member_id),this.$util.copy(e,(function(){t.closeSharePopup()}))},imageError:function(t){this.list[t].goods_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},headerimageError:function(t){this.list[t].headimg=this.$util.getDefaultImage().default_headimg,this.$forceUpdate()},onPageHide:function(){clearInterval(this.seckillInterval)},getMemberInfo:function(){var t=this;this.$api.sendRequest({url:"/api/member/info",success:function(e){0==e.code&&(t.memberInfo=e.data),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}},onShareAppMessage:function(t){var e="/promotionpages/guafen/guafen/index?cid="+this.guafenInfo.coupon_id+"&gid="+this.groupInfoList.group_id+"&id="+this.guafenInfo.member_id;return this.memberId&&(e+="&source_member="+this.memberId),{title:"仅差一人即可瓜分"+this.guafenInfo.money+"元优惠券",path:e,imageUrl:"",success:function(t){},fail:function(t){}}},onShareTimeline:function(){var t="仅差一人即可瓜分"+this.guafenInfo.money+"元优惠券",e=e="?cid="+this.guafenInfo.coupon_id+"&gid="+this.groupInfoList.group_id+"&id="+this.guafenInfo.member_id;return this.memberId&&(e+="&source_member="+this.memberId),{title:t,query:e,imageUrl:""}}};e.default=u}).call(this,n("543d")["default"])},bfaa:function(t,e,n){},c290:function(t,e,n){"use strict";var i=n("e668"),o=n.n(i);o.a},e586:function(t,e,n){"use strict";(function(t){n("67ba");i(n("66fd"));var e=i(n("299d"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},e668:function(t,e,n){}},[["e586","common/runtime","common/vendor"]]]);