(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["promotionpages/guafen/guafen/index"],{"01e7":function(t,n,i){"use strict";var e=i("8788"),o=i.n(e);o.a},"0332":function(t,n,i){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(){i.e("components/uni-popup/uni-popup").then(function(){return resolve(i("2d2c"))}.bind(null,i)).catch(i.oe)},o=function(){Promise.all([i.e("common/vendor"),i.e("components/ns-goods-recommend/ns-goods-recommend")]).then(function(){return resolve(i("b431"))}.bind(null,i)).catch(i.oe)},u={components:{nsGoodsRecommend:o,uniPopup:e},data:function(){return{guafenInfo:{},groupInfoList:[],goodsRecommend:[],isShow:!1,isNow:!1,seckillH:"",seckillI:"",seckillS:"",seckillInterval:null,poster:"-1",posterMsg:"",posterHeight:0,couponId:"",groupId:"",memberInfo:{},money:"",memberList:[],inviterId:"",inviterInfo:{},is_exit:0,g_member_state:0,start_time_coupon:"",end_time_coupon:"",token:null,memberId:0}},onLoad:function(t){var n=this;if(t.scene){var i=decodeURIComponent(t.scene);i=i.split("&"),i.length&&i.forEach((function(t){-1!=t.indexOf("cid")&&(n.couponId=t.split("-")[1]),-1!=t.indexOf("id")&&(n.inviterId=t.split("-")[1]),-1!=t.indexOf("gid")&&(n.groupId=t.split("-")[1])}))}else t.cid?(t.cid&&(this.couponId=t.cid),t.id&&(this.inviterId=t.id),t.gid&&(this.groupId=t.gid)):(t.coupon_id&&(this.couponId=t.coupon_id),t.inviter_id&&(this.inviterId=t.inviter_id),t.group_id&&(this.groupId=t.group_id))},filters:{date:function(t){return String(t).slice(0,10)},guolv:function(t){return t=String(t),t.length>=6?t.substr(0,1)+"****"+t.substr(t.split("").length-1,t.split("").length):t},int:function(t){var n=String(t),i=n.split(".");return parseInt(i[1])>0?n:i[0]}},onShow:function(){this.getInfo(),this.getMemberInfo(),this.getMemberId()},methods:{getMemberId:function(){var t=this;this.$api.sendRequest({url:"/api/member/id",success:function(n){n.code>=0&&(t.memberId=n.data)}})},closeGetItNow:function(){this.$refs.linkSuccessPopup.close()},openSharePopup:function(){this.$refs.sharePopup.open(),this.getGoodsPoster()},closeSharePopup:function(){this.$refs.sharePopup.close()},showPrice:function(t){var n=t.discount_price;return t.member_price&&parseFloat(t.member_price)<parseFloat(n)&&(n=t.member_price),n},openRulePopup:function(){this.$refs.rulePopup.open()},closeRulePopup:function(){this.$refs.rulePopup.close()},toIndex:function(){this.$util.redirectTo("/pages/index/index/index",{})},toList:function(){var t=this.guafenInfo.goods_ids.split(",").filter((function(t){return t&&t.trim()}));this.$util.redirectTo("/pages/goods/list/list",{goods_id_arr:t})},toGuaFen:function(){this.$util.redirectTo("/promotionpages/guafen/guafen/list",{})},toDetail:function(t){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:t.sku_id})},closeFriend:function(){this.$refs.friendsPopup.close()},friend:function(){this.$refs.friendsPopup.open()},goFriend:function(){this.closeFriend(),this.openSharePopup()},GetItNowPopup:function(){this.$refs.linkSuccessPopup.open()},getInfo:function(){var t=this;this.$api.sendRequest({url:"/divideticket/api/divideticket/info",data:{coupon_id:this.couponId,inviter_id:""==this.inviterId?0:this.inviterId,group_id:""==this.groupId?0:this.groupId},success:function(n){if(n.code>=0&&(t.guafenInfo=n.data,t.groupInfoList=n.data.group_info,t.memberList=n.data.group_info.member_list,t.groupId=n.data.group_info.group_id,t.guafenInfo.inviter_info&&(t.inviterInfo=n.data.inviter_info),t.memberList&&t.memberList.forEach((function(n){t.guafenInfo.member_id==n.member_id&&(t.money=n.money,t.start_time_coupon=n.coupon_start_time,t.end_time_coupon=n.coupon_end_time)})),""!=n.data.group_info)){var i=Date.parse(new Date)/1e3,e=t.$util.countDown(t.groupInfoList.end_time-i);if(t.seckillH=e.h,t.seckillI=e.i,t.seckillS=e.s,n.data.member_id!=n.data.group_info.header_id){var o=0;n.data.group_info.member_list.some((function(t){t.member_id==n.data.member_id&&(o+=1)})),1==n.data.group_info.status&&0==o?t.g_member_state=1:0==o&&(o+=1,t.$refs.linkPopup.open())}}}})},join:function(){var n=this;t.getStorageSync("token")?this.$api.sendRequest({url:"/divideticket/api/divideticket/divideticket",data:{group_id:this.groupId},success:function(t){t.code>=0?(n.$util.showToast({title:"加入成功"}),n.closeLinkPopup(),n.getInfo(),n.groupInfoList.num-n.groupInfoList.member_list.length>1&&n.friend(),n.groupInfoList.num-n.groupInfoList.member_list.length<=1&&n.GetItNowPopup()):(n.$util.showToast({title:t.message}),n.closeLinkPopup())}}):setTimeout((function(){n.$refs.login.open("/otherpages/hongbao/index/index?coupon_id="+n.couponId+"&group_id="+n.groupId)}))},getLaunch:function(){var n=this;t.getStorageSync("token")?this.$api.sendRequest({url:"/divideticket/api/divideticket/launch",data:{coupon_id:this.couponId},success:function(t){t.code>=0?(n.groupId=t.data,n.isShow,n.getInfo()):n.$util.showToast({title:"优惠券已被瓜分完，下次再来吧"}),n.$forceUpdate()}}):setTimeout((function(){n.$refs.login.open("/promotionpages/guafen/guafen/index?coupon_id="+n.couponId+"&group_id="+n.groupId)}))},openPosterPopup:function(){this.$util.redirectTo("/promotionpages/guafen/guafen/poster",{coupon_id:this.couponId,group_id:this.groupId,inviter_id:this.guafenInfo.member_id})},getGoodsPoster:function(){var t=this;this.$api.sendRequest({url:"/divideticket/api/divideticket/poster",data:{coupon_id:this.couponId,group_id:""==this.groupId?0:this.groupId},success:function(n){0==n.code?t.poster=n.data.path+"?time="+(new Date).getTime():t.posterMsg=n.message}})},closePosterPopup:function(){this.$refs.posterPopup.close()},closeLinkPopup:function(){this.$refs.linkPopup.close()},copyUrl:function(){var t=this,n=this.$config.h5Domain+"/promotionpages/guafen/guafen/index";this.couponId&&(n+="?coupon_id="+this.couponId+"&group_id="+this.groupInfoList.group_id+"&inviter_id="+this.guafenInfo.member_id),this.$util.copy(n,(function(){t.closeSharePopup()}))},imageError:function(t){this.list[t].goods_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},headerimageError:function(t){this.list[t].headimg=this.$util.getDefaultImage().default_headimg,this.$forceUpdate()},onPageHide:function(){clearInterval(this.seckillInterval)},getMemberInfo:function(){var t=this;this.$api.sendRequest({url:"/api/member/info",success:function(n){0==n.code&&(t.memberInfo=n.data),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(n){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}},onShareAppMessage:function(t){var n="/promotionpages/guafen/guafen/index?cid="+this.guafenInfo.coupon_id+"&gid="+this.groupInfoList.group_id+"&id="+this.guafenInfo.member_id;return this.memberId&&(n+="&source_member="+this.memberId),{title:"还差"+(this.groupInfoList.num-this.groupInfoList.member_list.length)+"人瓜分成功",path:n,success:function(t){console.log(n,"00")},fail:function(t){console.log(n,"11")}}}};n.default=u}).call(this,i("543d")["default"])},"1ea8":function(t,n,i){},2137:function(t,n,i){"use strict";i.d(n,"b",(function(){return o})),i.d(n,"c",(function(){return u})),i.d(n,"a",(function(){return e}));var e={uniCountDown:function(){return i.e("components/uni-count-down/uni-count-down").then(i.bind(null,"d753"))},uniPopup:function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"2d2c"))},nsLogin:function(){return Promise.all([i.e("common/vendor"),i.e("components/ns-login/ns-login")]).then(i.bind(null,"61d0"))},loadingCover:function(){return i.e("components/loading-cover/loading-cover").then(i.bind(null,"b1ae"))}},o=function(){var t=this,n=t.$createElement,i=(t._self._c,2!=t.groupInfoList.status?t.$util.img("/upload/uniapp/guafen/guafen_bg.png"):null),e=2!=t.groupInfoList.status?t.$util.img("/upload/uniapp/hongbao/index.png"):null,o=2!=t.groupInfoList.status&&""==t.groupInfoList&&1==t.guafenInfo.status?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,u=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,s=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)&&t.groupInfoList.member_list.length>0?t.__map(t.groupInfoList.member_list,(function(n,i){var e=t.__get_orig(n),o=""!=n.headimg?t.$util.img(n.headimg):null,u=""==n.headimg?t.$util.img("/upload/default/default_img/head.png"):null;return{$orig:e,g4:o,g5:u}})):null,a=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)?t.$util.img("/upload/uniapp/guafen/bg_left.png"):null,r=2!=t.groupInfoList.status&&(""!=t.groupInfoList&&1==t.guafenInfo.status&&0==t.groupInfoList.status||2==t.groupInfoList.status)?t.$util.img("/upload/uniapp/guafen/bg_right.png"):null,g=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,p=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state&&t.groupInfoList.member_list.length>0?t.__map(t.groupInfoList.member_list,(function(n,i){var e=t.__get_orig(n),o=""!=n.headimg?t.$util.img(n.headimg):null,u=""==n.headimg?t.$util.img("/upload/default/default_img/head.png"):null;return{$orig:e,g9:o,g10:u}})):null,f=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state&&1==t.guafenInfo.is_limit?t._f("int")(t.guafenInfo.at_least):null,l=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state?t._f("date")(t.$util.timeStampTurnTime(t.start_time_coupon)):null,d=2!=t.groupInfoList.status&&""!=t.groupInfoList&&1==t.groupInfoList.status&&0==t.g_member_state?t._f("date")(t.$util.timeStampTurnTime(t.end_time_coupon)):null,c=2!=t.groupInfoList.status&&(1!=t.groupInfoList.status&&-1==t.guafenInfo.status||1!=t.groupInfoList.status&&2==t.guafenInfo.status)?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,m=2!=t.groupInfoList.status&&1==t.guafenInfo.status&&1==t.g_member_state?t.$util.img("/upload/uniapp/guafen/guafen_success_bg.png"):null,_=2==t.groupInfoList.status?t.$util.img("upload/uniapp/order/status-wrap-bg.png"):null,I=2==t.groupInfoList.status&&t.groupInfoList.member_list.length>0?t.__map(t.groupInfoList.member_list,(function(n,i){var e=t.__get_orig(n),o=""!=n.headimg?t.$util.img(n.headimg):null,u=""==n.headimg?t.$util.img("/upload/default/default_img/head.png"):null;return{$orig:e,g14:o,g15:u}})):null,h=2==t.groupInfoList.status?t.$util.timeStampTurnTime(t.guafenInfo.start_time):null,v=2==t.groupInfoList.status?t.$util.timeStampTurnTime(t.guafenInfo.end_time):null,$=2==t.groupInfoList.status?t.$util.timeStampTurnTime(t.groupInfoList.start_time):null,b=t.$util.img("upload/uniapp/guafen/explain.png"),L=t.$util.timeStampTurnTime(t.guafenInfo.start_time),P=t.$util.timeStampTurnTime(t.guafenInfo.end_time),k="-1"!=t.poster?t.$util.img(t.poster):null,S=t.inviterInfo?t.$util.img("upload/uniapp/guafen/guafen_popup.png"):null,T=t.inviterInfo?t.$util.img(t.inviterInfo.headimg?t.$util.img(t.inviterInfo.headimg):t.$util.getDefaultImage().default_headimg):null,w=t.inviterInfo?t._f("guolv")(t.inviterInfo.nickname):null,x=t.inviterInfo?t.$util.img("/upload/uniapp/hongbao/close.png"):null,D=t.inviterInfo?null:t.$util.img("upload/uniapp/guafen/guafen_popup.png"),M=t.inviterInfo?null:t.$util.img(t.groupInfoList.header_headimg?t.$util.img(t.groupInfoList.header_headimg):t.$util.getDefaultImage().default_headimg),R=t.inviterInfo?null:t._f("guolv")(t.groupInfoList.header_nickname),y=t.inviterInfo?null:t.$util.img("/upload/uniapp/hongbao/close.png"),G=t.$util.img("upload/uniapp/guafen/guafen_success.png"),q=t._f("int")(t.guafenInfo.money),C=t.$util.img("upload/uniapp/guafen/guafen_popup.png"),U=t._f("guolv")(t.groupInfoList.header_nickname),F=t._f("int")(t.guafenInfo.money),N=t.$util.img("/upload/uniapp/hongbao/close.png");t._isMounted||(t.e0=function(n){t.inviterInfo.headimg=t.$util.getDefaultImage().default_headimg},t.e1=function(n){t.groupInfoList.header_headimg=t.$util.getDefaultImage().default_headimg}),t.$mp.data=Object.assign({},{$root:{g0:i,g1:e,g2:o,g3:u,l0:s,g6:a,g7:r,g8:g,l1:p,f0:f,f1:l,f2:d,g11:c,g12:m,g13:_,l2:I,g16:h,g17:v,g18:$,g19:b,g20:L,g21:P,g22:k,g23:S,g24:T,f3:w,g25:x,g26:D,g27:M,f4:R,g28:y,g29:G,f5:q,g30:C,f6:U,f7:F,g31:N}})},u=[]},"4c5c":function(t,n,i){"use strict";i.r(n);var e=i("2137"),o=i("702f");for(var u in o)"default"!==u&&function(t){i.d(n,t,(function(){return o[t]}))}(u);i("01e7"),i("c0d4"),i("8056");var s,a=i("f0c5"),r=Object(a["a"])(o["default"],e["b"],e["c"],!1,null,"6f6fbad0",null,!1,e["a"],s);n["default"]=r.exports},"702f":function(t,n,i){"use strict";i.r(n);var e=i("0332"),o=i.n(e);for(var u in e)"default"!==u&&function(t){i.d(n,t,(function(){return e[t]}))}(u);n["default"]=o.a},8056:function(t,n,i){"use strict";var e=i("9929"),o=i.n(e);o.a},8788:function(t,n,i){},9929:function(t,n,i){},c0d4:function(t,n,i){"use strict";var e=i("1ea8"),o=i.n(e);o.a},f2c3:function(t,n,i){"use strict";(function(t){i("4b62");e(i("66fd"));var n=e(i("4c5c"));function e(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(n.default)}).call(this,i("543d")["createPage"])}},[["f2c3","common/runtime","common/vendor"]]]);