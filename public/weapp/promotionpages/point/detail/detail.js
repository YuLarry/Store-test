(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["promotionpages/point/detail/detail"],{3887:function(n,t,o){},"8adc":function(n,t,o){"use strict";var i=o("3887"),e=o.n(i);e.a},a987:function(n,t,o){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=u(o("9374")),e=u(o("b6ac")),a=u(o("d78b"));function u(n){return n&&n.__esModule?n:{default:n}}var r=function(){o.e("components/uni-popup/uni-popup").then(function(){return resolve(o("d7b6"))}.bind(null,o)).catch(o.oe)},s=function(){o.e("components/uni-number-box/uni-number-box").then(function(){return resolve(o("ae1e"))}.bind(null,o)).catch(o.oe)},p=function(){Promise.all([o.e("common/vendor"),o.e("components/ns-goods-sku/ns-goods-sku")]).then(function(){return resolve(o("88b6"))}.bind(null,o)).catch(o.oe)},f=function(){o.e("components/toTop/toTop").then(function(){return resolve(o("9eed"))}.bind(null,o)).catch(o.oe)},c={components:{uniPopup:r,uniNumberBox:s,nsGoodsSku:p,toTop:f},data:function(){return{id:0,pointInfo:{image:"",pointCoupon:0},isIphoneX:!1,isLogin:!1,memberPoint:0,isCommunity:!1,memberId:0,shareImg:""}},mixins:[e.default,a.default],onLoad:function(t){var o=this;if(this.$util.getMemberId().then((function(n){o.memberId=n})).catch((function(n){console.log("reject",n)})),t.source_member&&n.setStorageSync("source_member",t.source_member),t.scene){var i=decodeURIComponent(t.scene);i=i.split("&"),i.length&&i.forEach((function(t){-1!=t.indexOf("sku_id")&&(o.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&n.setStorageSync("source_member",t.split("-")[1]),-1!=t.indexOf("is_test")&&n.setStorageSync("is_test",1)}))}this.isIphoneX=this.$util.uniappIsIPhoneX(),t.id?(this.id=t.id,this.getPointInfo()):this.$util.redirectTo("/promotionpages/point/list/list",{},"redirectTo")},onShow:function(){n.getStorageSync("token")&&n.getStorageSync("source_member")&&this.$util.onSourceMember(n.getStorageSync("source_member")),this.$langConfig.refresh()},onShareAppMessage:function(n){var t="",o="";switch(this.pointInfo.type){case 1:t=this.pointInfo.sku_name,o=this.pointInfo.sku_image;break;case 2:case 3:t=this.pointInfo.name,o=this.pointInfo.image;break}t="仅需"+this.pointInfo.point+"积分即可兑换"+t,o=this.$util.img(o);var i=this.$util.getCurrentShareRoute(this.memberId),e=i.path;return console.log({title:t,path:e,imageUrl:o,success:function(n){},fail:function(n){}}),{title:t,path:e,imageUrl:o,success:function(n){},fail:function(n){}}},onShareTimeline:function(){var n="",t="";switch(this.pointInfo.type){case 1:n=this.pointInfo.sku_name,t=this.pointInfo.sku_image;break;case 2:case 3:n=this.pointInfo.name,t=this.pointInfo.image;break}n="仅需"+this.pointInfo.point+"积分即可兑换"+n,t=this.$util.img(t);var o=this.$util.getCurrentShareRoute(this.memberId),i=o.query;return{title:n,query:i,imageUrl:t}},computed:{storeToken:function(){return this.$store.state.token},enough:function(){return parseInt(this.pointInfo.point)>parseInt(this.memberPoint)}},watch:{storeToken:function(n,t){n&&(this.isLogin=!0,this.getPointInfo())}},methods:{getAccountInfo:function(t,o){var i=this;n.getStorageSync("token")?this.$api.sendRequest({url:"/api/memberaccount/info",data:{account_type:"point"},success:function(n){if(0==n.code&&n.data){i.isLogin=!0,i.memberPoint=n.data.point;var e=Math.floor(parseInt(n.data.point)/o);i.Max=t>=e?e:t}else i.$util.showToast({title:n.message});i.$refs.loadingCover&&i.$refs.loadingCover.hide()}}):(this.isLogin=!1,this.$refs.loadingCover&&this.$refs.loadingCover.hide())},getPointInfo:function(){var n=this;this.$api.sendRequest({url:"/pointexchange/api/goods/detail",data:{id:this.id},success:function(t){if(t.code>=0&&0!==t.data.length){n.pointInfo=t.data,n.pointInfo.image?n.shareImg=n.$util.img(n.pointInfo.image):n.shareImg=n.$util.img("upload/uniapp/blindBox/default.png"),n.$langConfig.title(n.pointInfo.name);var o=2==n.pointInfo.type?n.pointInfo.count:n.pointInfo.stock;if(2==n.pointInfo.type&&-1==n.pointInfo.stock&&(n.pointInfo.pointCoupon=1),1==n.pointInfo.type){if(n.pointInfo.image=n.pointInfo["sku_image"],n.pointInfo.sku_spec_format&&(n.pointInfo.sku_spec_format=JSON.parse(n.pointInfo.sku_spec_format)),n.pointInfo.goods_attr_format){var e=JSON.parse(n.pointInfo.goods_attr_format);n.pointInfo.goods_attr_format=n.$util.unique(e,"attr_id");for(var a=0;a<n.pointInfo.goods_attr_format.length;a++)for(var u=0;u<e.length;u++)n.pointInfo.goods_attr_format[a].attr_id==e[u].attr_id&&n.pointInfo.goods_attr_format[a].attr_value_id!=e[u].attr_value_id&&(n.pointInfo.goods_attr_format[a].attr_value_name+="、"+e[u].attr_value_name)}n.pointInfo.goods_spec_format&&(n.pointInfo.goods_spec_format=JSON.parse(n.pointInfo.goods_spec_format))}n.pointInfo.unit=n.pointInfo.unit||"件",n.pointInfo.content&&(n.pointInfo.content=(0,i.default)(n.pointInfo.content)),n.getAccountInfo(o,n.pointInfo.point)}else n.$util.showToast({title:t.message}),setTimeout((function(){n.$util.redirectTo("/promotionpages/point/list/list",{},"redirectTo")}),1e3)}})},exchange:function(){n.getStorageSync("token")?this.$refs.goodsSku.show("point"):this.$refs.login.open("/promotionpages/point/detail/detail?id="+this.id)},refreshGoodsSkuDetail:function(n){Object.assign(this.pointInfo,n),this.pointInfo.unit=this.pointInfo.unit||"件"},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},imageError:function(){this.pointInfo.image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1}}};t.default=c}).call(this,o("543d")["default"])},ad64:function(n,t,o){"use strict";o.r(t);var i=o("a987"),e=o.n(i);for(var a in i)"default"!==a&&function(n){o.d(t,n,(function(){return i[n]}))}(a);t["default"]=e.a},babe:function(n,t,o){"use strict";o.r(t);var i=o("c2c6"),e=o("ad64");for(var a in e)"default"!==a&&function(n){o.d(t,n,(function(){return e[n]}))}(a);o("8adc"),o("dd4f");var u,r=o("f0c5"),s=Object(r["a"])(e["default"],i["b"],i["c"],!1,null,"42770288",null,!1,i["a"],u);t["default"]=s.exports},c2c6:function(n,t,o){"use strict";o.d(t,"b",(function(){return e})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return i}));var i={uniPopup:function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"d7b6"))},nsGoodsSku:function(){return Promise.all([o.e("common/vendor"),o.e("components/ns-goods-sku/ns-goods-sku")]).then(o.bind(null,"88b6"))},loadingCover:function(){return o.e("components/loading-cover/loading-cover").then(o.bind(null,"4c1d"))},nsLogin:function(){return Promise.all([o.e("common/vendor"),o.e("components/ns-login/ns-login")]).then(o.bind(null,"2bc6"))}},e=function(){var n=this,t=n.$createElement,o=(n._self._c,2==n.pointInfo.type&&n.pointInfo.image?n.$util.img(n.pointInfo.image):null),i=2!=n.pointInfo.type||n.pointInfo.image?null:n.$util.img("upload/uniapp/point/coupon.png"),e=2==n.pointInfo.type?n.$util.img("upload/uniapp/point/coupon.png"):null,a=2!=n.pointInfo.type&&3==n.pointInfo.type&&n.pointInfo.image?n.$util.img(n.pointInfo.image):null,u=2==n.pointInfo.type||3!=n.pointInfo.type||n.pointInfo.image?null:n.$util.img("upload/uniapp/point/hongbao.png"),r=2!=n.pointInfo.type&&3==n.pointInfo.type?n.$util.img("upload/uniapp/point/hongbao.png"):null,s=2!=n.pointInfo.type&&3!=n.pointInfo.type?n.$util.img(n.pointInfo.image):null,p="0.00"!=n.pointInfo.exchange_price&&n.pointInfo.pay_type>0?n.$lang("common.currencySymbol"):null,f=n.pointInfo.price?n.$lang("common.currencySymbol"):null,c=n.pointInfo.coupon_type&&1!=n.pointInfo.validity_type?n.$util.timeStampTurnTime(n.pointInfo.end_time):null,l=n.pointInfo.qr_data&&1==n.pointInfo.qr_data.qr_state?n.$util.img("/upload/uniapp/goods/detail_erweiImage.png"):null,m=n.pointInfo.qr_data&&n.pointInfo.qr_data.qr_img&&""!=n.pointInfo.qr_data.qr_img&&1==n.pointInfo.qr_data.qr_state?n.$util.img(n.pointInfo.qr_data.qr_img):null,d=n.pointInfo.qr_data&&n.pointInfo.qr_data.qr_img&&(""==n.pointInfo.qr_data.qr_img||1!=n.pointInfo.qr_data.qr_state)?n.$util.img("/upload/uniapp/goods/detail_erweiImage.png"):null;n.$mp.data=Object.assign({},{$root:{g0:o,g1:i,g2:e,g3:a,g4:u,g5:r,g6:s,m0:p,m1:f,g7:c,g8:l,g9:m,g10:d}})},a=[]},dd4f:function(n,t,o){"use strict";var i=o("e746"),e=o.n(i);e.a},df8c:function(n,t,o){"use strict";(function(n){o("67ba");i(o("66fd"));var t=i(o("babe"));function i(n){return n&&n.__esModule?n:{default:n}}n(t.default)}).call(this,o("543d")["createPage"])},e746:function(n,t,o){}},[["df8c","common/runtime","common/vendor"]]]);