(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["common/vendor"],{"0012":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"店铺笔记"};t.lang=o},"0145":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"核销台"};t.lang=o},"0225":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"帮助详情"};t.lang=o},"039a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"收货地址",newAddAddress:"新增地址",getAddress:"一键获取地址",is_default:"默认",modify:"编辑",del:"删除"};t.lang=o},"0549":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"兑换"};t.lang=o},"059c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品分类",seeMore:"查看更多"};t.lang=o},"08e5":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"积分中心"};t.lang=o},"095d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"大转盘"};t.lang=o},"0974":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},"09c6":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},"0a8a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"兑换结果",exchangeSuccess:"兑换成功",see:"查看兑换记录",goHome:"回到首页"};t.lang=o},"0b15":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},"0b23":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={tabBar:{home:"index",category:"category",cart:"cart",member:"member"},common:{name:"英文",mescrollTextInOffset:"pull to refresh",mescrollTextOutOffset:"Loading...",mescrollEmpty:"No data available",goodsRecommendTitle:"Guess you like",currencySymbol:"¥"}};t.lang=o},"0b61":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{collectionList:[],isShowEmpty:!1}},methods:{toDetail:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},getData:function(e){var t=this;this.isShowEmpty=!1;var i="/api/goodscollect/page",o=[];this.$api.sendRequest({url:i,data:{page_size:e.size,page:e.num},async:!1}).then((function(i){for(var r=i.data.list,a=0;a<r.length;a++)r[a].composite_score=Math.floor((parseFloat(r[a].shop_desccredit)+parseFloat(r[a].shop_servicecredit)+parseFloat(r[a].shop_deliverycredit))/3).toFixed(1);o=o.concat(r),1==e.num&&(t.collectionList=[]),t.collectionList=t.collectionList.concat(r),e.endSuccess(o.length),t.$refs.loadingCover&&t.$refs.loadingCover.hide(),t.isShowEmpty=!0}))},listenRefresh:function(e){this.$refs.goodsRecommend.init()},deleteItem:function(e){var t=this;this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:e},success:function(i){if(0==i.code){t.$util.showToast({title:"删除成功"});var o=t.collectionList,r=o.filter((function(t){return t.goods_id!=e}));t.collectionList=r}else t.$util.showToast({title:i.message})}})},imageError:function(e){this.collectionList[e].logo=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},goodsImageError:function(e){this.collectionList[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()}}};t.default=o},"0e06":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},"0f3f":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"专题活动列表"};t.lang=o},"10c8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},1155:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},1269:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"团购专区"};t.lang=o},"12d5":function(e,t,i){var o={"./en-us/common.js":"0b23","./zh-cn/bale/detail.js":"6546","./zh-cn/bale/payment.js":"d7ea","./zh-cn/bargain/detail.js":"0e06","./zh-cn/bargain/launch.js":"b19e","./zh-cn/bargain/list.js":"7139","./zh-cn/bargain/my_bargain.js":"979c","./zh-cn/bargain/payment.js":"7cc8","./zh-cn/combo/detail.js":"57a6","./zh-cn/combo/payment.js":"0974","./zh-cn/common.js":"a5c74","./zh-cn/diy/diy.js":"7bd8","./zh-cn/fenxiao/apply.js":"8d34","./zh-cn/fenxiao/bill.js":"669d","./zh-cn/fenxiao/follow.js":"76dc","./zh-cn/fenxiao/goods_list.js":"90fd","./zh-cn/fenxiao/index.js":"8672","./zh-cn/fenxiao/level.js":"bd8f","./zh-cn/fenxiao/order.js":"b8be","./zh-cn/fenxiao/order_detail.js":"180d","./zh-cn/fenxiao/promote_code.js":"8feb","./zh-cn/fenxiao/team.js":"7484","./zh-cn/fenxiao/withdraw_apply.js":"94d5","./zh-cn/fenxiao/withdraw_list.js":"0b15","./zh-cn/game/cards.js":"893d","./zh-cn/game/record.js":"7a9c","./zh-cn/game/smash_eggs.js":"d736","./zh-cn/game/turntable.js":"095d","./zh-cn/goods/brand.js":"2ef5","./zh-cn/goods/cart.js":"a44e","./zh-cn/goods/category.js":"059c","./zh-cn/goods/consult.js":"1a29","./zh-cn/goods/consult_edit.js":"ed97","./zh-cn/goods/coupon.js":"4e74","./zh-cn/goods/coupon_receive.js":"9fd1","./zh-cn/goods/detail.js":"c5be","./zh-cn/goods/evaluate.js":"e00f","./zh-cn/goods/list.js":"2668","./zh-cn/goods/point.js":"08e5","./zh-cn/goods/search.js":"e8f3","./zh-cn/groupbuy/detail.js":"74b5","./zh-cn/groupbuy/list.js":"1269","./zh-cn/groupbuy/payment.js":"25a9","./zh-cn/help/detail.js":"0225","./zh-cn/help/list.js":"4d54","./zh-cn/hongbao/list.js":"7856","./zh-cn/hongbao/my_hongbao.js":"2ee7","./zh-cn/index/index.js":"d609","./zh-cn/live/list.js":"4636","./zh-cn/login/find.js":"643d","./zh-cn/login/login.js":"b146","./zh-cn/login/register.js":"7e97","./zh-cn/member/account.js":"ab5c","./zh-cn/member/account_edit.js":"9720","./zh-cn/member/address.js":"039a","./zh-cn/member/address_edit.js":"5020","./zh-cn/member/apply_withdrawal.js":"35f7","./zh-cn/member/assets.js":"7f8b","./zh-cn/member/balance.js":"559f","./zh-cn/member/balance_detail.js":"f23e","./zh-cn/member/cancellation.js":"155e","./zh-cn/member/cancelrefuse.js":"443d","./zh-cn/member/cancelstatus.js":"bd9c","./zh-cn/member/cancelsuccess.js":"1b58","./zh-cn/member/card.js":"1cfd","./zh-cn/member/card_buy.js":"1a349","./zh-cn/member/collection.js":"ef62","./zh-cn/member/coupon.js":"89c8","./zh-cn/member/footprint.js":"b30d","./zh-cn/member/gift.js":"254b","./zh-cn/member/gift_detail.js":"3619","./zh-cn/member/index.js":"3e9f","./zh-cn/member/info.js":"af9e","./zh-cn/member/info_edit.js":"3b7b","./zh-cn/member/invite_friends.js":"ddb2","./zh-cn/member/level.js":"927e","./zh-cn/member/message.js":"ff13","./zh-cn/member/modify_face.js":"e0b7","./zh-cn/member/pay_password.js":"d0ad","./zh-cn/member/point.js":"15b5","./zh-cn/member/point_detail.js":"e7b0","./zh-cn/member/signin.js":"541e","./zh-cn/member/withdrawal.js":"8ba7","./zh-cn/member/withdrawal_detail.js":"fd32","./zh-cn/notice/detail.js":"3815","./zh-cn/notice/list.js":"3628","./zh-cn/order/activist.js":"4d85","./zh-cn/order/detail.js":"789a","./zh-cn/order/detail_local_delivery.js":"3253","./zh-cn/order/detail_pickup.js":"242a","./zh-cn/order/detail_point.js":"aa11","./zh-cn/order/detail_virtual.js":"67fd","./zh-cn/order/evaluate.js":"6bd1","./zh-cn/order/list.js":"d7f6","./zh-cn/order/logistics.js":"9176","./zh-cn/order/payment.js":"7b44","./zh-cn/order/refund.js":"aacf","./zh-cn/order/refund_batch.js":"a049","./zh-cn/order/refund_detail.js":"3a4d","./zh-cn/pay/index.js":"332d","./zh-cn/pay/result.js":"b0ec","./zh-cn/pintuan/detail.js":"10c8","./zh-cn/pintuan/list.js":"88a2","./zh-cn/pintuan/my_spell.js":"3baf","./zh-cn/pintuan/payment.js":"b8f2","./zh-cn/pintuan/share.js":"efbd","./zh-cn/point/detail.js":"0549","./zh-cn/point/goods_detail.js":"b8a2","./zh-cn/point/list.js":"5267","./zh-cn/point/order_detail.js":"b63e","./zh-cn/point/order_list.js":"b685","./zh-cn/point/payment.js":"6d13","./zh-cn/point/result.js":"0a8a","./zh-cn/presale/detail.js":"9656","./zh-cn/presale/list.js":"3ad1b","./zh-cn/presale/order_detail.js":"09c6","./zh-cn/presale/order_list.js":"d7b9","./zh-cn/presale/payment.js":"e01b","./zh-cn/recharge/detail.js":"cabf","./zh-cn/recharge/list.js":"58bb","./zh-cn/recharge/order_list.js":"7512","./zh-cn/seckill/detail.js":"1155","./zh-cn/seckill/list.js":"7c74","./zh-cn/seckill/payment.js":"ce17","./zh-cn/store_notes/note_detail.js":"4647","./zh-cn/store_notes/note_list.js":"0012","./zh-cn/storeclose/storeclose.js":"9915","./zh-cn/topics/detail.js":"32ab","./zh-cn/topics/goods_detail.js":"4f6f","./zh-cn/topics/list.js":"0f3f","./zh-cn/topics/payment.js":"3683","./zh-cn/verification/detail.js":"eb5e","./zh-cn/verification/index.js":"0145","./zh-cn/verification/list.js":"3070"};function r(e){var t=a(e);return i(t)}function a(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id="12d5"},1364:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i("a7e3"));function r(e){return e&&e.__esModule?e:{default:e}}var a={data:function(){return{timeoutObj:null,servicer_id:null,pingInterval:o.default.pingInterval}},onLoad:function(){var t=this;e.closeSocket(),t.checkOpenSocket()},methods:{checkOpenSocket:function(){console.log("判断是否已连接");var t=this;e.sendSocketMessage({data:"ping",success:function(e){console.log("连接成功,检查")},fail:function(e){console.log("连接失败"),t.openConnection()}})},openConnection:function(){console.log("打开连接"),e.connectSocket({url:o.default.webSocket,method:"POST",success:function(e){console.log("连接成功 connectSocket=",e)},fail:function(e){console.log("连接失败 connectSocket=",e)}}),this.onSocketMessage()},onSocketMessage:function(){var t=this;console.log("开始监听");var i=this;this.pingInterval=o.default.pingInterval,this.timeoutObj=null,e.onSocketMessage((function(o){var r=JSON.parse(o.data);if(console.log("监听该服务器消息",o),"close"==r.type)return clearInterval(i.timeoutObj),i.timeoutObj=null,void e.closeSocket();t.reset(),t.getSocketMsg(o.data)}))},getSocketMsg:function(e){var t=this,i=JSON.parse(e),o={isItMe:!1};if(o.contentType=i.type,"init"==i.type)t.$api.sendRequest({url:"/servicer/api/chat/bind",data:{client_id:i.data.client_id,site_id:t.siteId},success:function(e){0==e.code?t.servicer_id=e.data.servicer_id:t.servicer_id=0,t.getChatList()}});else{if("connect"==i.type)return!1;"string"==i.type?o.content=i.data.servicer_say:"image"==i.type?o.image=i.data.servicer_say:"order"==i.type?o.order_id=i.data.order_id:"goodssku"==i.type&&(o.sku_id=i.data.goods_sku_id)}"init"!=i.type&&(t.messageList.push(o),t.$nextTick((function(){t.setPageScrollTo()})))},reset:function(){console.log("检测心跳"),clearInterval(this.timeoutObj),this.start()},start:function(){console.log("启动心跳");var t=this;this.timeoutObj=setInterval((function(){e.sendSocketMessage({data:"ping",success:function(e){console.log("连接中....")},fail:function(e){console.log("连接失败重新连接...."),t.openConnection()}})}),this.pingInterval)}},onUnload:function(){clearInterval(this.timeoutObj),this.timeoutObj=null,this.$api.sendRequest({url:"/servicer/api/chat/bye",data:{servicer_id:this.servicer_id,site_id:this.siteId},success:function(t){e.closeSocket()},fail:function(t){e.closeSocket()}})}};t.default=a}).call(this,i("543d")["default"])},"155e":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账号注销"};t.lang=o},"15b5":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的积分"};t.lang=o},"180d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},"1a29":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品咨询"};t.lang=o},"1a349":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"会员卡"};t.lang=o},"1b58":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账号注销"};t.lang=o},"1cfd":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"会员卡"};t.lang=o},"1dd5":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},topic_info:{},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/topics/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("topicOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/topic/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);var i=this.orderPaymentData;if(void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var d=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;d.length&&(this.orderCreateData.invoice_content=d[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var c=this.orderPaymentData.shop_goods_list.local_config.info.time_week,l=!1,u=0;u<c.length;u++)if(u+1<c.length){var h=c[u+1]-c[u];if(h>1){l=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(l){var p=[];for(u=0;u<c.length;u++)p.push(f[c[u]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[c[0]]+"至"+f[c[c.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/topic/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.$api.sendRequest({url:"/topic/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else{var o=e.getStorageSync("topicOrderCreateData");o.out_trade_no=t.data,e.setStorageSync("topicOrderCreateData",o),i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1}else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){if(this.verify())switch(this.$refs.choosePaymentPopup.open(),this.orderCreateData.delivery.delivery_type){case"express":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.judge=!0;var t=e.getStorageSync("topicOrderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},2129:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:""},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},bale_info:{price:"0.00",num:0},member_account:{balance:0,is_pay_password:0},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTimeBar:!1},canLocalDelicery:!0,isFocus:!1,judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){this.$util.redirectTo("/otherpages/member/address/address",{back:"/promotionpages/bale/payment/payment"})},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("baleOrderCreateData");var i=this.$util.getLocation();i&&(this.orderCreateData=Object.assign(this.orderCreateData,i));var o=e.getStorageSync("store");o&&(this.orderCreateData.default_store_id=o.store_id),this.orderCreateData?this.$api.sendRequest({url:"/bale/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,console.log(t.orderPaymentData),t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):t.$util.showToast({title:"未获取到创建订单所需数据!！",success:function(){setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500)}})},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}}):this.$util.showToast({title:"未获取到创建订单所需数据!！",success:function(){setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500)}})},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="";var i=this.orderPaymentData;if(void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)}))}else a=o[0].name,s=o[0].title;this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var d=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;d.length&&(this.orderCreateData.invoice_content=d[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var c=this.orderPaymentData.shop_goods_list.local_config.info.time_week,l=!1,u=0;u<c.length;u++)if(u+1<c.length){var h=c[u+1]-c[u];if(h>1){l=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(l){var p=[];for(u=0;u<c.length;u++)p.push(f[c[u]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[c[0]]+"至"+f[c[c.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/bale/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!(this.orderPaymentData.delivery&&"local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&!(this.orderPaymentData.delivery&&"local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&""!==this.orderPaymentData.shop_goods_list.delivery.error)},openChoosePayment:function(){var t=this,i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/bale/api/ordercreate/verifyarea",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},orderCreate:function(){var t=this;if(this.verify()){if(this.isSub)return;this.isSub=!0;var i=this.$util.deepClone(this.orderCreateData);i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.$api.sendRequest({url:"/bale/api/ordercreate/create",data:i,success:function(i){i.code>=0?e.removeStorage({key:"baleOrderCreateData",success:function(){if(0==t.orderPaymentData.pay_money){switch(t.orderCreateData.delivery.delivery_type){case"express":break;case"store":t.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:t.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}t.$util.redirectTo("/otherpages/pay/result/result",{code:i.data},"redirectTo")}else{var o=e.getStorageSync("orderCreateData");o.out_trade_no=i.data,e.setStorageSync("orderCreateData",o),t.$refs.choosePaymentPopup.getPayInfo(i.data),t.isSub=!1}}}):(t.isSub=!1,e.hideLoading(),t.$refs.payPassword&&t.$refs.payPassword.close(),10==i.data.error_code||12==i.data.error_code?e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}}):t.$util.showToast({title:i.message}))}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if("店铺未开启配送时间"==this.deliveryWeek)return this.$util.showToast({title:"店铺未设置配送时间"}),!1;if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}if(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())return!1;if(this.orderPaymentData.system_form){var c=this.$refs.form.verify();if(!c)return!1}return!0},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&this.storeSelected(t),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},openSiteCoupon:function(){this.tempData={coupon:this.$util.deepClone(this.orderPaymentData.coupon)},this.$refs.couponPopup.open()},selectCoupon:function(e){this.orderCreateData.coupon.coupon_id!=e.coupon_id?(this.orderCreateData.coupon.coupon_id=e.coupon_id,this.orderCreateData.coupon.coupon_money=e.money):(this.orderCreateData.coupon.coupon_id=0,this.orderCreateData.coupon.coupon_money="0.00"),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},popupConfirm:function(e){this.$refs[e].close(),this.orderCalculate(),this.$forceUpdate(),this.tempData=null},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},setPayPassword:function(){this.$util.redirectTo("/otherpages/member/pay_password/pay_password",{back:"/promotionpages/bale/payment/payment"})},noSet:function(){this.orderCreateData.is_balance=0,this.$refs.payPassword.close(),this.orderCalculate(),this.$forceUpdate()},input:function(t){var i=this;6==t.length&&(e.showLoading({title:"支付中...",mask:!0}),this.$api.sendRequest({url:"/api/member/checkpaypassword",data:{pay_password:t},success:function(o){o.code>=0?(i.orderCreateData.pay_password=t,i.orderCreate()):(e.hideLoading(),i.$util.showToast({title:o.message}))},fail:function(t){e.hideLoading()}}))},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateBack:function(){this.$util.goBack()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openPasswordPopup:function(){var e=this;this.$refs.payPassword.open(),setTimeout((function(){e.isFocus=!0}),500)},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.judge=!0,e.getStorageSync("orderCreateData")&&e.getStorageSync("orderCreateData").out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)},promotion:function(e){var t="";return e&&Object.keys(e).forEach((function(i){t+=e[i].content+"　"})),t}}};t.default=i}).call(this,i("543d")["default"])},"213b":function(e,t,i){"use strict";(function(e){function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){var e;return{currTime:"",isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",default_store_id:""},orderPaymentData:{shop_goods_list:(e={site_name:"",express_type:[],coupon_list:[]},i(e,"coupon_list",[]),i(e,"invoice",{invoice_content_array:[]}),e),member_account:{balance:0,is_pay_password:0},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,is_deposit_back:0,switch_state:!0,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTimeBar:!1},canLocalDelicery:!0,isFocus:!1,member_id:0,presale_id:0,pay_password:"",action:{icon:""},deliveryWeek:""}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){this.$util.redirectTo("/otherpages/member/address/address",{back:"/promotionpages/presale/payment/payment"})},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("presaleOrderCreateData");var i=this.$util.getLocation();i&&(this.orderCreateData=Object.assign(this.orderCreateData,i));var o=e.getStorageSync("store");o&&(this.orderCreateData.default_store_id=o.store_id),this.orderCreateData?this.$api.sendRequest({url:"/presale/api/ordercreate/depositPayment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.is_deposit_back=e.data.promotion_presale_info.is_deposit_back,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):t.$util.showToast({title:"未获取到创建订单所需数据!！",success:function(){}})},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}}):this.$util.showToast({title:"未获取到创建订单所需数据!！",success:function(){setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500)}})},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);var i=this.orderPaymentData;if(void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var d=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;d.length&&(this.orderCreateData.invoice_content=d[0])}if(0==this.orderPaymentData.is_virtual&&this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1;var c=(new Date).getHours().toString(),l=(new Date).getMinutes().toString();1==c.length&&(c="0"+c),1==l.length&&(l="0"+l),this.orderCreateData.buyer_ask_delivery_time=c+":"+l;var u=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(u);var h=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(h)}Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/presale/api/ordercreate/depositCalculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.final_money=t.data.final_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!(this.orderPaymentData.delivery&&"local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.presale_deposit_money)&&!(this.orderPaymentData.delivery&&"local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&""!==this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(){var t=this;if(this.verify()){if(this.isSub)return;this.isSub=!0;var i=this.$util.deepClone(this.orderCreateData);i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.$api.sendRequest({url:"/presale/api/ordercreate/depositCreate",data:i,success:function(i){if(i.code>=0)if(0==t.orderPaymentData.pay_money){switch(t.orderCreateData.delivery.delivery_type){case"express":break;case"store":t.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:t.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}t.$util.redirectTo("/otherpages/pay/result/result",{code:i.data},"redirectTo")}else{var o=e.getStorageSync("presaleOrderCreateData");o.out_trade_no=i.data,e.setStorageSync("presaleOrderCreateData",o),t.$refs.choosePaymentPopup.getPayInfo(i.data),t.isSub=!1}else t.isSub=!1,e.hideLoading(),t.$refs.payPassword&&t.$refs.payPassword.close(),10==i.data.error_code||12==i.data.error_code?e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}}):t.$util.showToast({title:i.message})}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("{}"==JSON.stringify(this.orderCreateData.delivery))return this.$util.showToast({title:"店铺未设置配送方式"}),!1;if("store"==this.orderCreateData.delivery.delivery_type&&0==this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"店铺没有可提货的门店,请选择其他配送方式"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},openSiteCoupon:function(){this.tempData={coupon:this.$util.deepClone(this.orderPaymentData.coupon)},this.$refs.couponPopup.open()},selectCoupon:function(e){this.orderCreateData.coupon.coupon_id!=e.coupon_id?(this.orderCreateData.coupon.coupon_id=e.coupon_id,this.orderCreateData.coupon.coupon_money=e.money):(this.orderCreateData.coupon.coupon_id=0,this.orderCreateData.coupon.coupon_money="0.00"),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},popupConfirm:function(e){this.$refs[e].close(),this.orderCalculate(),this.$forceUpdate(),this.tempData=null},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},setPayPassword:function(){this.$util.redirectTo("/otherpages/member/pay_password/pay_password",{back:"/promotionpages/presale/payment/payment"})},noSet:function(){this.orderCreateData.is_balance=0,this.$refs.payPassword.close(),this.orderCalculate(),this.$forceUpdate()},input:function(t){var i=this;6==t.length&&(e.showLoading({title:"支付中...",mask:!0}),this.$api.sendRequest({url:"/api/member/checkpaypassword",data:{pay_password:t},success:function(o){o.code>=0?i.finalPay?(i.finalPay.pay_password=t,i.finalPay.member_id=i.member_id,i.finalPay.is_balance=i.finalPay.is_use_balance):(i.orderCreateData.pay_password=t,i.orderCreate()):(e.hideLoading(),i.$util.showToast({title:o.message}))},fail:function(t){e.hideLoading()}}))},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},navigateBack:function(){this.$util.goBack()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},switchChange:function(e){this.switch_state=e.detail.value},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){if(1==this.is_deposit_back){if(!this.switch_state)return this.$util.showToast({title:"预售商品定金不支持退款，请确定同意定金不退款协议。"}),!1;this.$refs.depositRefund.open()}else if(e.setStorageSync("paySource","presale"),this.verify())switch(this.$refs.choosePaymentPopup.open(),this.orderCreateData.delivery.delivery_type){case"express":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},toPayOrder:function(){e.setStorageSync("paySource","presale"),this.verify()&&(this.$refs.depositRefund.close(),this.$refs.choosePaymentPopup.open())},closeDepositRefund:function(){this.$refs.depositRefund.close()},presaleAgreement:function(){this.$refs.presaleAgreement.open()},closePresaleAgreement:function(){this.$refs.presaleAgreement.close()}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login");var t=e.getStorageSync("presaleOrderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/promotionpages/presale/order_list/order_list",{},"redirectTo"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onLoad:function(t){t.id&&(this.presale_id=t.id),e.getStorageSync("userInfo")&&(this.member_id=e.getStorageSync("userInfo").member_id)},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){var e=parseFloat(this.orderPaymentData.member_account.balance_total)<parseFloat(this.orderPaymentData.presale_deposit_money)?parseFloat(this.orderPaymentData.member_account.balance_total):parseFloat(this.orderPaymentData.presale_deposit_money);return e.toFixed(2)},presaleDiscount:function(){return(parseFloat(this.orderPaymentData.presale_money)-parseFloat(this.orderPaymentData.presale_deposit_money)).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)},promotion:function(e){var t="";return e&&Object.keys(e).forEach((function(i){t+=e[i].content+"　"})),t}}};t.default=o}).call(this,i("543d")["default"])},2236:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},bunding_info:{bl_name:""},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/combo/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("comboOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/bundling/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="";var i=this.orderPaymentData;if(void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(this.orderPaymentData.shop_goods_list.invoice){var d=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;d.length&&(this.orderCreateData.invoice_content=d[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var c=this.orderPaymentData.shop_goods_list.local_config.info.time_week,l=!1,u=0;u<c.length;u++)if(u+1<c.length){var h=c[u+1]-c[u];if(h>1){l=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(l){var p=[];for(u=0;u<c.length;u++)p.push(f[c[u]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[c[0]]+"至"+f[c[c.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/bundling/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.$api.sendRequest({url:"/bundling/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1;else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){if(this.verify())switch(this.$refs.choosePaymentPopup.open(),this.orderCreateData.delivery.delivery_type){case"express":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:this.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.judge=!0,this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)},promotionMoney:function(){return this.orderPaymentData.bunding_info.goods_money-this.orderPaymentData.bunding_info.bl_price}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},"23e9":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,41696,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){var t,i=348;for(t=32768;t>8;t>>=1)i+=this.lunarInfo[e-1900]&t?1:0;return i+this.leapDays(e)},leapMonth:function(e){return 15&this.lunarInfo[e-1900]},leapDays:function(e){return this.leapMonth(e)?65536&this.lunarInfo[e-1900]?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;var i=t-1;return 1==i?e%4==0&&e%100!=0||e%400==0?29:28:this.solarMonth[i]},toGanZhiYear:function(e){var t=(e-3)%10,i=(e-3)%12;return 0==t&&(t=10),0==i&&(i=12),this.Gan[t-1]+this.Zhi[i-1]},toAstro:function(e,t){var i="魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯",o=[20,19,21,21,21,22,23,23,23,23,22,22];return i.substr(2*e-(t<o[e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100)return-1;if(t<1||t>24)return-1;var i=this.sTermInfo[e-1900],o=[parseInt("0x"+i.substr(0,5)).toString(),parseInt("0x"+i.substr(5,5)).toString(),parseInt("0x"+i.substr(10,5)).toString(),parseInt("0x"+i.substr(15,5)).toString(),parseInt("0x"+i.substr(20,5)).toString(),parseInt("0x"+i.substr(25,5)).toString()],r=[o[0].substr(0,1),o[0].substr(1,2),o[0].substr(3,1),o[0].substr(4,2),o[1].substr(0,1),o[1].substr(1,2),o[1].substr(3,1),o[1].substr(4,2),o[2].substr(0,1),o[2].substr(1,2),o[2].substr(3,1),o[2].substr(4,2),o[3].substr(0,1),o[3].substr(1,2),o[3].substr(3,1),o[3].substr(4,2),o[4].substr(0,1),o[4].substr(1,2),o[4].substr(3,1),o[4].substr(4,2),o[5].substr(0,1),o[5].substr(1,2),o[5].substr(3,1),o[5].substr(4,2)];return parseInt(r[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;var t=this.nStr3[e-1];return t+="月",t},toChinaDay:function(e){var t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,i){if(e<1900||e>2100)return-1;if(1900==e&&1==t&&i<31)return-1;if(e)o=new Date(e,parseInt(t)-1,i);else var o=new Date;var r,a=0,s=0,n=(e=o.getFullYear(),t=o.getMonth()+1,i=o.getDate(),(Date.UTC(o.getFullYear(),o.getMonth(),o.getDate())-Date.UTC(1900,0,31))/864e5);for(r=1900;r<2101&&n>0;r++)s=this.lYearDays(r),n-=s;n<0&&(n+=s,r--);var d=new Date,c=!1;d.getFullYear()==e&&d.getMonth()+1==t&&d.getDate()==i&&(c=!0);var l=o.getDay(),u=this.nStr1[l];0==l&&(l=7);var h=r,f=(a=this.leapMonth(r),!1);for(r=1;r<13&&n>0;r++)a>0&&r==a+1&&0==f?(--r,f=!0,s=this.leapDays(h)):s=this.monthDays(h,r),1==f&&r==a+1&&(f=!1),n-=s;0==n&&a>0&&r==a+1&&(f?f=!1:(f=!0,--r)),n<0&&(n+=s,--r);var p=r,m=n+1,_=t-1,g=this.toGanZhiYear(h),y=this.getTerm(e,2*t-1),v=this.getTerm(e,2*t),b=this.toGanZhi(12*(e-1900)+t+11);i>=y&&(b=this.toGanZhi(12*(e-1900)+t+12));var D=!1,S=null;y==i&&(D=!0,S=this.solarTerm[2*t-2]),v==i&&(D=!0,S=this.solarTerm[2*t-1]);var k=Date.UTC(e,_,1,0,0,0,0)/864e5+25567+10,C=this.toGanZhi(k+i-1),P=this.toAstro(t,i);return{lYear:h,lMonth:p,lDay:m,Animal:this.getAnimal(h),IMonthCn:(f?"闰":"")+this.toChinaMonth(p),IDayCn:this.toChinaDay(m),cYear:e,cMonth:t,cDay:i,gzYear:g,gzMonth:b,gzDay:C,isToday:c,isLeap:f,nWeek:l,ncWeek:"星期"+u,isTerm:D,Term:S,astro:P}},lunar2solar:function(e,t,i,o){o=!!o;var r=this.leapMonth(e);this.leapDays(e);if(o&&r!=t)return-1;if(2100==e&&12==t&&i>1||1900==e&&1==t&&i<31)return-1;var a=this.monthDays(e,t),s=a;if(o&&(s=this.leapDays(e,t)),e<1900||e>2100||i>s)return-1;for(var n=0,d=1900;d<e;d++)n+=this.lYearDays(d);var c=0,l=!1;for(d=1;d<t;d++)c=this.leapMonth(e),l||c<=d&&c>0&&(n+=this.leapDays(e),l=!0),n+=this.monthDays(e,d);o&&(n+=a);var u=Date.UTC(1900,1,30,0,0,0),h=new Date(864e5*(n+i-31)+u),f=h.getUTCFullYear(),p=h.getUTCMonth()+1,m=h.getUTCDate();return this.solar2lunar(f,p,m)}},r=o;t.default=r},"242a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},"254b":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的礼品",emptyTips:"暂无礼品"};t.lang=o},"25a9":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},2668:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品列表"};t.lang=o},"27bc":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{mescroll:null,timeList:[],seckillId:null,seckillIndex:null,dataList:[],index:null,timer:null,noStartList:[]}},watch:{seckillId:function(e,t){e&&t&&e!=t&&this.mescroll.resetUpScroll(!1)}},computed:{show:function(){return this.timeList.length>0}},methods:{goodsImg:function(e){var t=e.split(",");return t[0]?this.$util.img(t[0],{size:"mid"}):this.$util.getDefaultImage().default_goods_img},transformSeckillTime:function(e){e=parseFloat(e);var t=parseInt(e/3600),i=parseInt(e%3600/60),o=parseInt(e%60);return t<10&&(t="0"+t),i<10&&(i="0"+i),o<10&&(o="0"+o),t+":"+i},isEnd:function(e){e&&this.$util.showToast({title:"限时秒杀活动已结束"})},getTimeList:function(){var e=this;this.$api.sendRequest({url:"/seckill/api/seckill/lists",success:function(t){var i=t.data;if(i){var o=new Date(1e3*t.timestamp),r=60*o.getHours()*60+60*o.getMinutes()+o.getSeconds(),a=Object.values(i.list);if(a.forEach((function(t,i){t.seckill_start_time<=r&&r<t.seckill_end_time?(t.isNow=!0,e.seckillId=t.id,e.index=i,e.seckillIndex=i):t.isNow=!1})),e.timeList=a,a.length){for(var s=Math.round(new Date/1e3),n=Math.round(new Date((new Date).toLocaleDateString()).getTime()/1e3),d=s-n,c=0;c<a.length;c++)if((r<a[c].seckill_start_time&&0==c||r<a[c].seckill_start_time&&r>a[c-1].seckill_end_time&&0!=c||c==a.length-1&&r>a[c].seckill_end_time)&&(e.seckillId=a[c].id,e.index=c,e.seckillIndex=c),d<a[c].seckill_start_time){var l=a[c];l.index=c,e.noStartList.push(l)}e.noStartList.length&&e.autoEvent()}var u=e;setInterval((function(){u.getExpirationTime()}),1e3),e.$refs.loadingCover&&e.$refs.loadingCover.hide()}}})},getData:function(e){var t=this;this.mescroll=e,this.$api.sendRequest({url:"/seckill/api/seckillgoods/page",data:{page_size:e.size,page:e.num,seckill_time_id:this.seckillId},success:function(i){t.showEmpty=!0;var o=[],r=i.message;0==i.code&&i.data?o=i.data.list:t.$util.showToast({title:r}),e.endSuccess(o.length),1==e.num&&(t.dataList=[]),t.dataList=t.dataList.concat(o),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(){e.endErr(),this.$refs.loadingCover&&this.$refs.loadingCover.hide()}})},getExpirationTime:function(){var e,t,i,o=this.timeList,r=new Date,a=r.toLocaleDateString();for(var s in o)if(o[s].isNow){this.ident=!0,t=Date.parse(r),e=Date.parse(a)+1e3*parseInt(o[s].seckill_end_time);var n=(e-t)/1e3;if(i=this.$util.countDown(n),this.hour=i.h,this.minute=i.i,this.second=i.s,0==n){var d=parseInt(s)+1;d<o.length&&(this.index=d),this.timeList[s].isNow=!1}return!1}this.ident=!1},ontabtap:function(e,t){this.seckillId=e,this.seckillIndex=t},toGoodsDetail:function(e,t){var i=this;this.seckillIndex<this.index?this.$util.showToast({title:"秒杀活动已结束！"}):this.seckillIndex>this.index?this.$util.showToast({title:"秒杀活动还未开启，敬请期待！"}):this.$api.sendRequest({url:"/api/config/time",data:{},success:function(o){var r=new Date(1e3*o.timestamp),a=60*r.getHours()*60+60*r.getMinutes()+r.getSeconds();i.timeList[t].seckill_start_time<=a&&a<i.timeList[t].seckill_end_time?i.timeList[t].isNow=!0:i.timeList[t].isNow=!1,i.$forceUpdate(),i.timeList[t].isNow?i.$util.redirectTo("/promotionpages/seckill/detail/detail",{seckill_id:e}):i.$util.showToast({title:"秒杀活动即将开启，敬请期待！"})}})},imageError:function(e){this.dataList[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},autoEvent:function(){var e=this;this.timer=setInterval((function(){for(var t=Math.round(new Date/1e3),i=Math.round(new Date((new Date).toLocaleDateString()).getTime()/1e3),o=t-i,r=0;r<e.noStartList.length;r++){var a=e.noStartList[r];o>a.seckill_start_time&&!a.isNow&&(e.seckillId=a.seckill_id,e.index=a.index,e.timeList[a.index].isNow=!0,void 0!=e.timeList[a.index-1]&&(e.timeList[a.index-1].isNow=!1),e.noStartList.splice(r))}0==e.noStartList.length&&clearInterval(e.timer)}),1e3)},goodsTag:function(e){return e.label_name||""}},onShareAppMessage:function(e){var t="一大波的秒杀福利就要开始了，真的不来看看嘛",i="/promotionpages/seckill/list/list";return{title:t,path:i,success:function(e){},fail:function(e){}}},onHide:function(){clearInterval(this.timer)}};t.default=o},"2e41":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function s(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var s=e.apply(t,i);function n(e){a(s,o,r,n,d,"next",e)}function d(e){a(s,o,r,n,d,"throw",e)}n(void 0)}))}}var n={data:function(){return{categoryAdvImage:"",isLoadingCate:!1,join_cart:"join_cart",goodsList:[],isAll:!1,isToken:!1,page_size:10,page_num:1,isNetwork:1,isLoading:!1,goodsSkuDetail:{},currentRoute:"",token:"",cartFlag:!1}},props:{value:{type:Object}},computed:{storeToken:function(){return this.isAll=!1,this.$store.state.token},addonIsExit:function(){return this.$store.state.addonIsExit}},watch:{storeToken:function(e,t){e&&this.getGoodsList()}},methods:{cartNumChange:function(t,i){var o=this;if(e.getStorageSync("token")){var r,a={num:1,cart_id:i.cart_id,sku_id:i.sku_id},s="",n=i.max_buy,d=n>0?n-i.purchased_num:i.stock;console.log(i,"goods"),1==i.is_limit&&1==i.limit_type&&n>0&&(d=n,console.log("333")),console.log(d,"0.0..00");var c=1;if(i.min_buy>1&&(c=i.min_buy),a.num=c,i.unit=i.unit||"件","add"==t){if(i.cart_id?(r="edit",s="/api/cart/edit"):(r="add",s="/api/cart/add"),0==d)return void this.$util.showToast({title:"库存不足"});if(i.cart_id&&i.num<d)a.num=++i.num;else{if(1==i.is_limit&&2==i.limit_type&&n>0&&i.purchased_num>0)return void this.$util.showToast({title:"该商品每人限购"+n+i.unit+"，您已购买了"+i.purchased_num+i.unit});if(1==i.is_limit&&2==i.limit_type&&n>0&&i.num>0&&i.num+a.num>n){var l=n-i.num;return void(l>0?this.$util.showToast({title:"该商品每人限购"+n+i.unit+"，购物车已加入了"+i.num+i.unit+"，还能购买"+l+i.unit}):this.$util.showToast({title:"该商品每人限购"+n+i.unit}))}}}else"minus"==t&&(a.num=i.num-1?i.num-1:0,s=a.num>0?"/api/cart/edit":"/api/cart/delete",r=a.num>0?"edit":"delete");if(this.cartFlag)return!1;this.cartFlag=!0,this.shopDataChange(a),this.$api.sendRequest({url:s,data:a,success:function(e){if(e.code>=0){if(e.data>0){if(o.$store.dispatch("getCartNumber"),"edit"==r)return o.cartFlag=!1,!1;a.cart_id="add"==r?e.data:"","add"==r&&o.$util.showToast({title:"加入购物车成功"})}else a.num=i.num,o.$util.showToast({title:e.message});o.shopDataChange(a)}o.cartFlag=!1}})}else this.$refs.login.open("/pages/goods/category/category")},shopDataChange:function(e){if(3!=this.value.level)for(var t=0;t<this.goodsList.length;t++){var i=this.goodsList[t];e.sku_id==i.sku_id&&(i.num=e.num,i.cart_id=e.cart_id)}else{var o=this.cateList[this.oneIndex].child_list[this.twoIndex].child_list;for(t=0;t<o.length;t++)if(-1!=this.threeIndex.indexOf(t))for(var r=0;r<o[t].goods_list.length;r++)e.sku_id==o[t].goods_list[r].sku_id&&(o[t].goods_list[r].num=e.num,o[t].goods_list[r].cart_id=e.cart_id)}this.$forceUpdate()},getGoodsSkuDetail:function(t){var i=this;return s(o.default.mark((function r(){var a,s;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(e.getStorageSync("token")){o.next=3;break}return i.$refs.login.open(i.currentRoute),o.abrupt("return");case 3:return o.next=5,i.$api.sendRequest({url:"/api/goodssku/getInfoForCategory",async:!1,data:{sku_id:t}});case 5:a=o.sent,s=a.data,s?(i.goodsSkuDetail=s,0==i.skuId&&(i.skuId=i.goodsSkuDetail.sku_id),i.goodsSkuDetail.unit=i.goodsSkuDetail.unit||"件",i.goodsSkuDetail.show_price=i.goodsSkuDetail.discount_price,i.goodsSkuDetail.sku_spec_format&&(i.goodsSkuDetail.sku_spec_format=JSON.parse(i.goodsSkuDetail.sku_spec_format)),i.goodsSkuDetail.goods_spec_format&&(i.goodsSkuDetail.goods_spec_format=JSON.parse(i.goodsSkuDetail.goods_spec_format)),i.$refs.goodSkuNew.show("join_cart",i.goodsSkuDetail,(function(){i.getCartCount()}))):i.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 8:case"end":return o.stop()}}),r)})))()},refreshGoodsSkuDetail:function(e){Object.assign(this.goodsSkuDetail,e)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},toDetail:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},goodsImageError:function(e,t){this.goodsList[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},diyRedirectTo:function(t){null!=t&&""!=t&&(t.wap_url||t.appid||t.mobile)&&(-1!=t.wap_url.indexOf("http")||-1!=t.wap_url.indexOf("http")?this.redirectTo("/otherpages/web/web?src="+t.wap_url):t.appid?e.navigateToMiniProgram({appId:t.appid,path:t.page}):t.mobile?e.makePhoneCall({phoneNumber:t.mobile,fail:function(e){console.log(e)}}):this.$util.redirectTo(t.wap_url))}}};t.default=n}).call(this,i("543d")["default"])},"2ee7":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的红包列表"};t.lang=o},"2ef5":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"品牌专区"};t.lang=o},"2f62":function(e,t,i){"use strict";i.r(t),function(e){
/*!
 * vuex v3.4.0
 * (c) 2020 Evan You
 * @license MIT
 */
function o(e){var t=Number(e.version.split(".")[0]);if(t>=2)e.mixin({beforeCreate:o});else{var i=e.prototype._init;e.prototype._init=function(e){void 0===e&&(e={}),e.init=e.init?[o].concat(e.init):o,i.call(this,e)}}function o(){var e=this.$options;e.store?this.$store="function"===typeof e.store?e.store():e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}}i.d(t,"Store",(function(){return _})),i.d(t,"createNamespacedHelpers",(function(){return M})),i.d(t,"install",(function(){return x})),i.d(t,"mapActions",(function(){return R})),i.d(t,"mapGetters",(function(){return j})),i.d(t,"mapMutations",(function(){return E})),i.d(t,"mapState",(function(){return O}));var r="undefined"!==typeof window?window:"undefined"!==typeof e?e:{},a=r.__VUE_DEVTOOLS_GLOBAL_HOOK__;function s(e){a&&(e._devtoolHook=a,a.emit("vuex:init",e),a.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){a.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){a.emit("vuex:action",e,t)}),{prepend:!0}))}function n(e,t){Object.keys(e).forEach((function(i){return t(e[i],i)}))}function d(e){return null!==e&&"object"===typeof e}function c(e){return e&&"function"===typeof e.then}function l(e,t){return function(){return e(t)}}var u=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var i=e.state;this.state=("function"===typeof i?i():i)||{}},h={namespaced:{configurable:!0}};h.namespaced.get=function(){return!!this._rawModule.namespaced},u.prototype.addChild=function(e,t){this._children[e]=t},u.prototype.removeChild=function(e){delete this._children[e]},u.prototype.getChild=function(e){return this._children[e]},u.prototype.hasChild=function(e){return e in this._children},u.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},u.prototype.forEachChild=function(e){n(this._children,e)},u.prototype.forEachGetter=function(e){this._rawModule.getters&&n(this._rawModule.getters,e)},u.prototype.forEachAction=function(e){this._rawModule.actions&&n(this._rawModule.actions,e)},u.prototype.forEachMutation=function(e){this._rawModule.mutations&&n(this._rawModule.mutations,e)},Object.defineProperties(u.prototype,h);var f=function(e){this.register([],e,!1)};function p(e,t,i){if(t.update(i),i.modules)for(var o in i.modules){if(!t.getChild(o))return void 0;p(e.concat(o),t.getChild(o),i.modules[o])}}f.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},f.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,i){return t=t.getChild(i),e+(t.namespaced?i+"/":"")}),"")},f.prototype.update=function(e){p([],this.root,e)},f.prototype.register=function(e,t,i){var o=this;void 0===i&&(i=!0);var r=new u(t,i);if(0===e.length)this.root=r;else{var a=this.get(e.slice(0,-1));a.addChild(e[e.length-1],r)}t.modules&&n(t.modules,(function(t,r){o.register(e.concat(r),t,i)}))},f.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),i=e[e.length-1];t.getChild(i).runtime&&t.removeChild(i)},f.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),i=e[e.length-1];return t.hasChild(i)};var m;var _=function(e){var t=this;void 0===e&&(e={}),!m&&"undefined"!==typeof window&&window.Vue&&x(window.Vue);var i=e.plugins;void 0===i&&(i=[]);var o=e.strict;void 0===o&&(o=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new f(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new m,this._makeLocalGettersCache=Object.create(null);var r=this,a=this,n=a.dispatch,d=a.commit;this.dispatch=function(e,t){return n.call(r,e,t)},this.commit=function(e,t,i){return d.call(r,e,t,i)},this.strict=o;var c=this._modules.root.state;D(this,c,[],this._modules.root),b(this,c),i.forEach((function(e){return e(t)}));var l=void 0!==e.devtools?e.devtools:m.config.devtools;l&&s(this)},g={state:{configurable:!0}};function y(e,t,i){return t.indexOf(e)<0&&(i&&i.prepend?t.unshift(e):t.push(e)),function(){var i=t.indexOf(e);i>-1&&t.splice(i,1)}}function v(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var i=e.state;D(e,i,[],e._modules.root,!0),b(e,i,t)}function b(e,t,i){var o=e._vm;e.getters={},e._makeLocalGettersCache=Object.create(null);var r=e._wrappedGetters,a={};n(r,(function(t,i){a[i]=l(t,e),Object.defineProperty(e.getters,i,{get:function(){return e._vm[i]},enumerable:!0})}));var s=m.config.silent;m.config.silent=!0,e._vm=new m({data:{$$state:t},computed:a}),m.config.silent=s,e.strict&&w(e),o&&(i&&e._withCommit((function(){o._data.$$state=null})),m.nextTick((function(){return o.$destroy()})))}function D(e,t,i,o,r){var a=!i.length,s=e._modules.getNamespace(i);if(o.namespaced&&(e._modulesNamespaceMap[s],e._modulesNamespaceMap[s]=o),!a&&!r){var n=I(t,i.slice(0,-1)),d=i[i.length-1];e._withCommit((function(){m.set(n,d,o.state)}))}var c=o.context=S(e,s,i);o.forEachMutation((function(t,i){var o=s+i;C(e,o,t,c)})),o.forEachAction((function(t,i){var o=t.root?i:s+i,r=t.handler||t;P(e,o,r,c)})),o.forEachGetter((function(t,i){var o=s+i;$(e,o,t,c)})),o.forEachChild((function(o,a){D(e,t,i.concat(a),o,r)}))}function S(e,t,i){var o=""===t,r={dispatch:o?e.dispatch:function(i,o,r){var a=T(i,o,r),s=a.payload,n=a.options,d=a.type;return n&&n.root||(d=t+d),e.dispatch(d,s)},commit:o?e.commit:function(i,o,r){var a=T(i,o,r),s=a.payload,n=a.options,d=a.type;n&&n.root||(d=t+d),e.commit(d,s,n)}};return Object.defineProperties(r,{getters:{get:o?function(){return e.getters}:function(){return k(e,t)}},state:{get:function(){return I(e.state,i)}}}),r}function k(e,t){if(!e._makeLocalGettersCache[t]){var i={},o=t.length;Object.keys(e.getters).forEach((function(r){if(r.slice(0,o)===t){var a=r.slice(o);Object.defineProperty(i,a,{get:function(){return e.getters[r]},enumerable:!0})}})),e._makeLocalGettersCache[t]=i}return e._makeLocalGettersCache[t]}function C(e,t,i,o){var r=e._mutations[t]||(e._mutations[t]=[]);r.push((function(t){i.call(e,o.state,t)}))}function P(e,t,i,o){var r=e._actions[t]||(e._actions[t]=[]);r.push((function(t){var r=i.call(e,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:e.getters,rootState:e.state},t);return c(r)||(r=Promise.resolve(r)),e._devtoolHook?r.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):r}))}function $(e,t,i,o){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return i(o.state,o.getters,e.state,e.getters)})}function w(e){e._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}function I(e,t){return t.reduce((function(e,t){return e[t]}),e)}function T(e,t,i){return d(e)&&e.type&&(i=t,t=e,e=e.type),{type:e,payload:t,options:i}}function x(e){m&&e===m||(m=e,o(m))}g.state.get=function(){return this._vm._data.$$state},g.state.set=function(e){0},_.prototype.commit=function(e,t,i){var o=this,r=T(e,t,i),a=r.type,s=r.payload,n=(r.options,{type:a,payload:s}),d=this._mutations[a];d&&(this._withCommit((function(){d.forEach((function(e){e(s)}))})),this._subscribers.slice().forEach((function(e){return e(n,o.state)})))},_.prototype.dispatch=function(e,t){var i=this,o=T(e,t),r=o.type,a=o.payload,s={type:r,payload:a},n=this._actions[r];if(n){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(s,i.state)}))}catch(c){0}var d=n.length>1?Promise.all(n.map((function(e){return e(a)}))):n[0](a);return new Promise((function(e,t){d.then((function(t){try{i._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(s,i.state)}))}catch(c){0}e(t)}),(function(e){try{i._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(s,i.state,e)}))}catch(c){0}t(e)}))}))}},_.prototype.subscribe=function(e,t){return y(e,this._subscribers,t)},_.prototype.subscribeAction=function(e,t){var i="function"===typeof e?{before:e}:e;return y(i,this._actionSubscribers,t)},_.prototype.watch=function(e,t,i){var o=this;return this._watcherVM.$watch((function(){return e(o.state,o.getters)}),t,i)},_.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._vm._data.$$state=e}))},_.prototype.registerModule=function(e,t,i){void 0===i&&(i={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),D(this,this.state,e,this._modules.get(e),i.preserveState),b(this,this.state)},_.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var i=I(t.state,e.slice(0,-1));m.delete(i,e[e.length-1])})),v(this)},_.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},_.prototype.hotUpdate=function(e){this._modules.update(e),v(this,!0)},_.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(_.prototype,g);var O=N((function(e,t){var i={};return A(t).forEach((function(t){var o=t.key,r=t.val;i[o]=function(){var t=this.$store.state,i=this.$store.getters;if(e){var o=U(this.$store,"mapState",e);if(!o)return;t=o.context.state,i=o.context.getters}return"function"===typeof r?r.call(this,t,i):t[r]},i[o].vuex=!0})),i})),E=N((function(e,t){var i={};return A(t).forEach((function(t){var o=t.key,r=t.val;i[o]=function(){var t=[],i=arguments.length;while(i--)t[i]=arguments[i];var o=this.$store.commit;if(e){var a=U(this.$store,"mapMutations",e);if(!a)return;o=a.context.commit}return"function"===typeof r?r.apply(this,[o].concat(t)):o.apply(this.$store,[r].concat(t))}})),i})),j=N((function(e,t){var i={};return A(t).forEach((function(t){var o=t.key,r=t.val;r=e+r,i[o]=function(){if(!e||U(this.$store,"mapGetters",e))return this.$store.getters[r]},i[o].vuex=!0})),i})),R=N((function(e,t){var i={};return A(t).forEach((function(t){var o=t.key,r=t.val;i[o]=function(){var t=[],i=arguments.length;while(i--)t[i]=arguments[i];var o=this.$store.dispatch;if(e){var a=U(this.$store,"mapActions",e);if(!a)return;o=a.context.dispatch}return"function"===typeof r?r.apply(this,[o].concat(t)):o.apply(this.$store,[r].concat(t))}})),i})),M=function(e){return{mapState:O.bind(null,e),mapGetters:j.bind(null,e),mapMutations:E.bind(null,e),mapActions:R.bind(null,e)}};function A(e){return L(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function L(e){return Array.isArray(e)||d(e)}function N(e){return function(t,i){return"string"!==typeof t?(i=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,i)}}function U(e,t,i){var o=e._modulesNamespaceMap[i];return o}var F={Store:_,install:x,version:"3.4.0",mapState:O,mapMutations:E,mapGetters:j,mapActions:R,createNamespacedHelpers:M};t["default"]=F}.call(this,i("c8ba"))},3023:function(e,t,i){"use strict";(function(e){function i(e){return s(e)||a(e)||r(e)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){if(e){if("string"===typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}function a(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function s(e){if(Array.isArray(e))return n(e)}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var d={data:function(){return{listStyle:"",loadingType:"loading",orderType:"",priceOrder:"desc",categoryList:[],goodsList:[],order:"",sort:"desc",showScreen:!1,keyword:"",categoryId:0,minPrice:"",maxPrice:"",isFreeShipping:!1,isIphoneX:!1,coupon:0,emptyShow:!1,isList:!0,memberId:0,share_title:"",count:0,category_title:"",coupon_name:"",listHeight:[],debounce:null}},onLoad:function(t){var i=this;if(this.categoryId=t.category_id||0,this.keyword=t.keyword||"",this.coupon=t.coupon||0,this.goods_id_arr=t.goods_id_arr||0,this.loadCategoryList(this.categoryId),this.isIphoneX=this.$util.uniappIsIPhoneX(),this.$util.getMemberId().then((function(e){i.memberId=e})).catch((function(e){console.log("reject",e)})),t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene){var o=decodeURIComponent(t.scene);o=o.split("&"),o.length&&o.forEach((function(t){-1!=t.indexOf("sku_id")&&(i.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1]),-1!=t.indexOf("is_test")&&e.setStorageSync("is_test",1)}))}e.onWindowResize((function(e){i.debounce&&clearTimeout(i.debounce),i.debounce=setTimeout((function(){i.isList||i.waterfallflow(0)}),600)}))},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member")),setTimeout((function(){}),2e3)},onShareAppMessage:function(e){var t="搜索到"+this.count+"件“"+this.keyword+this.category_title+this.coupon_name+"”相关的优质商品",i=this.$util.getCurrentShareRoute(this.memberId),o=i.path;return{title:t,path:o,success:function(e){},fail:function(e){}}},onShareTimeline:function(){var e="搜索到"+this.count+"件“"+this.keyword+this.category_title+this.coupon_name+"”相关的优质商品",t=this.$util.getCurrentShareRoute(this.memberId),i=t.query;return{title:e,query:i,imageUrl:""}},methods:{couponInfo:function(e){var t=this;return new Promise((function(i){t.$api.sendRequest({url:"/coupon/api/coupon/typeinfo",data:{coupon_type_id:e},success:function(e){e.code>=0&&i(e.data.coupon_name)}})}))},share_select:function(e,t){return new Promise((function(i){e.forEach((function(e){e.category_id==t&&i(e.category_name),e.child_list&&e.child_list.length>0&&e.child_list.forEach((function(e){e.category_id==t&&i(e.category_name),e.child_list&&e.child_list.length>0&&e.forEach((function(e){e.category_id==t&&i(e.category_name)}))}))}))}))},loadCategoryList:function(e,t){var i=this;this.$api.sendRequest({url:"/api/goodscategory/tree",data:{},success:function(e){null!=e.data&&(i.categoryList=e.data)}})},getGoodsList:function(e){var t=this;this.$api.sendRequest({url:"/api/goodssku/page",data:{page:e.num,page_size:e.size,keyword:this.keyword,category_id:this.categoryId,min_price:this.minPrice,max_price:this.maxPrice,is_free_shipping:this.isFreeShipping?1:0,order:this.order,sort:this.sort,coupon:this.coupon,goods_id_arr:this.goods_id_arr},success:function(i){var o=[],r=i.message;0==i.code&&i.data?(t.count=i.data.count,0==i.data.page_count&&(t.emptyShow=!0),o=i.data.list):t.$util.showToast({title:r}),t.category_title="",t.coupon_name="",t.categoryId&&t.share_select(t.categoryList,t.categoryId).then((function(e){t.category_title=e})),t.coupon&&t.couponInfo(t.coupon).then((function(e){t.coupon_name=e})),e.endSuccess(o.length),1==e.num&&(t.goodsList=[]),t.goodsList=t.goodsList.concat(o),t.$refs.loadingCover&&t.$refs.loadingCover.hide(),t.isList||setTimeout((function(){t.waterfallflow(10*(e.num-1))}),100)},fail:function(i){e.endErr(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},changeListStyle:function(){this.isList=!this.isList},sortTabClick:function(e){if("sale_num"==e)this.order="sale_num",this.sort="desc";else if("discount_price"==e)this.order="discount_price",this.sort="desc";else{if("screen"==e)return void(this.showScreen=!0);this.order="",this.sort=""}this.orderType===e&&"discount_price"!==e||(this.orderType=e,"discount_price"===e?(this.priceOrder="asc"===this.priceOrder?"desc":"asc",this.sort=this.priceOrder):this.priceOrder="",this.emptyShow=!1,this.goodsList=[],this.$refs.mescroll.refresh())},toDetail:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.sku_id})},search:function(){this.emptyShow=!1,this.goodsList=[],this.$refs.mescroll.refresh()},selectedCategory:function(e){this.categoryId=e},screenData:function(){if(""!=this.minPrice||""!=this.maxPrice){if(!Number(this.minPrice)&&this.minPrice)return void this.$util.showToast({title:"请输入最低价"});if(!Number(this.maxPrice)&&this.maxPrice)return void this.$util.showToast({title:"最输入最高价"});if(Number(this.minPrice)<0||Number(this.maxPrice)<0)return void this.$util.showToast({title:"筛选价格不能小于0"});if(""!=this.minPrice&&Number(this.minPrice)>Number(this.maxPrice)&&this.maxPrice)return void this.$util.showToast({title:"最低价不能大于最高价"});if(""!=this.maxPrice&&Number(this.maxPrice)<Number(this.minPrice))return void this.$util.showToast({title:"最高价不能小于最低价"})}this.emptyShow=!1,this.goodsList=[],this.$refs.mescroll.refresh(),this.showScreen=!1},resetData:function(){this.categoryId=0,this.minPrice="",this.maxPrice="",this.isFreeShipping=!1},goodsImg:function(e){var t=e.split(",");return t[0]?this.$util.img(t[0],{size:"mid"}):this.$util.getDefaultImage().default_goods_img},imgError:function(e){this.goodsList[e].goods_image=this.$util.getDefaultImage().default_goods_img},showPrice:function(e){var t=e.discount_price;return e.member_price&&parseFloat(e.member_price)<parseFloat(t)&&(t=e.member_price),t},goodsTag:function(e){return e.label_name||""},waterfallflow:function(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=2,a=this.$refs.goodsItem;0==o&&(this.listHeight=[]);for(var s=o;s<a.length;s++)s<r?(a[s].$el.style.top=e.upx2px(20)+"px",a[s].$el.style.left=s%r==0?a[0].$el.clientWidth*s+"px":a[0].$el.clientWidth*s+s%r*e.upx2px(30)+"px",this.listHeight.push(a[s].$el.clientHeight+e.upx2px(20))):function(){var o=Math.min.apply(Math,i(t.listHeight)),r=t.listHeight.findIndex((function(e){return e===o}));a[s].$el.style.top=t.listHeight[r]+e.upx2px(20)+"px",a[s].$el.style.left=a[r].$el.offsetLeft+"px",t.listHeight[r]+=a[s].$el.clientHeight+e.upx2px(20)}()}},watch:{isList:function(e){var t=this;e||setTimeout((function(){t.waterfallflow(0)}),100)}}};t.default=d}).call(this,i("543d")["default"])},3070:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"核销记录",emptyTips:"暂无记录"};t.lang=o},"319c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Weixin=void 0;var o=function(){var e=i("94ea");this.wexin=e,this.init=function(t){e.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["chooseWXPay","openAddress","updateAppMessageShareData","updateTimelineShareData","scanQRCode","hideMenuItems"]})},this.pay=function(t,i){e.ready((function(){e.chooseWXPay({timestamp:t.timestamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign,success:function(e){"function"==typeof i&&i(e)}})}))},this.openAddress=function(t){e.ready((function(){e.openAddress({success:function(e){"function"==typeof t&&t(e)},fail:function(e){alert(JSON.stringify(e))}})}))},this.setShareData=function(t,i){e.ready((function(){e.updateAppMessageShareData({title:t.title||"",desc:t.desc||"",link:t.link||"",imgUrl:t.imgUrl||"",success:function(e){"function"==typeof i&&i(e)},fail:function(e){console.log("分享数据报错err",e)}}),e.updateTimelineShareData({title:t.title||"",link:t.link||"",imgUrl:t.imgUrl||"",success:function(e){"function"==typeof i&&i(e)}})}))},this.scanQRCode=function(t){e.ready((function(){e.scanQRCode({needResult:1,scanType:["qrCode"],success:function(e){"function"==typeof t&&t(e)}})}))}};t.Weixin=o},3253:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},"32ab":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"专题活动详情"};t.lang=o},"332d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"支付方式",paymentAmount:"支付金额",confirmPayment:"确认支付",seeOrder:"查看订单"};t.lang=o},"35f7":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"申请提现"};t.lang=o},3619:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"礼品订单"};t.lang=o},3628:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"公告列表",emptyText:"当前暂无更多信息",contentTitle:"升级公告"};t.lang=o},3631:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(i("a7e3")),r=s(i("3926")),a=s(i("d978"));function s(e){return e&&e.__esModule?e:{default:e}}var n="weapp",d="微信小程序",c={sendRequest:function(t){var i=void 0!=t.data?"POST":"GET",s=o.default.baseUrl+t.url,c={app_type:n,app_type_name:d};if(e.getStorageSync("token")&&(c.token=e.getStorageSync("token")),e.getStorageSync("store")&&(c.store_id=e.getStorageSync("store").store_id),void 0!=t.data&&Object.assign(c,t.data),!1===t.async)return new Promise((function(o,n){e.request({url:s,method:i,data:c,header:t.header||{"content-type":"application/x-www-form-urlencoded;application/json"},dataType:t.dataType||"json",responseType:t.responseType||"text",success:function(t){if(-3==t.data.code&&a.default.state.siteState>0)return a.default.commit("setSiteState",-3),void r.default.redirectTo("/otherpages/storeclose/storeclose/storeclose",{},"reLaunch");t.data.refreshtoken&&e.setStorage({key:"token",data:t.data.refreshtoken}),-10009!=t.data.code&&-10010!=t.data.code||e.removeStorage({key:"token"}),o(t.data)},fail:function(e){n(e)},complete:function(e){n(e)}})}));e.request({url:s,method:i,data:c,header:t.header||{"content-type":"application/x-www-form-urlencoded;application/json"},dataType:t.dataType||"json",responseType:t.responseType||"text",success:function(i){if(-3==i.data.code&&a.default.state.siteState>0)return a.default.commit("setSiteState",-3),void r.default.redirectTo("/otherpages/storeclose/storeclose/storeclose",{},"reLaunch");i.data.refreshtoken&&e.setStorage({key:"token",data:i.data.refreshtoken}),-10009!=i.data.code&&-10010!=i.data.code||e.removeStorage({key:"token"}),"function"==typeof t.success&&t.success(i.data)},fail:function(e){"function"==typeof t.fail&&t.fail(e)},complete:function(e){"function"==typeof t.complete&&t.complete(e)}})}};t.default=c}).call(this,i("543d")["default"])},3683:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},3815:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"公告详情"};t.lang=o},3898:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{bargain_id:0,skuId:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:{},goodsCircle:!1,timestamp:"",evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},isCommunity:!1,videoContext:"",source_member:0}},onLoad:function(t){var i=this;return n(o.default.mark((function r(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.bargain_id=t.bargain_id||0,t.id&&(i.bargain_id=t.id),t.source_member&&(i.source_member=t.source_member),i.isIphoneX=i.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene&&(a=decodeURIComponent(t.scene),a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(i.bargain_id=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))),i.getService(),o.next=9,i.getGoodsSkuDetail();case 9:i.getEvaluateConfig();case 10:case"end":return o.stop()}}),r)})))()},onShow:function(){this.$langConfig.refresh(),this.token=e.getStorageSync("token"),this.getKekuConfig(),this.modifyGoodsInfo(),""!=this.token&&(this.getCartCount(),this.getMemberId()),this.videoContext=e.createVideoContext("goodsVideo"),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},methods:{goConnect:function(){if(e.getStorageSync("token")){var t={sku_id:this.goodsSkuDetail.sku_id,type:"bargain",type_id:this.goodsSkuDetail.bargain_id};return this.$util.redirectTo("/otherpages/chat/room/room",t),!1}this.source_member?this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id+"&source_member="+this.source_member):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id)},getGoodsSkuDetail:function(){var e=this;return n(o.default.mark((function t(){var i,a,s,n,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/bargain/api/goods/detail",async:!1,data:{bargain_id:e.bargain_id}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,e.goodsSkuDetail.stock=e.goodsSkuDetail.bargain_stock,e.skuId=e.goodsSkuDetail.sku_id,e.goodsSkuDetail.end_time-i.timestamp>0?e.goodsSkuDetail.timeMachine=e.$util.countDown(e.goodsSkuDetail.end_time-i.timestamp):(e.$util.showToast({title:"活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.show_price=e.goodsSkuDetail.floor_price,e.goodsSkuDetail.save_price=e.goodsSkuDetail.price-e.goodsSkuDetail.show_price>0?(e.goodsSkuDetail.price-e.goodsSkuDetail.show_price).toFixed(2):0,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(s=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(s,"attr_id"),n=0;n<e.goodsSkuDetail.goods_attr_format.length;n++)for(d=0;d<s.length;d++)e.goodsSkuDetail.goods_attr_format[n].attr_id==s[d].attr_id&&e.goodsSkuDetail.goods_attr_format[n].attr_value_id!=s[d].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[n].attr_value_name+="、"+s[d].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/bargain/detail/detail?bargain_id="+e.bargain_id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},""!=e.token&&e.getWhetherCollection(),e.setWechatShare(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},bargain:function(){var t=this;e.getStorageSync("token")?this.goodsSkuDetail.sku_spec_format?this.$refs.goodsSku.show("bargain",(function(){})):this.$api.sendRequest({url:"/bargain/api/bargain/launch",data:{id:this.goodsSkuDetail.id},success:function(e){0==e.code?t.$util.redirectTo("/promotionpages/bargain/launch/launch",{id:e.data},"redirectTo"):t.$util.showToast({title:e.message})}}):this.source_member?this.$refs.login.open("/promotionpages/bargain/detail/detail?bargain_id="+this.bargain_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/bargain/detail/detail?bargain_id="+this.bargain_id)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.forEach((function(t,i){e.goodsEvaluate[i].images&&(e.goodsEvaluate[i].images=e.goodsEvaluate[i].images.split(",")),1==e.goodsEvaluate[i].is_anonymous&&(e.goodsEvaluate[i].member_name=e.goodsEvaluate[i].member_name.replace(e.goodsEvaluate[i].member_name.substring(1,e.goodsEvaluate[i].member_name.length-1),"***"))})))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.source_member?this.$refs.login.open("/promotionpages/bargain/detail/detail?bargain_id="+this.bargain_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/bargain/detail/detail?bargain_id="+this.bargain_id)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));t.token,t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={id:this.goodsSkuDetail.id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/bargain/api/goods/poster",data:{page:"/promotionpages/bargain/detail/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})},fail:function(e){}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/bargain/detail/detail?bargain_id="+this.bargain_id;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toEvaluateDetail:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++)for(var a=i[r].children,s=0;s<a.length;s++)a[s].attrs&&a[s].attrs.src&&o.push(a[s].attrs.src);e.previewImage({current:o,urls:o})}}};t.default=d}).call(this,i("543d")["default"])},3926:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(i("a34a")),r=s(i("a7e3")),a=(s(i("d978")),s(i("3631")));function s(e){return e&&e.__esModule?e:{default:e}}function n(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function d(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function s(e){n(a,o,r,s,d,"next",e)}function d(e){n(a,o,r,s,d,"throw",e)}s(void 0)}))}}var c={redirectTo:function(t,i,o){for(var r=t,a=["/pages/index/index/index","/pages/goods/category/category","/pages/goods/cart/cart","/pages/member/index/index"],s=0;s<a.length;s++)if(-1!=t.indexOf(a[s]))return void e.switchTab({url:r});switch(void 0!=i&&Object.keys(i).forEach((function(e){-1!=r.indexOf("?")?r+="&"+e+"="+i[e]:r+="?"+e+"="+i[e]})),o){case"tabbar":e.switchTab({url:r});break;case"redirectTo":e.redirectTo({url:r});break;case"reLaunch":e.reLaunch({url:r});break;default:e.navigateTo({url:r})}},img:function(e,t){var i="";if(e&&void 0!=e&&""!=e){if(t&&e!=this.getDefaultImage().default_goods_img){var o=e.split("."),a=o[o.length-1];o.pop(),o[o.length-1]=o[o.length-1]+"_"+t.size.toUpperCase(),o.push(a),e=o.join(".")}i=-1==e.indexOf("http://")&&-1==e.indexOf("https://")?r.default.imgDomain+"/"+e:e,i=i.replace("addons/NsGoodsAssist/","").replace("shop/goods/","")}return i},timeStampTurnTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(void 0!=e&&""!=e&&e>0){var i=new Date;i.setTime(1e3*e);var o=i.getFullYear(),r=i.getMonth()+1;r=r<10?"0"+r:r;var a=i.getDate();a=a<10?"0"+a:a;var s=i.getHours();s=s<10?"0"+s:s;var n=i.getMinutes(),d=i.getSeconds();return n=n<10?"0"+n:n,d=d<10?"0"+d:d,t?o+"-"+r+"-"+a:o+"-"+r+"-"+a+" "+s+":"+n+":"+d}return""},timeTurnTimeStamp:function(e){var t=e.split(" ",2),i=(t[0]?t[0]:"").split("-",3),o=(t[1]?t[1]:"").split(":",3);return new Date(parseInt(i[0],10)||null,(parseInt(i[1],10)||1)-1,parseInt(i[2],10)||null,parseInt(o[0],10)||null,parseInt(o[1],10)||null,parseInt(o[2],10)||null).getTime()/1e3},countDown:function(e){var t=0,i=0,o=0,r=0;return e>0&&(t=Math.floor(e/86400),i=Math.floor(e/3600)-24*t,o=Math.floor(e/60)-24*t*60-60*i,r=Math.floor(e)-24*t*60*60-60*i*60-60*o),t<10&&(t="0"+t),i<10&&(i="0"+i),o<10&&(o="0"+o),r<10&&(r="0"+r),{d:t,h:i,i:o,s:r}},unique:function(e,t){var i=new Map;return e.filter((function(e){return!i.has(e[t])&&i.set(e[t],1)}))},inArray:function(e,t){return null==t?-1:t.indexOf(e)},getDay:function(e){var t=new Date,i=t.getTime()+864e5*e;t.setTime(i);var o=function(e){var t=e;return 1==e.toString().length&&(t="0"+e),t},r=t.getFullYear(),a=t.getMonth(),s=t.getDate(),n=t.getDay(),d=parseInt(t.getTime()/1e3);a=o(a+1),s=o(s);var c=["周日","周一","周二","周三","周四","周五","周六"];return{t:d,y:r,m:a,d:s,w:c[n]}},upload:function(t,i,r,a){var s="weapp",n="微信小程序",c={token:e.getStorageSync("token"),app_type:s,app_type_name:n};c=Object.assign(c,i);var l=t,u=this;e.chooseImage({count:l,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var e=d(o.default.mark((function e(t){var s,n,d,l,h;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s=t.tempFilePaths,n=c,d=[],l=0;case 4:if(!(l<s.length)){e.next=12;break}return e.next=7,u.upload_file_server(s[l],n,i.path,a);case 7:h=e.sent,d.push(h);case 9:l++,e.next=4;break;case 12:"function"==typeof r&&r(d);case 13:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()})},upload_file_server:function(t,i,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(a)var s=r.default.baseUrl+a;else s=r.default.baseUrl+"/api/upload/"+o;return new Promise((function(o,r){e.uploadFile({url:s,filePath:t,name:"file",formData:i,success:function(e){var t=JSON.parse(e.data);t.code>=0?o(t.data.pic_path):r("error")}})}))},copy:function(t,i){e.setClipboardData({data:t,success:function(){"function"==typeof i&&i()}})},isWeiXin:function(){return!1},showToast:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.title=t.title||"",t.icon=t.icon||"none",t.duration=1500,e.showToast(t),setTimeout((function(){}),1500),t.success&&t.success()},isIPhoneX:function(){var t=e.getSystemInfoSync();return-1!=t.model.search("iPhone X")},isAndroid:function(){var t=e.getSystemInfoSync().platform;return"ios"!=t&&("android"==t||void 0)},deepClone:function(e){var t=function(e){return"object"==typeof e};if(!t(e))throw new Error("obj 不是一个对象！");var i=Array.isArray(e),o=i?[]:{};for(var r in e)o[r]=t(e[r])?this.deepClone(e[r]):e[r];return o},refreshBottomNav:function(){var t=e.getStorageSync("bottom_nav");t=JSON.parse(t);for(var i=0;i<t.list.length;i++){var o=t.list[i],r={index:i};r.text=o.title,r.iconPath=this.img(o.iconPath),r.selectedIconPath=this.img(o.selectedIconPath),1==t.type||2==t.type||t.type,e.setTabBarItem(r)}},diyRedirectTo:function(t,i){null!=t&&""!=t&&(t.wap_url||t.appid||t.mobile)&&(-1!=t.wap_url.indexOf("http")||-1!=t.wap_url.indexOf("http")?this.redirectTo("/otherpages/web/web?src="+t.wap_url):t.appid?e.navigateToMiniProgram({appId:t.appid,path:t.page}):t.mobile?e.makePhoneCall({phoneNumber:t.mobile,fail:function(e){console.log(e)}}):this.redirectTo(t.wap_url))},getDefaultImage:function(){var t=e.getStorageSync("default_img");return t?(t=JSON.parse(t),t.default_goods_img=this.img(t.default_goods_img),t.default_headimg=this.img(t.default_headimg),t.default_storeimg=this.img(t.default_storeimg),t):{default_goods_img:"",default_headimg:"",default_storeimg:""}},uniappIsIPhoneX:function(){var t=!1,i=e.getSystemInfoSync();return-1==i.model.search("iPhone X")&&-1==i.model.search("iPhone 11")&&-1==i.model.search("iPhone 12")||(t=!0),t},uniappIsIPhone11:function(){var t=!1,i=e.getSystemInfoSync();return-1!=i.model.search("iPhone 11")&&(t=!0),t},jumpPage:function(t){for(var i=!0,o=getCurrentPages().reverse(),r=0;r<o.length;r++)if(-1!=t.indexOf(o[r].route)){i=!1,e.navigateBack({delta:r});break}i&&this.$util.diyRedirectTo(t)},getDistance:function(e,t,i,o){var r=e*Math.PI/180,a=i*Math.PI/180,s=r-a,n=t*Math.PI/180-o*Math.PI/180,d=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(r)*Math.cos(a)*Math.pow(Math.sin(n/2),2)));return d*=6378.137,d=Math.round(1e4*d)/1e4,d},goBack:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/pages/index/index/index";1==getCurrentPages().length?this.redirectTo(t):e.navigateBack()},numberFixed:function(e,t){return t||(t=0),Number(e).toFixed(t)},getUrlCode:function(e){var t=location.search,i=new Object;if(-1!=t.indexOf("?"))for(var o=t.substr(1),r=o.split("&"),a=0;a<r.length;a++)i[r[a].split("=")[0]]=r[a].split("=")[1];"function"==typeof e&&e(i)},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},getLocation:function(){var t=(new Date).getTime(),i=e.getStorageSync("userLocation");return i.time&&i.info&&t-i.time<864e5?i.info:new Promise((function(t,i){e.getLocation({type:"gcj02",success:function(i){var o={latitude:i.latitude,longitude:i.longitude};e.setStorage({key:"userLocation",data:{time:(new Date).getTime(),info:o}}),t(o)},fail:function(e){}})}))},onSourceMember:function(t){a.default.sendRequest({url:"/api/Member/alterShareRelation",data:{share_member:t},success:function(t){t.code>=0&&e.removeStorage({key:"source_member",success:function(e){console.log("删除成功",e)}})}})},subscribeMessage:function(t){var i=t;a.default.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:i},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){console.log("res",e)},fail:function(e){console.log("fail",e)}})}})},getMemberId:function(){return new Promise((function(e,t){a.default.sendRequest({url:"/api/member/id",success:function(i){i.code>=0?e(i.data):t(i)}})}))},getMpShare:function(e){if(!e){var t=this.getCurrentRoute();e=t.path}return new Promise((function(t,i){a.default.sendRequest({url:"/weapp/api/weapp/share",data:{path:e},success:function(e){if(e.code>=0){var o=e.data.data;if(o){var r={title:o.title,path:o.path,imageUrl:o.imageUrl,success:function(e){},fail:function(e){}};o.path.indexOf("?")>0&&o.path.split("?")[1];var a={title:o.title,query:o.path,imageUrl:o.imageUrl};t({appMessage:r,timeLine:a})}else i(e.data)}else i(e.data)}})}))},getCurrentRoute:function(){var e=getCurrentPages(),t=e[e.length-1].route,i=e[e.length-1].options,o=[];for(var r in i)o.push(r+"="+i[r]);var a="/"+t,s=o.join("&");return s&&(a+="?"+s),{path:a,query:s}},getCurrentShareRoute:function(e){var t=this.getCurrentRoute();return t.path=t.path.replace(/[?|&]source_member=\d+/,""),e&&(t.path.indexOf("?")>0?t.path+="&":t.path+="?",t.path+="source_member="+e,t.query&&(t.query+="&"),t.query+="source_member="+e),t}};t.default=c}).call(this,i("543d")["default"])},"3a4d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"退款详情"};t.lang=o},"3ad1b":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"预售专区"};t.lang=o},"3b7b":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"个人资料",headImg:"头像",account:"账号",username:"用户名",nickname:"昵称",realName:"真实姓名",sex:"性别",birthday:"生日",password:"密码",paypassword:"支付密码",mobilePhone:"手机",bindMobile:"绑定手机",cancellation:"注销账号",lang:"语言",logout:"退出登录",save:"保存",noset:"未设置",usernamePlaceholder:"请输入新用户名",nickPlaceholder:"请输入新昵称",pleaseRealName:"请输入真实姓名",nowPassword:"当前密码",newPassword:"新密码",confirmPassword:"确认新密码",phoneNumber:"手机号",confirmCode:"验证码",confirmCodeInput:"请输入验证码",confirmCodeInputerror:"验证码错误",findanimateCode:"获取动态码",animateCode:"动态码",animateCodeInput:"请输入动态码",modifyNickname:"修改昵称",modifyPassword:"修改密码",bindPhone:"绑定手机",alikeusername:"与原用户名一致，无需修改",noEmityUsername:"用户名不能为空",alikeNickname:"与原昵称一致，无需修改",noEmityNickname:"昵称不能为空",updateSuccess:"修改成功",pleaseInputOldPassword:"请输入原始密码",pleaseInputNewPassword:"请输入新密码",passwordLength:"密码长度不能小于6位",alikePassword:"两次密码不一致",samePassword:"新密码不能与原密码相同",surePhoneNumber:"请输入正确的手机号",alikePhone:"与原手机号一致，无需修改",modify:"修改"};t.lang=o},"3baf":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的拼单"};t.lang=o},"3bf1":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,Function.prototype.asyAfter=function(e){var t=this;return function(){var i=t.apply(this,arguments);return"next"===i?e.apply(this,arguments):i}},Date.prototype.pattern=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},i={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};for(var o in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+i[this.getDay()+""])),t)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[o]:("00"+t[o]).substr((""+t[o]).length)));return e};var o=function(e){return/^\[object\s(.*)\]$/.exec(Object.prototype.toString.call(e))[1]},r=function(){},a=r.prototype;a.getUnix=function(){return(new Date).getTime()},a.getTodayUnix=function(){var e=new Date,t="".concat(e.getFullYear(),"/").concat(e.getMonth()+1,"/").concat(e.getDate()," 00:00:00");return new Date(t).getTime()},a.getYearUnix=function(){var e=new Date;return e.setMonth(0),e.setDate(1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e.getTime()},a.getLastDate=function(e){if(e){var t=new Date(e);if(t.pattern)return t.pattern("yyyy-MM-dd");var i=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,o=t.getDate()<10?"0"+t.getDate():t.getDate();return t.getFullYear()+"-"+i+"-"+o}};var s=function(e,t){var i=function(e){return e<=0||Math.floor(e/60)<=0?"刚刚":"next"},o=function(e){return e<3600?Math.floor(e/60)+"分钟前":"next"},r=function(e,t){var i=d.getTodayUnix();return e>=3600&&t-i>=0?Math.floor(e/60/60)+"小时前":"next"},a=function(e,t){var i=d.getTodayUnix();return e=(i-t)/1e3,e/86400<=31?Math.ceil(e/86400)+"天前":"next"},s=function(e,t){return d.getLastDate(t)},n=i.asyAfter(o).asyAfter(r).asyAfter(a).asyAfter(s);return n(e,t)},n=new RegExp("-","g");a.getFormatTime=function(e,t){if(!e)return"";switch(o(e)){case"Date":e=e.getTime();break;case"String":e=e.replace(n,"/");default:e=new Date(e).getTime();break}var i=this.getUnix(),r=(this.getYearUnix(),(i-e)/1e3);if(e>i&&t)return this.getLastDate(e);return s(r,e)};var d=new r,c=d;t.default=c},"3e9f":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"会员中心",login:"立即登录",loginTpis:"登录体验更多功能",memberLevel:"会员等级",moreAuthority:"更多权限",allOrders:"全部订单",seeAllOrders:"查看全部订单",waitPay:"待付款",readyDelivery:"待发货",waitDelivery:"待收货",waitEvaluate:"待评价",refunding:"退款",sign:"签到",personInfo:"个人资料",receivingAddress:"收货地址",accountList:"账户列表",couponList:"优惠券",mySpellList:"我的拼单",myBargain:"我的砍价",virtualCode:"虚拟码",winningRecord:"我的礼品",myCollection:"我的关注",myTracks:"我的足迹",pintuanOrder:"拼团订单",yushouOrder:"预售订单",verification:"核销台",message:"我的消息",exchangeOrder:"积分兑换",balance:"余额",point:"积分",coupon:"优惠券",memberRecommend:"邀请有礼",myPresale:"我的预售",myGiftcard:"我的礼品卡",myDivideticket:"我的瓜分券",myRebate:"拼团返利",myHongbao:"我的红包列表",myBlindBox:"我的盲盒"};t.lang=o},"40f9":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:"",invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[],invoice_type:[]}},pintuan_info:{},pintuan_group_info:{},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/pintuan/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("pintuanOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/pintuan/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:e.message}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);for(var i=0;i<this.orderPaymentData.shop_goods_list.goods_list.length;i++)this.orderPaymentData.shop_goods_list.goods_list[i].goods_image=this.orderPaymentData.shop_goods_list.goods_list[i].goods_image?this.orderPaymentData.shop_goods_list.goods_list[i].goods_image.split(",")[0]:"";var o=this.orderPaymentData;if(void 0!=o.shop_goods_list.express_type&&void 0!=o.shop_goods_list.express_type[0]){var r=o.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var a=e.getStorageSync("delivery");if(a){var s=a.name,n=a.title;"store"==s&&(o.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""})}else{s=r[0].name;"store"==s&&(this.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""});n=r[0].title}this.orderCreateData.delivery.delivery_type=s,this.orderCreateData.delivery.delivery_type_name=n,"store"==r[0].name&&this.storeSelected(r[0])}if(void 0!=o.shop_goods_list.coupon_list&&void 0!=o.shop_goods_list.coupon_list[0]){var d=o.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=d[0].coupon_id,this.orderCreateData.coupon.coupon_money=d[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var c=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;c.length&&(this.orderCreateData.invoice_content=c[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;var l=this.orderPaymentData.shop_goods_list.local_config.info.time_week,u=!1;for(i=0;i<l.length;i++)if(i+1<l.length){var h=l[i+1]-l[i];if(h>1){u=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(u){var p=[];for(i=0;i<l.length;i++)p.push(f[l[i]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[l[0]]+"至"+f[l[l.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/pintuan/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/pintuan/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else{var o=e.getStorageSync("pintuanOrderCreateData");o.out_trade_no=t.data,e.setStorageSync("pintuanOrderCreateData",o),i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1}else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].goods_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this;console.log(this.orderCreateData);var i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/pintuan/api/ordercreate/verifyareaorstock",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("进入同城配送");var t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};console.log("向组件传递的数据 -- obj",i),this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(console.log("进入门店自提"),console.log("this.orderPaymentData.shop_goods_list",this.orderPaymentData.shop_goods_list),this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};console.log("向组件传递的数据 -- obj",o),this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.judge=!0;var t=e.getStorageSync("pintuanOrderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},4312:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{skuId:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",couponList:[],couponBtnSwitch:!1,token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,manjian:{type:0,manjian_name:"",rule_json:null},goodsEvaluate:[{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""}],bundling:[{bundling_goods:{bl_name:"",sku_image:""}}],memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:null,preview:0,goodsCircle:!1,levelInfo:{},showFenxiao:0,evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},kefuConfig:{},membercard:null,isCommunity:!1,bundlingType:!1,videoContext:""}},computed:{showDiscount:function(){var e=!1;return 0==this.preview&&this.addonIsExit.discount&&1==this.goodsSkuDetail.promotion_type&&this.goodsSkuDetail.discountTimeMachine&&(!this.goodsSkuDetail.member_price||this.goodsSkuDetail.member_price>0&&Number(this.goodsSkuDetail.member_price)>Number(this.goodsSkuDetail.discount_price))&&(e=!0),e},memberCardDiscount:function(){var e=0,t=this.goodsSkuDetail.member_price>0&&Number(this.goodsSkuDetail.member_price)<Number(this.goodsSkuDetail.discount_price)?this.goodsSkuDetail.member_price:this.goodsSkuDetail.discount_price;return this.membercard&&this.membercard.member_price>0&&parseFloat(t)>parseFloat(this.membercard.member_price)&&(e=parseFloat(t)-parseFloat(this.membercard.member_price)),e.toFixed(2)}},onLoad:function(t){var i=this;if(this.skuId=t.sku_id||0,this.preview=t.preview||0,this.isIphoneX=this.$util.uniappIsIPhoneX(),this.getService(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene){var o=decodeURIComponent(t.scene);o=o.split("&"),o.length&&o.forEach((function(t){-1!=t.indexOf("sku_id")&&(i.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1]),-1!=t.indexOf("is_test")&&e.setStorageSync("is_test",1)}))}},onShow:function(){var t=this;return n(o.default.mark((function i(){return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.$langConfig.refresh(),t.token=e.getStorageSync("token"),""!=t.token&&0==t.preview&&(t.getCartCount(),t.getMemberId()),t.getKekuConfig(),i.next=6,t.getGoodsSkuDetail();case 6:0==t.preview&&(t.modifyGoodsInfo(),t.getCoupon(),t.getManjian(),t.getEvaluateConfig(),t.videoContext=e.createVideoContext("goodsVideo"),t.getBundling(),t.$store.dispatch("getAddonIsexit").then((function(e){t.showFenxiao=e.fenxiao,t.showKefu=e.servicer,0!=t.showFenxiao&&t.getFenxiaoGoodsDetail()}))),e.getStorageSync("token")&&e.getStorageSync("source_member")&&t.$util.onSourceMember(e.getStorageSync("source_member"));case 8:case"end":return i.stop()}}),i)})))()},onHide:function(){this.couponBtnSwitch=!1},methods:{SetSkuid:function(e){this.skuId=e,this.getBundling()},goConnect:function(){if(e.getStorageSync("token")){var t=this.goodsSkuDetail.goods_promotion[0],i={sku_id:this.goodsSkuDetail.sku_id};return t&&(t.bargain_id&&(i.type="bargain",i.type_id=t.bargain_id),t.discount_id&&(i.type="discount",i.type_id=t.discount_id)),this.$util.redirectTo("/otherpages/chat/room/room",i),!1}this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id)},getFenxiaoGoodsDetail:function(){var e=this;this.$api.sendRequest({url:"/fenxiao/api/goods/detail",data:{sku_id:this.skuId},success:function(t){0==t.code&&t.data&&(e.levelInfo=t.data)}})},getGoodsSkuDetail:function(e){var t=this;return n(o.default.mark((function i(){var a,s,n,d,c;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.skuId=e||t.skuId,i.next=3,t.$api.sendRequest({url:"/api/goodssku/detail",async:!1,data:{sku_id:t.skuId}});case 3:if(a=i.sent,s=a.data,null==s.goods_sku_detail){i.next=30;break}if(!("presale"==s.goods_sku_detail.promotion_type&&s.goods_sku_detail.end_time-a.timestamp>0)){i.next=9;break}return t.$util.redirectTo("/promotionpages/presale/detail/detail",{id:s.goods_sku_detail.presale_id,sku_id:t.skuId},"reLaunch"),i.abrupt("return");case 9:if(t.goodsSkuDetail=s.goods_sku_detail,t.goodsSkuDetail.preview=t.preview,0==t.skuId&&(t.skuId=t.goodsSkuDetail.sku_id),t.goodsSkuDetail.video_url&&(t.switchMedia="video"),t.goodsSkuDetail.sku_images?t.goodsSkuDetail.sku_images=t.goodsSkuDetail.sku_images.split(","):t.goodsSkuDetail.sku_images=[],t.goodsSkuDetail.goods_spec_format&&t.goodsSkuDetail.goods_image&&(t.goodsSkuDetail.goods_image=t.goodsSkuDetail.goods_image.split(","),t.goodsSkuDetail.sku_images=t.goodsSkuDetail.sku_images.concat(t.goodsSkuDetail.goods_image)),t.goodsSkuDetail.unit=t.goodsSkuDetail.unit||"件",t.goodsSkuDetail.sku_spec_format&&(t.goodsSkuDetail.sku_spec_format=JSON.parse(t.goodsSkuDetail.sku_spec_format)),t.goodsSkuDetail.goods_attr_format)for(n=JSON.parse(t.goodsSkuDetail.goods_attr_format),t.goodsSkuDetail.goods_attr_format=t.$util.unique(n,"attr_id"),d=0;d<t.goodsSkuDetail.goods_attr_format.length;d++)for(c=0;c<n.length;c++)t.goodsSkuDetail.goods_attr_format[d].attr_id==n[c].attr_id&&t.goodsSkuDetail.goods_attr_format[d].attr_value_id!=n[c].attr_value_id&&(t.goodsSkuDetail.goods_attr_format[d].attr_value_name+="、"+n[c].attr_value_name);t.goodsSkuDetail.goods_spec_format&&(t.goodsSkuDetail.goods_spec_format=JSON.parse(t.goodsSkuDetail.goods_spec_format)),t.$langConfig.title(t.goodsSkuDetail.goods_name),t.goodsSkuDetail.goods_content&&(t.goodsSkuDetail.goods_content=(0,r.default)(t.goodsSkuDetail.goods_content)),1==t.goodsSkuDetail.promotion_type&&t.addonIsExit.discount&&(t.goodsSkuDetail.end_time-a.timestamp>0?t.goodsSkuDetail.discountTimeMachine=t.$util.countDown(t.goodsSkuDetail.end_time-a.timestamp):t.goodsSkuDetail.promotion_type=0),1==t.goodsSkuDetail.promotion_type&&t.goodsSkuDetail.discountTimeMachine?t.goodsSkuDetail.member_price>0&&Number(t.goodsSkuDetail.member_price)<=Number(t.goodsSkuDetail.discount_price)?t.goodsSkuDetail.show_price=t.goodsSkuDetail.member_price:t.goodsSkuDetail.show_price=t.goodsSkuDetail.discount_price:t.goodsSkuDetail.member_price>0?t.goodsSkuDetail.show_price=t.goodsSkuDetail.member_price:t.goodsSkuDetail.show_price=t.goodsSkuDetail.price,t.contactData={title:t.goodsSkuDetail.sku_name,path:"/pages/goods/detail/detail?sku_id="+t.skuId,img:t.$util.img(t.goodsSkuDetail.sku_image,{size:"big"})},""!=t.token&&0==t.preview&&(t.getWhetherCollection(),t.addonIsExit.supermember&&t.getMemberInfo()),t.$refs.goodsPromotion&&t.$refs.goodsPromotion.refresh(t.goodsSkuDetail.goods_promotion),t.$refs.loadingCover&&t.$refs.loadingCover.hide(),t.goodsSyncToGoodsCircle(),i.next=31;break;case 30:t.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 31:case"end":return i.stop()}}),i)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.$refs.goodsPromotion&&this.$refs.goodsPromotion.refresh(this.goodsSkuDetail.goods_promotion),this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},refreshLevelInfo:function(e){this.$refs.refLeverInfo.levelInfo.commission_money=e.commission_money},goHome:function(){this.preview||this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.preview||this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},choiceSku:function(){var e=this;this.$refs.goodsSku.show("buy_now",(function(){e.getCartCount()}))},joinCart:function(){var t=this;e.getStorageSync("token")||0!=this.preview?1==this.goodsSkuDetail.is_virtual?this.$refs.goodsSku.show("buy_now",(function(){t.getCartCount()})):this.$refs.goodsSku.show("join_cart",(function(){t.getCartCount()})):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.skuId)},buyNow:function(){var t=this;e.getStorageSync("token")||0!=this.preview?this.$refs.goodsSku.show("buy_now",(function(){t.getCartCount()})):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.skuId)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},getCoupon:function(){var e=this;this.$api.sendRequest({url:"/coupon/api/coupon/goodsCoupon",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.couponList=i)}})},openCouponPopup:function(){this.$refs.couponPopup.open()},closeCouponPopup:function(){this.$refs.couponPopup.close()},receiveCoupon:function(e){var t=this;this.preview||this.couponBtnSwitch||(this.couponBtnSwitch=!0,this.token?this.$api.sendRequest({url:"/coupon/api/coupon/receive",data:{coupon_type_id:e,get_type:2},success:function(i){i.data;var o=i.message;0==i.code&&(o="领取成功"),t.$util.showToast({title:o}),t.couponBtnSwitch=!1,i.data.is_exist&&t.refreshCoupon(e)}}):(this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.skuId),this.couponBtnSwitch=!1))},refreshCoupon:function(e){for(var t in this.couponList){var i=this.couponList[t];e==i.coupon_type_id&&(i.is_lingqu=1)}this.$forceUpdate()},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.forEach((function(t,i){e.goodsEvaluate[i].images&&(e.goodsEvaluate[i].images=e.goodsEvaluate[i].images.split(",")),1==e.goodsEvaluate[i].is_anonymous&&(e.goodsEvaluate[i].member_name=e.goodsEvaluate[i].member_name.replace(e.goodsEvaluate[i].member_name.substring(1,e.goodsEvaluate[i].member_name.length-1),"***"))})))}})},previewEvaluate:function(t,i,o){for(var r=[],a=0;a<this.goodsEvaluate[t][o].length;a++)r.push(this.$util.img(this.goodsEvaluate[t][o][a]));e.previewImage({current:i,urls:r})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.preview||(this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.skuId))},getCartCount:function(){var e=this;this.preview||this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.preview||(this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}}))},getManjian:function(){var e=this;this.$api.sendRequest({url:"/manjian/api/manjian/info",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;if(i){e.manjian=i;var o=0==i.type?"元":"件";Object.keys(i.rule_json).forEach((function(t){var r=i.rule_json[t];if(r.coupon_data)for(var a=0;a<r.coupon_data.length;a++)r.coupon_data[a].coupon_num=r.coupon_num[a];if(r.limit=0==i.type?parseFloat(r.limit).toFixed(2):parseInt(r.limit),void 0!=r.discount_money&&(void 0==e.manjian.manjian?e.manjian.manjian="满"+r.limit+o+"减"+r.discount_money+"元":e.manjian.manjian+="；满"+r.limit+o+"减"+r.discount_money+"元"),void 0!=r.point||void 0!=r.coupon){var s="";void 0!=r.point&&(s="送"+r.point+"积分"),void 0!=r.coupon&&void 0!=r.coupon_data&&r.coupon_data.forEach((function(e,t){"discount"==e.type?""==s?s="送"+r.coupon_num[t]+"张"+parseFloat(e.discount)+"折优惠券":s+="、送"+r.coupon_num[t]+"张"+parseFloat(e.discount)+"折优惠券":""==s?s="送"+r.coupon_num[t]+"张"+parseFloat(e.money)+"元优惠券":s+="、送"+r.coupon_num[t]+"张"+parseFloat(e.money)+"元优惠券"})),void 0==e.manjian.mansong?e.manjian.mansong="满"+r.limit+o+s:e.manjian.mansong+="；满"+r.limit+o+s}void 0!=r.free_shipping&&(void 0==e.manjian.free_shipping?e.manjian.free_shipping="满"+r.limit+o+"包邮":e.manjian.free_shipping+="；满"+r.limit+o+"包邮")}))}}})},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openManjianPopup:function(){this.$refs.manjianPopup.open()},closeManjianPopup:function(){this.$refs.manjianPopup.close()},getBundling:function(){var e=this;this.$api.sendRequest({url:"/bundling/api/bundling/lists",data:{sku_id:this.skuId},success:function(t){if(e.bundling=t.data,t.data&&t.data.length){for(var i=0;i<e.bundling[0].bundling_goods.length;i++){if(e.bundling[0].bundling_goods[i].sku_id==e.skuId){e.bundlingType=!0;break}e.bundlingType=!1}for(i=0;i<e.bundling.length;i++)for(var o=0;o<e.bundling[i].bundling_goods.length;o++)e.bundling[i].bundling_goods[o].sku_id==e.skuId&&e.bundling[i].bundling_goods.splice(o,1)}}})},openBundlingPopup:function(){this.$refs.bundlingPopup.open()},closeBundlingPopup:function(){this.$refs.bundlingPopup.close()},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));""!=t.token?t.posterHeight=parseInt(1318/o):t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={sku_id:this.skuId};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/api/goods/poster",data:{page:"/pages/goods/detail/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},imageError:function(){this.goodsSkuDetail.sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},bundlingImageError:function(e,t){this.bundling[e].bundling_goods[t].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})},fail:function(e){}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data)}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},fenxiao:function(){this.$refs.fenxiaoPopup.show()},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t="【"+this.goodsSkuDetail.sku_name+"】发现好物，一起来看看吧。"+this.$config.h5Domain+"/pages/goods/detail/detail?sku_id="+this.skuId;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},openFriendPopup:function(){console.log("分享朋友圈")},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toGoodsDetail:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},toComoDetail:function(e){this.$util.redirectTo("/promotionpages/combo/detail/detail",{bl_id:e})},toEvaluateDetail:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},getMemberInfo:function(){var e=this;this.$api.sendRequest({url:"/api/member/info",success:function(t){0==t.code&&t.data&&0==t.data.member_level_type&&e.getMemberCardInfo()}})},getMemberCardInfo:function(){var e=this;this.$api.sendRequest({url:"/supermember/api/membercard/recommendcard",data:{sku_id:this.goodsSkuDetail.sku_id},success:function(t){0==t.code&&t.data&&(e.membercard=t.data)}})},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++){var a=i[r].children;if(Array.isArray(a))for(var s=0;s<a.length;s++)a[s].attrs&&"img"==a[s].name&&a[s].attrs.src&&o.push(a[s].attrs.src)}e.previewImage({current:o,urls:o})}}};t.default=d}).call(this,i("543d")["default"])},"443d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账号注销"};t.lang=o},4482:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/bargain/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("bargainOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/bargain/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="";var i=this.orderPaymentData;if(this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]),void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var d=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;d.length&&(this.orderCreateData.invoice_content=d[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var c=this.orderPaymentData.shop_goods_list.local_config.info.time_week,l=!1,u=0;u<c.length;u++)if(u+1<c.length){var h=c[u+1]-c[u];if(h>1){l=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(l){var p=[];for(u=0;u<c.length;u++)p.push(f[c[u]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[c[0]]+"至"+f[c[c.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/bargain/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/bargain/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1;else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this,i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/bargain/api/ordercreate/verifyareaorstock",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),this.judge=!0,e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},4636:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"直播"};t.lang=o},4647:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"笔记详情"};t.lang=o},"4d54":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"帮助中心",emptyText:"当前暂无帮助信息"};t.lang=o},"4d85":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"退款",checkDetail:"查看详情",emptyTips:"暂无退款记录"};t.lang=o},"4e74":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"优惠券领取"};t.lang=o},"4f6f":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},5020:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"编辑收货地址",consignee:"姓名",consigneePlaceholder:"收货人姓名",mobile:"手机",mobilePlaceholder:"收货人手机号",telephone:"电话",telephonePlaceholder:"收货人固定电话（选填）",receivingCity:"地区",address:"详细地址",addressPlaceholder:"小区、街道、写字楼",save:"保存"};t.lang=o},5201:function(e,t){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}var a={KEY_ERR:311,KEY_ERR_MSG:"key格式错误",PARAM_ERR:310,PARAM_ERR_MSG:"请求参数信息有误",SYSTEM_ERR:600,SYSTEM_ERR_MSG:"系统错误",WX_ERR_CODE:1e3,WX_OK_CODE:200},s="https://apis.map.qq.com/ws/",n=s+"place/v1/search",d=s+"place/v1/suggestion",c=s+"geocoder/v1/",l=s+"district/v1/list",u=s+"district/v1/getchildren",h=s+"distance/v1/",f=s+"direction/v1/",p={driving:"driving",transit:"transit"},m=6378136.49,_={safeAdd:function(e,t){var i=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(i>>16);return o<<16|65535&i},bitRotateLeft:function(e,t){return e<<t|e>>>32-t},md5cmn:function(e,t,i,o,r,a){return this.safeAdd(this.bitRotateLeft(this.safeAdd(this.safeAdd(t,e),this.safeAdd(o,a)),r),i)},md5ff:function(e,t,i,o,r,a,s){return this.md5cmn(t&i|~t&o,e,t,r,a,s)},md5gg:function(e,t,i,o,r,a,s){return this.md5cmn(t&o|i&~o,e,t,r,a,s)},md5hh:function(e,t,i,o,r,a,s){return this.md5cmn(t^i^o,e,t,r,a,s)},md5ii:function(e,t,i,o,r,a,s){return this.md5cmn(i^(t|~o),e,t,r,a,s)},binlMD5:function(e,t){var i,o,r,a,s;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var n=1732584193,d=-271733879,c=-1732584194,l=271733878;for(i=0;i<e.length;i+=16)o=n,r=d,a=c,s=l,n=this.md5ff(n,d,c,l,e[i],7,-680876936),l=this.md5ff(l,n,d,c,e[i+1],12,-389564586),c=this.md5ff(c,l,n,d,e[i+2],17,606105819),d=this.md5ff(d,c,l,n,e[i+3],22,-1044525330),n=this.md5ff(n,d,c,l,e[i+4],7,-176418897),l=this.md5ff(l,n,d,c,e[i+5],12,1200080426),c=this.md5ff(c,l,n,d,e[i+6],17,-1473231341),d=this.md5ff(d,c,l,n,e[i+7],22,-45705983),n=this.md5ff(n,d,c,l,e[i+8],7,1770035416),l=this.md5ff(l,n,d,c,e[i+9],12,-1958414417),c=this.md5ff(c,l,n,d,e[i+10],17,-42063),d=this.md5ff(d,c,l,n,e[i+11],22,-1990404162),n=this.md5ff(n,d,c,l,e[i+12],7,1804603682),l=this.md5ff(l,n,d,c,e[i+13],12,-40341101),c=this.md5ff(c,l,n,d,e[i+14],17,-1502002290),d=this.md5ff(d,c,l,n,e[i+15],22,1236535329),n=this.md5gg(n,d,c,l,e[i+1],5,-165796510),l=this.md5gg(l,n,d,c,e[i+6],9,-1069501632),c=this.md5gg(c,l,n,d,e[i+11],14,643717713),d=this.md5gg(d,c,l,n,e[i],20,-373897302),n=this.md5gg(n,d,c,l,e[i+5],5,-701558691),l=this.md5gg(l,n,d,c,e[i+10],9,38016083),c=this.md5gg(c,l,n,d,e[i+15],14,-660478335),d=this.md5gg(d,c,l,n,e[i+4],20,-405537848),n=this.md5gg(n,d,c,l,e[i+9],5,568446438),l=this.md5gg(l,n,d,c,e[i+14],9,-1019803690),c=this.md5gg(c,l,n,d,e[i+3],14,-187363961),d=this.md5gg(d,c,l,n,e[i+8],20,1163531501),n=this.md5gg(n,d,c,l,e[i+13],5,-1444681467),l=this.md5gg(l,n,d,c,e[i+2],9,-51403784),c=this.md5gg(c,l,n,d,e[i+7],14,1735328473),d=this.md5gg(d,c,l,n,e[i+12],20,-1926607734),n=this.md5hh(n,d,c,l,e[i+5],4,-378558),l=this.md5hh(l,n,d,c,e[i+8],11,-2022574463),c=this.md5hh(c,l,n,d,e[i+11],16,1839030562),d=this.md5hh(d,c,l,n,e[i+14],23,-35309556),n=this.md5hh(n,d,c,l,e[i+1],4,-1530992060),l=this.md5hh(l,n,d,c,e[i+4],11,1272893353),c=this.md5hh(c,l,n,d,e[i+7],16,-155497632),d=this.md5hh(d,c,l,n,e[i+10],23,-1094730640),n=this.md5hh(n,d,c,l,e[i+13],4,681279174),l=this.md5hh(l,n,d,c,e[i],11,-358537222),c=this.md5hh(c,l,n,d,e[i+3],16,-722521979),d=this.md5hh(d,c,l,n,e[i+6],23,76029189),n=this.md5hh(n,d,c,l,e[i+9],4,-640364487),l=this.md5hh(l,n,d,c,e[i+12],11,-421815835),c=this.md5hh(c,l,n,d,e[i+15],16,530742520),d=this.md5hh(d,c,l,n,e[i+2],23,-995338651),n=this.md5ii(n,d,c,l,e[i],6,-198630844),l=this.md5ii(l,n,d,c,e[i+7],10,1126891415),c=this.md5ii(c,l,n,d,e[i+14],15,-1416354905),d=this.md5ii(d,c,l,n,e[i+5],21,-57434055),n=this.md5ii(n,d,c,l,e[i+12],6,1700485571),l=this.md5ii(l,n,d,c,e[i+3],10,-1894986606),c=this.md5ii(c,l,n,d,e[i+10],15,-1051523),d=this.md5ii(d,c,l,n,e[i+1],21,-2054922799),n=this.md5ii(n,d,c,l,e[i+8],6,1873313359),l=this.md5ii(l,n,d,c,e[i+15],10,-30611744),c=this.md5ii(c,l,n,d,e[i+6],15,-1560198380),d=this.md5ii(d,c,l,n,e[i+13],21,1309151649),n=this.md5ii(n,d,c,l,e[i+4],6,-145523070),l=this.md5ii(l,n,d,c,e[i+11],10,-1120210379),c=this.md5ii(c,l,n,d,e[i+2],15,718787259),d=this.md5ii(d,c,l,n,e[i+9],21,-343485551),n=this.safeAdd(n,o),d=this.safeAdd(d,r),c=this.safeAdd(c,a),l=this.safeAdd(l,s);return[n,d,c,l]},binl2rstr:function(e){var t,i="",o=32*e.length;for(t=0;t<o;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i},rstr2binl:function(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;var o=8*e.length;for(t=0;t<o;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i},rstrMD5:function(e){return this.binl2rstr(this.binlMD5(this.rstr2binl(e),8*e.length))},rstrHMACMD5:function(e,t){var i,o,r=this.rstr2binl(e),a=[],s=[];for(a[15]=s[15]=void 0,r.length>16&&(r=this.binlMD5(r,8*e.length)),i=0;i<16;i+=1)a[i]=909522486^r[i],s[i]=1549556828^r[i];return o=this.binlMD5(a.concat(this.rstr2binl(t)),512+8*t.length),this.binl2rstr(this.binlMD5(s.concat(o),640))},rstr2hex:function(e){var t,i,o="0123456789abcdef",r="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),r+=o.charAt(t>>>4&15)+o.charAt(15&t);return r},str2rstrUTF8:function(e){return unescape(encodeURIComponent(e))},rawMD5:function(e){return this.rstrMD5(this.str2rstrUTF8(e))},hexMD5:function(e){return this.rstr2hex(this.rawMD5(e))},rawHMACMD5:function(e,t){return this.rstrHMACMD5(this.str2rstrUTF8(e),str2rstrUTF8(t))},hexHMACMD5:function(e,t){return this.rstr2hex(this.rawHMACMD5(e,t))},md5:function(e,t,i){return t?i?this.rawHMACMD5(t,e):this.hexHMACMD5(t,e):i?this.rawMD5(e):this.hexMD5(e)},getSig:function(e,t,i,o){var r=null,a=[];return Object.keys(e).sort().forEach((function(t){a.push(t+"="+e[t])})),"search"==i&&(r="/ws/place/v1/search?"+a.join("&")+t),"suggest"==i&&(r="/ws/place/v1/suggestion?"+a.join("&")+t),"reverseGeocoder"==i&&(r="/ws/geocoder/v1/?"+a.join("&")+t),"geocoder"==i&&(r="/ws/geocoder/v1/?"+a.join("&")+t),"getCityList"==i&&(r="/ws/district/v1/list?"+a.join("&")+t),"getDistrictByCityId"==i&&(r="/ws/district/v1/getchildren?"+a.join("&")+t),"calculateDistance"==i&&(r="/ws/distance/v1/?"+a.join("&")+t),"direction"==i&&(r="/ws/direction/v1/"+o+"?"+a.join("&")+t),r=this.md5(r),r},location2query:function(e){if("string"==typeof e)return e;for(var t="",i=0;i<e.length;i++){var o=e[i];t&&(t+=";"),o.location&&(t=t+o.location.lat+","+o.location.lng),o.latitude&&o.longitude&&(t=t+o.latitude+","+o.longitude)}return t},rad:function(e){return e*Math.PI/180},getEndLocation:function(e){for(var t=e.split(";"),i=[],o=0;o<t.length;o++)i.push({lat:parseFloat(t[o].split(",")[0]),lng:parseFloat(t[o].split(",")[1])});return i},getDistance:function(e,t,i,o){var r=this.rad(e),a=this.rad(i),s=r-a,n=this.rad(t)-this.rad(o),d=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(r)*Math.cos(a)*Math.pow(Math.sin(n/2),2)));return d*=m,d=Math.round(1e4*d)/1e4,parseFloat(d.toFixed(0))},getWXLocation:function(e,t,i){wx.getLocation({type:"gcj02",success:e,fail:t,complete:i})},getLocationParam:function(e){if("string"==typeof e){var t=e.split(",");e=2===t.length?{latitude:e.split(",")[0],longitude:e.split(",")[1]}:{}}return e},polyfillParam:function(e){e.success=e.success||function(){},e.fail=e.fail||function(){},e.complete=e.complete||function(){}},checkParamKeyEmpty:function(e,t){if(!e[t]){var i=this.buildErrorConfig(a.PARAM_ERR,a.PARAM_ERR_MSG+t+"参数格式有误");return e.fail(i),e.complete(i),!0}return!1},checkKeyword:function(e){return!this.checkParamKeyEmpty(e,"keyword")},checkLocation:function(e){var t=this.getLocationParam(e.location);if(!t||!t.latitude||!t.longitude){var i=this.buildErrorConfig(a.PARAM_ERR,a.PARAM_ERR_MSG+" location参数格式有误");return e.fail(i),e.complete(i),!1}return!0},buildErrorConfig:function(e,t){return{status:e,message:t}},handleData:function(e,t,i){if("search"==i){for(var o=t.data,r=[],a=0;a<o.length;a++)r.push({id:o[a].id||null,title:o[a].title||null,latitude:o[a].location&&o[a].location.lat||null,longitude:o[a].location&&o[a].location.lng||null,address:o[a].address||null,category:o[a].category||null,tel:o[a].tel||null,adcode:o[a].ad_info&&o[a].ad_info.adcode||null,city:o[a].ad_info&&o[a].ad_info.city||null,district:o[a].ad_info&&o[a].ad_info.district||null,province:o[a].ad_info&&o[a].ad_info.province||null});e.success(t,{searchResult:o,searchSimplify:r})}else if("suggest"==i){var s=t.data,n=[];for(a=0;a<s.length;a++)n.push({adcode:s[a].adcode||null,address:s[a].address||null,category:s[a].category||null,city:s[a].city||null,district:s[a].district||null,id:s[a].id||null,latitude:s[a].location&&s[a].location.lat||null,longitude:s[a].location&&s[a].location.lng||null,province:s[a].province||null,title:s[a].title||null,type:s[a].type||null});e.success(t,{suggestResult:s,suggestSimplify:n})}else if("reverseGeocoder"==i){var d=t.result,c={address:d.address||null,latitude:d.location&&d.location.lat||null,longitude:d.location&&d.location.lng||null,adcode:d.ad_info&&d.ad_info.adcode||null,city:d.address_component&&d.address_component.city||null,district:d.address_component&&d.address_component.district||null,nation:d.address_component&&d.address_component.nation||null,province:d.address_component&&d.address_component.province||null,street:d.address_component&&d.address_component.street||null,street_number:d.address_component&&d.address_component.street_number||null,recommend:d.formatted_addresses&&d.formatted_addresses.recommend||null,rough:d.formatted_addresses&&d.formatted_addresses.rough||null};if(d.pois){var l=d.pois,u=[];for(a=0;a<l.length;a++)u.push({id:l[a].id||null,title:l[a].title||null,latitude:l[a].location&&l[a].location.lat||null,longitude:l[a].location&&l[a].location.lng||null,address:l[a].address||null,category:l[a].category||null,adcode:l[a].ad_info&&l[a].ad_info.adcode||null,city:l[a].ad_info&&l[a].ad_info.city||null,district:l[a].ad_info&&l[a].ad_info.district||null,province:l[a].ad_info&&l[a].ad_info.province||null});e.success(t,{reverseGeocoderResult:d,reverseGeocoderSimplify:c,pois:l,poisSimplify:u})}else e.success(t,{reverseGeocoderResult:d,reverseGeocoderSimplify:c})}else if("geocoder"==i){var h=t.result,f={title:h.title||null,latitude:h.location&&h.location.lat||null,longitude:h.location&&h.location.lng||null,adcode:h.ad_info&&h.ad_info.adcode||null,province:h.address_components&&h.address_components.province||null,city:h.address_components&&h.address_components.city||null,district:h.address_components&&h.address_components.district||null,street:h.address_components&&h.address_components.street||null,street_number:h.address_components&&h.address_components.street_number||null,level:h.level||null};e.success(t,{geocoderResult:h,geocoderSimplify:f})}else if("getCityList"==i){var p=t.result[0],m=t.result[1],_=t.result[2];e.success(t,{provinceResult:p,cityResult:m,districtResult:_})}else if("getDistrictByCityId"==i){var g=t.result[0];e.success(t,g)}else if("calculateDistance"==i){var y=t.result.elements,v=[];for(a=0;a<y.length;a++)v.push(y[a].distance);e.success(t,{calculateDistanceResult:y,distance:v})}else if("direction"==i){var b=t.result.routes;e.success(t,b)}else e.success(t)},buildWxRequestConfig:function(e,t,i){var o=this;return t.header={"content-type":"application/json"},t.method="GET",t.success=function(t){var r=t.data;0===r.status?o.handleData(e,r,i):e.fail(r)},t.fail=function(t){t.statusCode=a.WX_ERR_CODE,e.fail(o.buildErrorConfig(a.WX_ERR_CODE,t.errMsg))},t.complete=function(t){var i=+t.statusCode;switch(i){case a.WX_ERR_CODE:e.complete(o.buildErrorConfig(a.WX_ERR_CODE,t.errMsg));break;case a.WX_OK_CODE:var r=t.data;0===r.status?e.complete(r):e.complete(o.buildErrorConfig(r.status,r.message));break;default:e.complete(o.buildErrorConfig(a.SYSTEM_ERR,a.SYSTEM_ERR_MSG))}},t},locationProcess:function(e,t,i,o){var r=this;if(i=i||function(t){t.statusCode=a.WX_ERR_CODE,e.fail(r.buildErrorConfig(a.WX_ERR_CODE,t.errMsg))},o=o||function(t){t.statusCode==a.WX_ERR_CODE&&e.complete(r.buildErrorConfig(a.WX_ERR_CODE,t.errMsg))},e.location){if(r.checkLocation(e)){var s=_.getLocationParam(e.location);t(s)}}else r.getWXLocation(t,i,o)}},g=function(){"use strict";function e(t){if(i(this,e),!t.key)throw Error("key值不能为空");this.key=t.key}return r(e,[{key:"search",value:function(e){var t=this;if(e=e||{},_.polyfillParam(e),_.checkKeyword(e)){var i={keyword:e.keyword,orderby:e.orderby||"_distance",page_size:e.page_size||10,page_index:e.page_index||1,output:"json",key:t.key};e.address_format&&(i.address_format=e.address_format),e.filter&&(i.filter=e.filter);var o=e.distance||"1000",r=e.auto_extend||1,a=null,s=null;e.region&&(a=e.region),e.rectangle&&(s=e.rectangle);var d=function(t){a&&!s?(i.boundary="region("+a+","+r+","+t.latitude+","+t.longitude+")",e.sig&&(i.sig=_.getSig(i,e.sig,"search"))):s&&!a?(i.boundary="rectangle("+s+")",e.sig&&(i.sig=_.getSig(i,e.sig,"search"))):(i.boundary="nearby("+t.latitude+","+t.longitude+","+o+","+r+")",e.sig&&(i.sig=_.getSig(i,e.sig,"search"))),wx.request(_.buildWxRequestConfig(e,{url:n,data:i},"search"))};_.locationProcess(e,d)}}},{key:"getSuggestion",value:function(e){var t=this;if(e=e||{},_.polyfillParam(e),_.checkKeyword(e)){var i={keyword:e.keyword,region:e.region||"全国",region_fix:e.region_fix||0,policy:e.policy||0,page_size:e.page_size||10,page_index:e.page_index||1,get_subpois:e.get_subpois||0,output:"json",key:t.key};if(e.address_format&&(i.address_format=e.address_format),e.filter&&(i.filter=e.filter),e.location){var o=function(t){i.location=t.latitude+","+t.longitude,e.sig&&(i.sig=_.getSig(i,e.sig,"suggest")),wx.request(_.buildWxRequestConfig(e,{url:d,data:i},"suggest"))};_.locationProcess(e,o)}else e.sig&&(i.sig=_.getSig(i,e.sig,"suggest")),wx.request(_.buildWxRequestConfig(e,{url:d,data:i},"suggest"))}}},{key:"reverseGeocoder",value:function(e){var t=this;e=e||{},_.polyfillParam(e);var i={coord_type:e.coord_type||5,get_poi:e.get_poi||0,output:"json",key:t.key};e.poi_options&&(i.poi_options=e.poi_options);var o=function(t){i.location=t.latitude+","+t.longitude,e.sig&&(i.sig=_.getSig(i,e.sig,"reverseGeocoder")),wx.request(_.buildWxRequestConfig(e,{url:c,data:i},"reverseGeocoder"))};_.locationProcess(e,o)}},{key:"geocoder",value:function(e){var t=this;if(e=e||{},_.polyfillParam(e),!_.checkParamKeyEmpty(e,"address")){var i={address:e.address,output:"json",key:t.key};e.region&&(i.region=e.region),e.sig&&(i.sig=_.getSig(i,e.sig,"geocoder")),wx.request(_.buildWxRequestConfig(e,{url:c,data:i},"geocoder"))}}},{key:"getCityList",value:function(e){var t=this;e=e||{},_.polyfillParam(e);var i={output:"json",key:t.key};e.sig&&(i.sig=_.getSig(i,e.sig,"getCityList")),wx.request(_.buildWxRequestConfig(e,{url:l,data:i},"getCityList"))}},{key:"getDistrictByCityId",value:function(e){var t=this;if(e=e||{},_.polyfillParam(e),!_.checkParamKeyEmpty(e,"id")){var i={id:e.id||"",output:"json",key:t.key};e.sig&&(i.sig=_.getSig(i,e.sig,"getDistrictByCityId")),wx.request(_.buildWxRequestConfig(e,{url:u,data:i},"getDistrictByCityId"))}}},{key:"calculateDistance",value:function(e){var t=this;if(e=e||{},_.polyfillParam(e),!_.checkParamKeyEmpty(e,"to")){var i={mode:e.mode||"walking",to:_.location2query(e.to),output:"json",key:t.key};if(e.from&&(e.location=e.from),"straight"==i.mode){var o=function(t){for(var o=_.getEndLocation(i.to),r={message:"query ok",result:{elements:[]},status:0},a=0;a<o.length;a++)r.result.elements.push({distance:_.getDistance(t.latitude,t.longitude,o[a].lat,o[a].lng),duration:0,from:{lat:t.latitude,lng:t.longitude},to:{lat:o[a].lat,lng:o[a].lng}});var s=r.result.elements,n=[];for(a=0;a<s.length;a++)n.push(s[a].distance);return e.success(r,{calculateResult:s,distanceResult:n})};_.locationProcess(e,o)}else{o=function(t){i.from=t.latitude+","+t.longitude,e.sig&&(i.sig=_.getSig(i,e.sig,"calculateDistance")),wx.request(_.buildWxRequestConfig(e,{url:h,data:i},"calculateDistance"))};_.locationProcess(e,o)}}}},{key:"direction",value:function(e){var t=this;if(e=e||{},_.polyfillParam(e),!_.checkParamKeyEmpty(e,"to")){var i={output:"json",key:t.key};"string"==typeof e.to?i.to=e.to:i.to=e.to.latitude+","+e.to.longitude;var o=null;e.mode=e.mode||p.driving,o=f+e.mode,e.from&&(e.location=e.from),e.mode==p.driving&&(e.from_poi&&(i.from_poi=e.from_poi),e.heading&&(i.heading=e.heading),e.speed&&(i.speed=e.speed),e.accuracy&&(i.accuracy=e.accuracy),e.road_type&&(i.road_type=e.road_type),e.to_poi&&(i.to_poi=e.to_poi),e.from_track&&(i.from_track=e.from_track),e.waypoints&&(i.waypoints=e.waypoints),e.policy&&(i.policy=e.policy),e.plate_number&&(i.plate_number=e.plate_number)),e.mode==p.transit&&(e.departure_time&&(i.departure_time=e.departure_time),e.policy&&(i.policy=e.policy));var r=function(t){i.from=t.latitude+","+t.longitude,e.sig&&(i.sig=_.getSig(i,e.sig,"direction",e.mode)),wx.request(_.buildWxRequestConfig(e,{url:o,data:i},"direction"))};_.locationProcess(e,r)}}}]),e}();e.exports=g},5267:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"积分商城"};t.lang=o},"541e":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"签到有礼"};t.lang=o},"543d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createApp=At,t.createComponent=Wt,t.createPage=Gt,t.createPlugin=Xt,t.createSubpackageApp=Ht,t.default=void 0;var o=r(i("66fd"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function n(e,t){return l(e)||c(e,t)||p(e,t)||d()}function d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var i=[],o=!0,r=!1,a=void 0;try{for(var s,n=e[Symbol.iterator]();!(o=(s=n.next()).done);o=!0)if(i.push(s.value),t&&i.length===t)break}catch(d){r=!0,a=d}finally{try{o||null==n["return"]||n["return"]()}finally{if(r)throw a}}return i}}function l(e){if(Array.isArray(e))return e}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e){return _(e)||m(e)||p(e)||f()}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){if(e){if("string"===typeof e)return g(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?g(e,t):void 0}}function m(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _(e){if(Array.isArray(e))return g(e)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function y(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}function v(){var e,t=wx.getStorageSync("uni_id_token")||"",i=t.split(".");if(!t||3!==i.length)return{uid:null,role:[],permission:[],tokenExpired:0};try{e=JSON.parse(y(i[1]))}catch(o){throw new Error("获取当前用户信息出错，详细错误信息为："+o.message)}return e.tokenExpired=1e3*e.exp,delete e.exp,delete e.iat,e}function b(e){e.prototype.uniIDHasRole=function(e){var t=v(),i=t.role;return i.indexOf(e)>-1},e.prototype.uniIDHasPermission=function(e){var t=v(),i=t.permission;return this.uniIDHasRole("admin")||i.indexOf(e)>-1},e.prototype.uniIDTokenValid=function(){var e=v(),t=e.tokenExpired;return t>Date.now()}}var D=Object.prototype.toString,S=Object.prototype.hasOwnProperty;function k(e){return"function"===typeof e}function C(e){return"string"===typeof e}function P(e){return"[object Object]"===D.call(e)}function $(e,t){return S.call(e,t)}function w(){}function I(e){var t=Object.create(null);return function(i){var o=t[i];return o||(t[i]=e(i))}}var T=/-(\w)/g,x=I((function(e){return e.replace(T,(function(e,t){return t?t.toUpperCase():""}))})),O=["invoke","success","fail","complete","returnValue"],E={},j={};function R(e,t){var i=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return i?M(i):i}function M(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t}function A(e,t){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}function L(e,t){Object.keys(t).forEach((function(i){-1!==O.indexOf(i)&&k(t[i])&&(e[i]=R(e[i],t[i]))}))}function N(e,t){e&&t&&Object.keys(t).forEach((function(i){-1!==O.indexOf(i)&&k(t[i])&&A(e[i],t[i])}))}function U(e,t){"string"===typeof e&&P(t)?L(j[e]||(j[e]={}),t):P(e)&&L(E,e)}function F(e,t){"string"===typeof e?P(t)?N(j[e],t):delete j[e]:P(e)&&N(E,e)}function q(e){return function(t){return e(t)||t}}function V(e){return!!e&&("object"===typeof e||"function"===typeof e)&&"function"===typeof e.then}function B(e,t){for(var i=!1,o=0;o<e.length;o++){var r=e[o];if(i)i=Promise.resolve(q(r));else{var a=r(t);if(V(a)&&(i=Promise.resolve(a)),!1===a)return{then:function(){}}}}return i||{then:function(e){return e(t)}}}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["success","fail","complete"].forEach((function(i){if(Array.isArray(e[i])){var o=t[i];t[i]=function(t){B(e[i],t).then((function(e){return k(o)&&o(e)||e}))}}})),t}function J(e,t){var i=[];Array.isArray(E.returnValue)&&i.push.apply(i,h(E.returnValue));var o=j[e];return o&&Array.isArray(o.returnValue)&&i.push.apply(i,h(o.returnValue)),i.forEach((function(e){t=e(t)||t})),t}function Y(e){var t=Object.create(null);Object.keys(E).forEach((function(e){"returnValue"!==e&&(t[e]=E[e].slice())}));var i=j[e];return i&&Object.keys(i).forEach((function(e){"returnValue"!==e&&(t[e]=(t[e]||[]).concat(i[e]))})),t}function G(e,t,i){for(var o=arguments.length,r=new Array(o>3?o-3:0),a=3;a<o;a++)r[a-3]=arguments[a];var s=Y(e);if(s&&Object.keys(s).length){if(Array.isArray(s.invoke)){var n=B(s.invoke,i);return n.then((function(e){return t.apply(void 0,[z(s,e)].concat(r))}))}return t.apply(void 0,[z(s,i)].concat(r))}return t.apply(void 0,[i].concat(r))}var W={returnValue:function(e){return V(e)?new Promise((function(t,i){e.then((function(e){e[0]?i(e[0]):t(e[1])}))})):e}},H=/^\$|Window$|WindowStyle$|sendNativeEvent|restoreGlobal|getCurrentSubNVue|getMenuButtonBoundingClientRect|^report|interceptors|Interceptor$|getSubNVueById|requireNativePlugin|upx2px|hideKeyboard|canIUse|^create|Sync$|Manager$|base64ToArrayBuffer|arrayBufferToBase64/,X=/^create|Manager$/,Z=["createBLEConnection"],K=["createBLEConnection"],Q=/^on|^off/;function ee(e){return X.test(e)&&-1===Z.indexOf(e)}function te(e){return H.test(e)&&-1===K.indexOf(e)}function ie(e){return Q.test(e)&&"onPush"!==e}function oe(e){return e.then((function(e){return[null,e]})).catch((function(e){return[e]}))}function re(e){return!(ee(e)||te(e)||ie(e))}function ae(e,t){return re(e)?function(){for(var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length,r=new Array(o>1?o-1:0),a=1;a<o;a++)r[a-1]=arguments[a];return k(i.success)||k(i.fail)||k(i.complete)?J(e,G.apply(void 0,[e,t,i].concat(r))):J(e,oe(new Promise((function(o,a){G.apply(void 0,[e,t,Object.assign({},i,{success:o,fail:a})].concat(r))}))))}:t}Promise.prototype.finally||(Promise.prototype.finally=function(e){var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))});var se=1e-4,ne=750,de=!1,ce=0,le=0;function ue(){var e=wx.getSystemInfoSync(),t=e.platform,i=e.pixelRatio,o=e.windowWidth;ce=o,le=i,de="ios"===t}function he(e,t){if(0===ce&&ue(),e=Number(e),0===e)return 0;var i=e/ne*(t||ce);return i<0&&(i=-i),i=Math.floor(i+se),0===i&&(i=1!==le&&de?.5:1),e<0?-i:i}var fe={promiseInterceptor:W},pe=Object.freeze({__proto__:null,upx2px:he,addInterceptor:U,removeInterceptor:F,interceptors:fe});function me(e){var t=getCurrentPages(),i=t.length;while(i--){var o=t[i];if(o.$page&&o.$page.fullPath===e)return i}return-1}var _e,ge={name:function(e){return"back"===e.exists&&e.delta?"navigateBack":"redirectTo"},args:function(e){if("back"===e.exists&&e.url){var t=me(e.url);if(-1!==t){var i=getCurrentPages().length-1-t;i>0&&(e.delta=i)}}}},ye={args:function(e){var t=parseInt(e.current);if(!isNaN(t)){var i=e.urls;if(Array.isArray(i)){var o=i.length;if(o)return t<0?t=0:t>=o&&(t=o-1),t>0?(e.current=i[t],e.urls=i.filter((function(e,o){return!(o<t)||e!==i[t]}))):e.current=i[0],{indicator:!1,loop:!1}}}}},ve="__DC_STAT_UUID";function be(e){_e=_e||wx.getStorageSync(ve),_e||(_e=Date.now()+""+Math.floor(1e7*Math.random()),wx.setStorage({key:ve,data:_e})),e.deviceId=_e}function De(e){if(e.safeArea){var t=e.safeArea;e.safeAreaInsets={top:t.top,left:t.left,right:e.windowWidth-t.right,bottom:e.windowHeight-t.bottom}}}var Se={returnValue:function(e){be(e),De(e)}},ke={redirectTo:ge,previewImage:ye,getSystemInfo:Se,getSystemInfoSync:Se},Ce=["vibrate","preloadPage","unPreloadPage","loadSubPackage"],Pe=[],$e=["success","fail","cancel","complete"];function we(e,t,i){return function(o){return t(Te(e,o,i))}}function Ie(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(P(t)){var a=!0===r?t:{};for(var s in k(i)&&(i=i(t,a)||{}),t)if($(i,s)){var n=i[s];k(n)&&(n=n(t[s],t,a)),n?C(n)?a[n]=t[s]:P(n)&&(a[n.name?n.name:s]=n.value):console.warn("The '".concat(e,"' method of platform '微信小程序' does not support option '").concat(s,"'"))}else-1!==$e.indexOf(s)?k(t[s])&&(a[s]=we(e,t[s],o)):r||(a[s]=t[s]);return a}return k(t)&&(t=we(e,t,o)),t}function Te(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return k(ke.returnValue)&&(t=ke.returnValue(e,t)),Ie(e,t,i,{},o)}function xe(e,t){if($(ke,e)){var i=ke[e];return i?function(t,o){var r=i;k(i)&&(r=i(t)),t=Ie(e,t,r.args,r.returnValue);var a=[t];"undefined"!==typeof o&&a.push(o),k(r.name)?e=r.name(t):C(r.name)&&(e=r.name);var s=wx[e].apply(wx,a);return te(e)?Te(e,s,r.returnValue,ee(e)):s}:function(){console.error("Platform '微信小程序' does not support '".concat(e,"'."))}}return t}var Oe=Object.create(null),Ee=["onTabBarMidButtonTap","subscribePush","unsubscribePush","onPush","offPush","share"];function je(e){return function(t){var i=t.fail,o=t.complete,r={errMsg:"".concat(e,":fail method '").concat(e,"' not supported")};k(i)&&i(r),k(o)&&o(r)}}Ee.forEach((function(e){Oe[e]=je(e)}));var Re={oauth:["weixin"],share:["weixin"],payment:["wxpay"],push:["weixin"]};function Me(e){var t=e.service,i=e.success,o=e.fail,r=e.complete,a=!1;Re[t]?(a={errMsg:"getProvider:ok",service:t,provider:Re[t]},k(i)&&i(a)):(a={errMsg:"getProvider:fail service not found"},k(o)&&o(a)),k(r)&&r(a)}var Ae=Object.freeze({__proto__:null,getProvider:Me}),Le=function(){var e;return function(){return e||(e=new o.default),e}}();function Ne(e,t,i){return e[t].apply(e,i)}function Ue(){return Ne(Le(),"$on",Array.prototype.slice.call(arguments))}function Fe(){return Ne(Le(),"$off",Array.prototype.slice.call(arguments))}function qe(){return Ne(Le(),"$once",Array.prototype.slice.call(arguments))}function Ve(){return Ne(Le(),"$emit",Array.prototype.slice.call(arguments))}var Be=Object.freeze({__proto__:null,$on:Ue,$off:Fe,$once:qe,$emit:Ve}),ze=Object.freeze({__proto__:null}),Je=Page,Ye=Component,Ge=/:/g,We=I((function(e){return x(e.replace(Ge,"-"))}));function He(e){if(wx.canIUse&&wx.canIUse("nextTick")){var t=e.triggerEvent;e.triggerEvent=function(i){for(var o=arguments.length,r=new Array(o>1?o-1:0),a=1;a<o;a++)r[a-1]=arguments[a];return t.apply(e,[We(i)].concat(r))}}}function Xe(e,t){var i=t[e];t[e]=i?function(){He(this);for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return i.apply(this,t)}:function(){He(this)}}Je.__$wrappered||(Je.__$wrappered=!0,Page=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xe("onLoad",e),Je(e)},Page.after=Je.after,Component=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xe("created",e),Ye(e)});var Ze=["onPullDownRefresh","onReachBottom","onAddToFavorites","onShareTimeline","onShareAppMessage","onPageScroll","onResize","onTabItemTap"];function Ke(e,t){var i=e.$mp[e.mpType];t.forEach((function(t){$(i,t)&&(e[t]=i[t])}))}function Qe(e,t){if(!t)return!0;if(o.default.options&&Array.isArray(o.default.options[e]))return!0;if(t=t.default||t,k(t))return!!k(t.extendOptions[e])||!!(t.super&&t.super.options&&Array.isArray(t.super.options[e]));if(k(t[e]))return!0;var i=t.mixins;return Array.isArray(i)?!!i.find((function(t){return Qe(e,t)})):void 0}function et(e,t,i){t.forEach((function(t){Qe(t,i)&&(e[t]=function(e){return this.$vm&&this.$vm.__call_hook(t,e)})}))}function tt(e,t){var i;return t=t.default||t,i=k(t)?t:e.extend(t),t=i.options,[i,t]}function it(e,t){if(Array.isArray(t)&&t.length){var i=Object.create(null);t.forEach((function(e){i[e]=!0})),e.$scopedSlots=e.$slots=i}}function ot(e,t){e=(e||"").split(",");var i=e.length;1===i?t._$vueId=e[0]:2===i&&(t._$vueId=e[0],t._$vuePid=e[1])}function rt(e,t){var i=e.data||{},o=e.methods||{};if("function"===typeof i)try{i=i.call(t)}catch(r){Object({NODE_ENV:"production",VUE_APP_NAME:" ",VUE_APP_PLATFORM:"mp-weixin",BASE_URL:"/"}).VUE_APP_DEBUG&&console.warn("根据 Vue 的 data 函数初始化小程序 data 失败，请尽量确保 data 函数中不访问 vm 对象，否则可能影响首次数据渲染速度。",i)}else try{i=JSON.parse(JSON.stringify(i))}catch(r){}return P(i)||(i={}),Object.keys(o).forEach((function(e){-1!==t.__lifecycle_hooks__.indexOf(e)||$(i,e)||(i[e]=o[e])})),i}var at=[String,Number,Boolean,Object,Array,null];function st(e){return function(t,i){this.$vm&&(this.$vm[e]=t)}}function nt(e,t){var i=e.behaviors,o=e.extends,r=e.mixins,a=e.props;a||(e.props=a=[]);var s=[];return Array.isArray(i)&&i.forEach((function(e){s.push(e.replace("uni://","wx".concat("://"))),"uni://form-field"===e&&(Array.isArray(a)?(a.push("name"),a.push("value")):(a.name={type:String,default:""},a.value={type:[String,Number,Boolean,Array,Object,Date],default:""}))})),P(o)&&o.props&&s.push(t({properties:ct(o.props,!0)})),Array.isArray(r)&&r.forEach((function(e){P(e)&&e.props&&s.push(t({properties:ct(e.props,!0)}))})),s}function dt(e,t,i,o){return Array.isArray(t)&&1===t.length?t[0]:t}function ct(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={};return t||(i.vueId={type:String,value:""},i.generic={type:Object,value:null},i.scopedSlotsCompiler={type:String,value:""},i.vueSlots={type:null,value:[],observer:function(e,t){var i=Object.create(null);e.forEach((function(e){i[e]=!0})),this.setData({$slots:i})}}),Array.isArray(e)?e.forEach((function(e){i[e]={type:null,observer:st(e)}})):P(e)&&Object.keys(e).forEach((function(t){var o=e[t];if(P(o)){var r=o.default;k(r)&&(r=r()),o.type=dt(t,o.type),i[t]={type:-1!==at.indexOf(o.type)?o.type:null,value:r,observer:st(t)}}else{var a=dt(t,o);i[t]={type:-1!==at.indexOf(a)?a:null,observer:st(t)}}})),i}function lt(e){try{e.mp=JSON.parse(JSON.stringify(e))}catch(t){}return e.stopPropagation=w,e.preventDefault=w,e.target=e.target||{},$(e,"detail")||(e.detail={}),$(e,"markerId")&&(e.detail="object"===typeof e.detail?e.detail:{},e.detail.markerId=e.markerId),P(e.detail)&&(e.target=Object.assign({},e.target,e.detail)),e}function ut(e,t){var i=e;return t.forEach((function(t){var o=t[0],r=t[2];if(o||"undefined"!==typeof r){var a,s=t[1],n=t[3];Number.isInteger(o)?a=o:o?"string"===typeof o&&o&&(a=0===o.indexOf("#s#")?o.substr(3):e.__get_value(o,i)):a=i,Number.isInteger(a)?i=r:s?Array.isArray(a)?i=a.find((function(t){return e.__get_value(s,t)===r})):P(a)?i=Object.keys(a).find((function(t){return e.__get_value(s,a[t])===r})):console.error("v-for 暂不支持循环数据：",a):i=a[r],n&&(i=e.__get_value(n,i))}})),i}function ht(e,t,i){var o={};return Array.isArray(t)&&t.length&&t.forEach((function(t,r){"string"===typeof t?t?"$event"===t?o["$"+r]=i:"arguments"===t?i.detail&&i.detail.__args__?o["$"+r]=i.detail.__args__:o["$"+r]=[i]:0===t.indexOf("$event.")?o["$"+r]=e.__get_value(t.replace("$event.",""),i):o["$"+r]=e.__get_value(t):o["$"+r]=e:o["$"+r]=ut(e,t)})),o}function ft(e){for(var t={},i=1;i<e.length;i++){var o=e[i];t[o[0]]=o[1]}return t}function pt(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=!1;if(r&&(s=t.currentTarget&&t.currentTarget.dataset&&"wx"===t.currentTarget.dataset.comType,!i.length))return s?[t]:t.detail.__args__||t.detail;var n=ht(e,o,t),d=[];return i.forEach((function(e){"$event"===e?"__set_model"!==a||r?r&&!s?d.push(t.detail.__args__[0]):d.push(t):d.push(t.target.value):Array.isArray(e)&&"o"===e[0]?d.push(ft(e)):"string"===typeof e&&$(n,e)?d.push(n[e]):d.push(e)})),d}var mt="~",_t="^";function gt(e,t){return e===t||"regionchange"===t&&("begin"===e||"end"===e)}function yt(e){var t=e.$parent;while(t&&t.$parent&&(t.$options.generic||t.$parent.$options.generic||t.$scope._$vuePid))t=t.$parent;return t&&t.$parent}function vt(e){var t=this;e=lt(e);var i=(e.currentTarget||e.target).dataset;if(!i)return console.warn("事件信息不存在");var o=i.eventOpts||i["event-opts"];if(!o)return console.warn("事件信息不存在");var r=e.type,a=[];return o.forEach((function(i){var o=i[0],s=i[1],n=o.charAt(0)===_t;o=n?o.slice(1):o;var d=o.charAt(0)===mt;o=d?o.slice(1):o,s&&gt(r,o)&&s.forEach((function(i){var o=i[0];if(o){var r=t.$vm;if(r.$options.generic&&(r=yt(r)||r),"$emit"===o)return void r.$emit.apply(r,pt(t.$vm,e,i[1],i[2],n,o));var s=r[o];if(!k(s))throw new Error(" _vm.".concat(o," is not a function"));if(d){if(s.once)return;s.once=!0}var c=pt(t.$vm,e,i[1],i[2],n,o);c=Array.isArray(c)?c:[],/=\s*\S+\.eventParams\s*\|\|\s*\S+\[['"]event-params['"]\]/.test(s.toString())&&(c=c.concat([,,,,,,,,,,e])),a.push(s.apply(r,c))}}))})),"input"===r&&1===a.length&&"undefined"!==typeof a[0]?a[0]:void 0}var bt={},Dt=[];function St(e){if(e){var t=bt[e];return delete bt[e],t}return Dt.shift()}var kt=["onShow","onHide","onError","onPageNotFound","onThemeChange","onUnhandledRejection"];function Ct(){o.default.prototype.getOpenerEventChannel=function(){return this.$scope.getOpenerEventChannel()};var e=o.default.prototype.__call_hook;o.default.prototype.__call_hook=function(t,i){return"onLoad"===t&&i&&i.__id__&&(this.__eventChannel__=St(i.__id__),delete i.__id__),e.call(this,t,i)}}function Pt(){var e={},t={};o.default.prototype.$hasScopedSlotsParams=function(i){var o=e[i];return o||(t[i]=this,this.$on("hook:destory",(function(){delete t[i]}))),o},o.default.prototype.$getScopedSlotsParams=function(i,o,r){var a=e[i];if(a){var s=a[o]||{};return r?s[r]:s}t[i]=this,this.$on("hook:destory",(function(){delete t[i]}))},o.default.prototype.$setScopedSlotsParams=function(i,o){var r=this.$options.propsData.vueId;if(r){var a=r.split(",")[0],s=e[a]=e[a]||{};s[i]=o,t[a]&&t[a].$forceUpdate()}},o.default.mixin({destroyed:function(){var i=this.$options.propsData,o=i&&i.vueId;o&&(delete e[o],delete t[o])}})}function $t(e,t){var i=t.mocks,r=t.initRefs;Ct(),Pt(),e.$options.store&&(o.default.prototype.$store=e.$options.store),b(o.default),o.default.prototype.mpHost="mp-weixin",o.default.mixin({beforeCreate:function(){if(this.$options.mpType){if(this.mpType=this.$options.mpType,this.$mp=u({data:{}},this.mpType,this.$options.mpInstance),this.$scope=this.$options.mpInstance,delete this.$options.mpType,delete this.$options.mpInstance,"page"===this.mpType&&"function"===typeof getApp){var e=getApp();e.$vm&&e.$vm.$i18n&&(this._i18n=e.$vm.$i18n)}"app"!==this.mpType&&(r(this),Ke(this,i))}}});var a={onLaunch:function(t){this.$vm||(wx.canIUse&&!wx.canIUse("nextTick")&&console.error("当前微信基础库版本过低，请将 微信开发者工具-详情-项目设置-调试基础库版本 更换为`2.3.0`以上"),this.$vm=e,this.$vm.$mp={app:this},this.$vm.$scope=this,this.$vm.globalData=this.globalData,this.$vm._isMounted=!0,this.$vm.__call_hook("mounted",t),this.$vm.__call_hook("onLaunch",t))}};a.globalData=e.$options.globalData||{};var s=e.$options.methods;return s&&Object.keys(s).forEach((function(e){a[e]=s[e]})),et(a,kt),a}var wt=["__route__","__wxExparserNodeId__","__wxWebviewId__"];function It(e,t){for(var i,o=e.$children,r=o.length-1;r>=0;r--){var a=o[r];if(a.$scope._$vueId===t)return a}for(var s=o.length-1;s>=0;s--)if(i=It(o[s],t),i)return i}function Tt(e){return Behavior(e)}function xt(){return!!this.route}function Ot(e){this.triggerEvent("__l",e)}function Et(e,t,i){var o=e.selectAllComponents(t);o.forEach((function(e){var o=e.dataset.ref;i[o]=e.$vm||e,"scoped"===e.dataset.vueGeneric&&e.selectAllComponents(".scoped-ref").forEach((function(e){Et(e,t,i)}))}))}function jt(e){var t=e.$scope;Object.defineProperty(e,"$refs",{get:function(){var e={};Et(t,".vue-ref",e);var i=t.selectAllComponents(".vue-ref-in-for");return i.forEach((function(t){var i=t.dataset.ref;e[i]||(e[i]=[]),e[i].push(t.$vm||t)})),e}})}function Rt(e){var t,i=e.detail||e.value,o=i.vuePid,r=i.vueOptions;o&&(t=It(this.$vm,o)),t||(t=this.$vm),r.parent=t}function Mt(e){return $t(e,{mocks:wt,initRefs:jt})}function At(e){return App(Mt(e)),e}var Lt=/[!'()*]/g,Nt=function(e){return"%"+e.charCodeAt(0).toString(16)},Ut=/%2C/g,Ft=function(e){return encodeURIComponent(e).replace(Lt,Nt).replace(Ut,",")};function qt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ft,i=e?Object.keys(e).map((function(i){var o=e[i];if(void 0===o)return"";if(null===o)return t(i);if(Array.isArray(o)){var r=[];return o.forEach((function(e){void 0!==e&&(null===e?r.push(t(i)):r.push(t(i)+"="+t(e)))})),r.join("&")}return t(i)+"="+t(o)})).filter((function(e){return e.length>0})).join("&"):null;return i?"?".concat(i):""}function Vt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.isPage,r=t.initRelation,a=tt(o.default,e),d=n(a,2),c=d[0],l=d[1],u=s({multipleSlots:!0,addGlobalClass:!0},l.options||{});l["mp-weixin"]&&l["mp-weixin"].options&&Object.assign(u,l["mp-weixin"].options);var h={options:u,data:rt(l,o.default.prototype),behaviors:nt(l,Tt),properties:ct(l.props,!1,l.__file),lifetimes:{attached:function(){var e=this.properties,t={mpType:i.call(this)?"page":"component",mpInstance:this,propsData:e};ot(e.vueId,this),r.call(this,{vuePid:this._$vuePid,vueOptions:t}),this.$vm=new c(t),it(this.$vm,e.vueSlots),this.$vm.$mount()},ready:function(){this.$vm&&(this.$vm._isMounted=!0,this.$vm.__call_hook("mounted"),this.$vm.__call_hook("onReady"))},detached:function(){this.$vm&&this.$vm.$destroy()}},pageLifetimes:{show:function(e){this.$vm&&this.$vm.__call_hook("onPageShow",e)},hide:function(){this.$vm&&this.$vm.__call_hook("onPageHide")},resize:function(e){this.$vm&&this.$vm.__call_hook("onPageResize",e)}},methods:{__l:Rt,__e:vt}};return l.externalClasses&&(h.externalClasses=l.externalClasses),Array.isArray(l.wxsCallMethods)&&l.wxsCallMethods.forEach((function(e){h.methods[e]=function(t){return this.$vm[e](t)}})),i?h:[h,c]}function Bt(e){return Vt(e,{isPage:xt,initRelation:Ot})}var zt=["onShow","onHide","onUnload"];function Jt(e,t){t.isPage,t.initRelation;var i=Bt(e);return et(i.methods,zt,e),i.methods.onLoad=function(e){this.options=e;var t=Object.assign({},e);delete t.__id__,this.$page={fullPath:"/"+(this.route||this.is)+qt(t)},this.$vm.$mp.query=e,this.$vm.__call_hook("onLoad",e)},i}function Yt(e){return Jt(e,{isPage:xt,initRelation:Ot})}function Gt(e){return Component(Yt(e))}function Wt(e){return Component(Bt(e))}function Ht(e){var t=Mt(e),i=getApp({allowDefault:!0});e.$scope=i;var o=i.globalData;if(o&&Object.keys(t.globalData).forEach((function(e){$(o,e)||(o[e]=t.globalData[e])})),Object.keys(t).forEach((function(e){$(i,e)||(i[e]=t[e])})),k(t.onShow)&&wx.onAppShow&&wx.onAppShow((function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];e.__call_hook("onShow",i)})),k(t.onHide)&&wx.onAppHide&&wx.onAppHide((function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];e.__call_hook("onHide",i)})),k(t.onLaunch)){var r=wx.getLaunchOptionsSync&&wx.getLaunchOptionsSync();e.__call_hook("onLaunch",r)}return e}function Xt(e){var t=Mt(e);if(k(t.onShow)&&wx.onAppShow&&wx.onAppShow((function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];t.onShow.apply(e,o)})),k(t.onHide)&&wx.onAppHide&&wx.onAppHide((function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];t.onHide.apply(e,o)})),k(t.onLaunch)){var i=wx.getLaunchOptionsSync&&wx.getLaunchOptionsSync();t.onLaunch.call(e,i)}return e}zt.push.apply(zt,Ze),Ce.forEach((function(e){ke[e]=!1})),Pe.forEach((function(e){var t=ke[e]&&ke[e].name?ke[e].name:e;wx.canIUse(t)||(ke[e]=!1)}));var Zt={};"undefined"!==typeof Proxy?Zt=new Proxy({},{get:function(e,t){return $(e,t)?e[t]:pe[t]?pe[t]:ze[t]?ae(t,ze[t]):Ae[t]?ae(t,Ae[t]):Oe[t]?ae(t,Oe[t]):Be[t]?Be[t]:$(wx,t)||$(ke,t)?ae(t,xe(t,wx[t])):void 0},set:function(e,t,i){return e[t]=i,!0}}):(Object.keys(pe).forEach((function(e){Zt[e]=pe[e]})),Object.keys(Oe).forEach((function(e){Zt[e]=ae(e,Oe[e])})),Object.keys(Ae).forEach((function(e){Zt[e]=ae(e,Oe[e])})),Object.keys(Be).forEach((function(e){Zt[e]=Be[e]})),Object.keys(ze).forEach((function(e){Zt[e]=ae(e,ze[e])})),Object.keys(wx).forEach((function(e){($(wx,e)||$(ke,e))&&(Zt[e]=ae(e,xe(e,wx[e])))}))),wx.createApp=At,wx.createPage=Gt,wx.createComponent=Wt,wx.createSubpackageApp=Ht,wx.createPlugin=Xt;var Kt=Zt,Qt=Kt;t.default=Qt},"559f":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的余额",accountBalance:"账户余额 ",money:" (元)",recharge:"充值",withdrawal:"提现",balanceDetailed:"余额明细",emptyTips:"暂无余额记录",rechargeRecord:"充值记录",ableAccountBalance:"可提现余额 ",noAccountBalance:"不可提现余额 "};t.lang=o},"57a6":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"组合套餐"};t.lang=o},"58bb":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"充值列表"};t.lang=o},"5b39":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:"",invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[],invoice_type:[]}},pintuan_info:{},pintuan_group_info:{},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:""}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/rebate/rebate/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("pinfanOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/pinfan/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:e.message}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);for(var i=0;i<this.orderPaymentData.shop_goods_list.goods_list.length;i++)this.orderPaymentData.shop_goods_list.goods_list[i].goods_image=this.orderPaymentData.shop_goods_list.goods_list[i].goods_image?this.orderPaymentData.shop_goods_list.goods_list[i].goods_image.split(",")[0]:"";var o=this.orderPaymentData;if(void 0!=o.shop_goods_list.express_type&&void 0!=o.shop_goods_list.express_type[0]){var r=o.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var a=e.getStorageSync("delivery");if(a){var s=a.name,n=a.title;"store"==s&&(o.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""})}else{s=r[0].name;"store"==s&&(this.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""});n=r[0].title}this.orderCreateData.delivery.delivery_type=s,this.orderCreateData.delivery.delivery_type_name=n,"store"==r[0].name&&this.storeSelected(r[0])}if(void 0!=o.shop_goods_list.coupon_list&&void 0!=o.shop_goods_list.coupon_list[0]){var d=o.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=d[0].coupon_id,this.orderCreateData.coupon.coupon_money=d[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var c=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;c.length&&(this.orderCreateData.invoice_content=c[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;var l=this.orderPaymentData.shop_goods_list.local_config.info.time_week,u=!1;for(i=0;i<l.length;i++)if(i+1<l.length){var h=l[i+1]-l[i];if(h>1){u=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(u){var p=[];for(i=0;i<l.length;i++)p.push(f[l[i]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[l[0]]+"至"+f[l[l.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/pinfan/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/pinfan/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else{var o=e.getStorageSync("pinfanOrderCreateData");o.out_trade_no=t.data,e.setStorageSync("pinfanOrderCreateData",o),i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1}else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].goods_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this,i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/pinfan/api/ordercreate/verifyareaorstock",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login");var t=e.getStorageSync("pinfanOrderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},"5e4a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={emjoyList:{"[emjoy_01]":"public/static/img/emjoy/emjoy_01.gif","[emjoy_02]":"public/static/img/emjoy/emjoy_02.gif","[emjoy_03]":"public/static/img/emjoy/emjoy_03.gif","[emjoy_04]":"public/static/img/emjoy/emjoy_04.gif","[emjoy_05]":"public/static/img/emjoy/emjoy_05.gif","[emjoy_06]":"public/static/img/emjoy/emjoy_06.gif","[emjoy_07]":"public/static/img/emjoy/emjoy_07.gif","[emjoy_08]":"public/static/img/emjoy/emjoy_08.gif","[emjoy_09]":"public/static/img/emjoy/emjoy_09.gif","[emjoy_10]":"public/static/img/emjoy/emjoy_10.gif","[emjoy_11]":"public/static/img/emjoy/emjoy_11.gif","[emjoy_12]":"public/static/img/emjoy/emjoy_12.gif","[emjoy_13]":"public/static/img/emjoy/emjoy_13.gif","[emjoy_14]":"public/static/img/emjoy/emjoy_14.gif","[emjoy_15]":"public/static/img/emjoy/emjoy_15.gif","[emjoy_16]":"public/static/img/emjoy/emjoy_16.gif","[emjoy_17]":"public/static/img/emjoy/emjoy_17.gif","[emjoy_18]":"public/static/img/emjoy/emjoy_18.gif","[emjoy_19]":"public/static/img/emjoy/emjoy_19.gif","[emjoy_20]":"public/static/img/emjoy/emjoy_20.gif","[emjoy_21]":"public/static/img/emjoy/emjoy_21.gif","[emjoy_22]":"public/static/img/emjoy/emjoy_22.gif","[emjoy_23]":"public/static/img/emjoy/emjoy_23.gif","[emjoy_24]":"public/static/img/emjoy/emjoy_24.gif","[emjoy_25]":"public/static/img/emjoy/emjoy_25.gif","[emjoy_26]":"public/static/img/emjoy/emjoy_26.gif","[emjoy_27]":"public/static/img/emjoy/emjoy_27.gif","[emjoy_28]":"public/static/img/emjoy/emjoy_28.gif","[emjoy_29]":"public/static/img/emjoy/emjoy_29.gif","[emjoy_30]":"public/static/img/emjoy/emjoy_30.gif","[emjoy_31]":"public/static/img/emjoy/emjoy_31.gif","[emjoy_32]":"public/static/img/emjoy/emjoy_32.gif","[emjoy_33]":"public/static/img/emjoy/emjoy_33.gif","[emjoy_34]":"public/static/img/emjoy/emjoy_34.gif","[emjoy_35]":"public/static/img/emjoy/emjoy_35.gif","[emjoy_36]":"public/static/img/emjoy/emjoy_36.gif","[emjoy_37]":"public/static/img/emjoy/emjoy_37.gif","[emjoy_38]":"public/static/img/emjoy/emjoy_38.gif","[emjoy_39]":"public/static/img/emjoy/emjoy_39.gif","[emjoy_40]":"public/static/img/emjoy/emjoy_40.gif","[emjoy_41]":"public/static/img/emjoy/emjoy_41.gif","[emjoy_42]":"public/static/img/emjoy/emjoy_42.gif","[emjoy_43]":"public/static/img/emjoy/emjoy_43.gif","[emjoy_44]":"public/static/img/emjoy/emjoy_44.gif","[emjoy_45]":"public/static/img/emjoy/emjoy_45.gif","[emjoy_46]":"public/static/img/emjoy/emjoy_46.gif","[emjoy_47]":"public/static/img/emjoy/emjoy_47.gif"}};t.default=o},"5fea":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={methods:{cancleRefund:function(t,i){var o=this;e.showModal({content:"撤销之后本次申请将会关闭,如后续仍有问题可再次发起申请。",cancelText:"暂不撤销",cancelColor:"#898989",success:function(e){e.confirm&&o.$api.sendRequest({url:"/api/orderrefund/cancel",data:{order_goods_id:t},success:function(e){"function"==typeof i&&i(e)}})}})}}};t.default=i}).call(this,i("543d")["default"])},6060:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{mescroll:null}},onPullDownRefresh:function(){this.mescroll&&this.mescroll.onPullDownRefresh()},onPageScroll:function(e){this.mescroll&&this.mescroll.onPageScroll(e)},onReachBottom:function(){this.mescroll&&this.mescroll.onReachBottom()},methods:{mescrollInit:function(e){this.mescroll=e,this.mescrollInitByRef()},mescrollInitByRef:function(){if(!this.mescroll||!this.mescroll.resetUpScroll){var e=this.$refs.mescrollRef;e&&(this.mescroll=e.mescroll)}},downCallback:function(){this.mescroll.resetUpScroll()},upCallback:function(){var e=this;setTimeout((function(){e.mescroll.endErr()}),500)}},mounted:function(){this.mescrollInitByRef()}},r=o;t.default=r},"62f3":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{topics_id:0,skuId:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:{},goodsCircle:!1,evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},isCommunity:!1}},onLoad:function(t){var i=this;if(this.topics_id=t.id||0,this.isIphoneX=this.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene){var o=decodeURIComponent(t.scene);o=o.split("&"),o.length&&o.forEach((function(t){-1!=t.indexOf("id")&&(i.topics_id=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))}this.getService()},onShow:function(){var t=this;return n(o.default.mark((function i(){return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.$langConfig.refresh(),t.token=e.getStorageSync("token"),""!=t.token&&(t.getCartCount(),t.getMemberId()),t.getKekuConfig(),i.next=6,t.getGoodsSkuDetail();case 6:t.modifyGoodsInfo(),t.getEvaluateConfig(),e.getStorageSync("token")&&e.getStorageSync("source_member")&&t.$util.onSourceMember(e.getStorageSync("source_member"));case 9:case"end":return i.stop()}}),i)})))()},methods:{goConnect:function(){if(e.getStorageSync("token")){var t={skuId:this.goodsSkuDetail.sku_id};return 1==this.kefuConfig.system?(this.$util.redirectTo("/otherpages/chat/room/room",t),!1):void 0}this.$refs.login.open("/promotionpages/topics/goods_detail/goods_detail?id="+this.topics_id)},getGoodsSkuDetail:function(){var e=this;return n(o.default.mark((function t(){var i,a,s,n,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/topic/api/topicgoods/detail",async:!1,data:{topic_id:e.topics_id}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,e.skuId=e.goodsSkuDetail.sku_id,i.timestamp>e.goodsSkuDetail.end_time?(e.$util.showToast({title:"专题活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)):e.goodsSkuDetail.discountTimeMachine=e.$util.countDown(e.goodsSkuDetail.end_time-i.timestamp),e.goodsSkuDetail.show_price=e.goodsSkuDetail.topic_price,e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.save_price=e.goodsSkuDetail.price-e.goodsSkuDetail.show_price>0?(e.goodsSkuDetail.price-e.goodsSkuDetail.show_price).toFixed(2):0,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(s=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(s,"attr_id"),n=0;n<e.goodsSkuDetail.goods_attr_format.length;n++)for(d=0;d<s.length;d++)e.goodsSkuDetail.goods_attr_format[n].attr_id==s[d].attr_id&&e.goodsSkuDetail.goods_attr_format[n].attr_value_id!=s[d].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[n].attr_value_name+="、"+s[d].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/topics/detail/detail?id="+e.topics_id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},""!=e.token&&e.getWhetherCollection(),e.setWechatShare(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},topic:function(){var t=this;e.getStorageSync("token")?this.$refs.goodsSku.show("topic",(function(){t.getCartCount()})):this.$refs.login.open("/promotionpages/topics/goods_detail/goods_detail?id="+this.topics_id)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.images&&(e.goodsEvaluate.images=e.goodsEvaluate.images.split(",")),1==e.goodsEvaluate.is_anonymous&&(e.goodsEvaluate.member_name=e.goodsEvaluate.member_name.replace(e.goodsEvaluate.member_name.substring(1,e.goodsEvaluate.member_name.length-1),"***")))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.$refs.login.open("/promotionpages/topics/goods_detail/goods_detail?id="+this.topics_id)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));""!=t.token?t.posterHeight=parseInt(1240/o):t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={id:this.topics_id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/topic/api/topicgoods/poster",data:{page:"/promotionpages/topics/goods_detail/goods_detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/topics/goods_detail/goods_detail?id="+this.topics_id;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toEvaluateList:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++)for(var a=i[r].children,s=0;s<a.length;s++)a[s].attrs&&a[s].attrs.src&&o.push(a[s].attrs.src);e.previewImage({current:o,urls:o})}}};t.default=d}).call(this,i("543d")["default"])},"643d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"找回密码",findPassword:"找回密码",accountPlaceholder:"请输入手机号",captchaPlaceholder:"请输入验证码",dynacodePlaceholder:"请输入动态码",passwordPlaceholder:"请输入新密码",rePasswordPlaceholder:"请确认新密码",next:"下一步",save:"确认修改"};t.lang=o},6546:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},"669d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账单"};t.lang=o},"66fd":function(e,t,i){"use strict";i.r(t),function(e){
/*!
 * Vue.js v2.6.11
 * (c) 2014-2021 Evan You
 * Released under the MIT License.
 */
var i=Object.freeze({});function o(e){return void 0===e||null===e}function r(e){return void 0!==e&&null!==e}function a(e){return!0===e}function s(e){return!1===e}function n(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function d(e){return null!==e&&"object"===typeof e}var c=Object.prototype.toString;function l(e){return"[object Object]"===c.call(e)}function u(e){return"[object RegExp]"===c.call(e)}function h(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function f(e){return r(e)&&"function"===typeof e.then&&"function"===typeof e.catch}function p(e){return null==e?"":Array.isArray(e)||l(e)&&e.toString===c?JSON.stringify(e,null,2):String(e)}function m(e){var t=parseFloat(e);return isNaN(t)?e:t}function _(e,t){for(var i=Object.create(null),o=e.split(","),r=0;r<o.length;r++)i[o[r]]=!0;return t?function(e){return i[e.toLowerCase()]}:function(e){return i[e]}}_("slot,component",!0);var g=_("key,ref,slot,slot-scope,is");function y(e,t){if(e.length){var i=e.indexOf(t);if(i>-1)return e.splice(i,1)}}var v=Object.prototype.hasOwnProperty;function b(e,t){return v.call(e,t)}function D(e){var t=Object.create(null);return function(i){var o=t[i];return o||(t[i]=e(i))}}var S=/-(\w)/g,k=D((function(e){return e.replace(S,(function(e,t){return t?t.toUpperCase():""}))})),C=D((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),P=/\B([A-Z])/g,$=D((function(e){return e.replace(P,"-$1").toLowerCase()}));function w(e,t){function i(i){var o=arguments.length;return o?o>1?e.apply(t,arguments):e.call(t,i):e.call(t)}return i._length=e.length,i}function I(e,t){return e.bind(t)}var T=Function.prototype.bind?I:w;function x(e,t){t=t||0;var i=e.length-t,o=new Array(i);while(i--)o[i]=e[i+t];return o}function O(e,t){for(var i in t)e[i]=t[i];return e}function E(e){for(var t={},i=0;i<e.length;i++)e[i]&&O(t,e[i]);return t}function j(e,t,i){}var R=function(e,t,i){return!1},M=function(e){return e};function A(e,t){if(e===t)return!0;var i=d(e),o=d(t);if(!i||!o)return!i&&!o&&String(e)===String(t);try{var r=Array.isArray(e),a=Array.isArray(t);if(r&&a)return e.length===t.length&&e.every((function(e,i){return A(e,t[i])}));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(r||a)return!1;var s=Object.keys(e),n=Object.keys(t);return s.length===n.length&&s.every((function(i){return A(e[i],t[i])}))}catch(c){return!1}}function L(e,t){for(var i=0;i<e.length;i++)if(A(e[i],t))return i;return-1}function N(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var U=["component","directive","filter"],F=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],q={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:R,isReservedAttr:R,isUnknownElement:R,getTagNamespace:j,parsePlatformTagName:M,mustUseProp:R,async:!0,_lifecycleHooks:F},V=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function B(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function z(e,t,i,o){Object.defineProperty(e,t,{value:i,enumerable:!!o,writable:!0,configurable:!0})}var J=new RegExp("[^"+V.source+".$_\\d]");function Y(e){if(!J.test(e)){var t=e.split(".");return function(e){for(var i=0;i<t.length;i++){if(!e)return;e=e[t[i]]}return e}}}var G,W="__proto__"in{},H="undefined"!==typeof window,X="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,Z=X&&WXEnvironment.platform.toLowerCase(),K=H&&window.navigator.userAgent.toLowerCase(),Q=K&&/msie|trident/.test(K),ee=(K&&K.indexOf("msie 9.0"),K&&K.indexOf("edge/")>0),te=(K&&K.indexOf("android"),K&&/iphone|ipad|ipod|ios/.test(K)||"ios"===Z),ie=(K&&/chrome\/\d+/.test(K),K&&/phantomjs/.test(K),K&&K.match(/firefox\/(\d+)/),{}.watch);if(H)try{var oe={};Object.defineProperty(oe,"passive",{get:function(){}}),window.addEventListener("test-passive",null,oe)}catch(ir){}var re=function(){return void 0===G&&(G=!H&&!X&&"undefined"!==typeof e&&(e["process"]&&"server"===e["process"].env.VUE_ENV)),G},ae=H&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function se(e){return"function"===typeof e&&/native code/.test(e.toString())}var ne,de="undefined"!==typeof Symbol&&se(Symbol)&&"undefined"!==typeof Reflect&&se(Reflect.ownKeys);ne="undefined"!==typeof Set&&se(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var ce=j,le=0,ue=function(){this.id=le++,this.subs=[]};function he(e){ue.SharedObject.targetStack.push(e),ue.SharedObject.target=e,ue.target=e}function fe(){ue.SharedObject.targetStack.pop(),ue.SharedObject.target=ue.SharedObject.targetStack[ue.SharedObject.targetStack.length-1],ue.target=ue.SharedObject.target}ue.prototype.addSub=function(e){this.subs.push(e)},ue.prototype.removeSub=function(e){y(this.subs,e)},ue.prototype.depend=function(){ue.SharedObject.target&&ue.SharedObject.target.addDep(this)},ue.prototype.notify=function(){var e=this.subs.slice();for(var t=0,i=e.length;t<i;t++)e[t].update()},ue.SharedObject={},ue.SharedObject.target=null,ue.SharedObject.targetStack=[];var pe=function(e,t,i,o,r,a,s,n){this.tag=e,this.data=t,this.children=i,this.text=o,this.elm=r,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=n,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},me={child:{configurable:!0}};me.child.get=function(){return this.componentInstance},Object.defineProperties(pe.prototype,me);var _e=function(e){void 0===e&&(e="");var t=new pe;return t.text=e,t.isComment=!0,t};function ge(e){return new pe(void 0,void 0,void 0,String(e))}function ye(e){var t=new pe(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}var ve=Array.prototype,be=Object.create(ve),De=["push","pop","shift","unshift","splice","sort","reverse"];De.forEach((function(e){var t=ve[e];z(be,e,(function(){var i=[],o=arguments.length;while(o--)i[o]=arguments[o];var r,a=t.apply(this,i),s=this.__ob__;switch(e){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2);break}return r&&s.observeArray(r),s.dep.notify(),a}))}));var Se=Object.getOwnPropertyNames(be),ke=!0;function Ce(e){ke=e}var Pe=function(e){this.value=e,this.dep=new ue,this.vmCount=0,z(e,"__ob__",this),Array.isArray(e)?(W?e.push!==e.__proto__.push?we(e,be,Se):$e(e,be):we(e,be,Se),this.observeArray(e)):this.walk(e)};function $e(e,t){e.__proto__=t}function we(e,t,i){for(var o=0,r=i.length;o<r;o++){var a=i[o];z(e,a,t[a])}}function Ie(e,t){var i;if(d(e)&&!(e instanceof pe))return b(e,"__ob__")&&e.__ob__ instanceof Pe?i=e.__ob__:ke&&!re()&&(Array.isArray(e)||l(e))&&Object.isExtensible(e)&&!e._isVue&&(i=new Pe(e)),t&&i&&i.vmCount++,i}function Te(e,t,i,o,r){var a=new ue,s=Object.getOwnPropertyDescriptor(e,t);if(!s||!1!==s.configurable){var n=s&&s.get,d=s&&s.set;n&&!d||2!==arguments.length||(i=e[t]);var c=!r&&Ie(i);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=n?n.call(e):i;return ue.SharedObject.target&&(a.depend(),c&&(c.dep.depend(),Array.isArray(t)&&Ee(t))),t},set:function(t){var o=n?n.call(e):i;t===o||t!==t&&o!==o||n&&!d||(d?d.call(e,t):i=t,c=!r&&Ie(t),a.notify())}})}}function xe(e,t,i){if(Array.isArray(e)&&h(t))return e.length=Math.max(e.length,t),e.splice(t,1,i),i;if(t in e&&!(t in Object.prototype))return e[t]=i,i;var o=e.__ob__;return e._isVue||o&&o.vmCount?i:o?(Te(o.value,t,i),o.dep.notify(),i):(e[t]=i,i)}function Oe(e,t){if(Array.isArray(e)&&h(t))e.splice(t,1);else{var i=e.__ob__;e._isVue||i&&i.vmCount||b(e,t)&&(delete e[t],i&&i.dep.notify())}}function Ee(e){for(var t=void 0,i=0,o=e.length;i<o;i++)t=e[i],t&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&Ee(t)}Pe.prototype.walk=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)Te(e,t[i])},Pe.prototype.observeArray=function(e){for(var t=0,i=e.length;t<i;t++)Ie(e[t])};var je=q.optionMergeStrategies;function Re(e,t){if(!t)return e;for(var i,o,r,a=de?Reflect.ownKeys(t):Object.keys(t),s=0;s<a.length;s++)i=a[s],"__ob__"!==i&&(o=e[i],r=t[i],b(e,i)?o!==r&&l(o)&&l(r)&&Re(o,r):xe(e,i,r));return e}function Me(e,t,i){return i?function(){var o="function"===typeof t?t.call(i,i):t,r="function"===typeof e?e.call(i,i):e;return o?Re(o,r):r}:t?e?function(){return Re("function"===typeof t?t.call(this,this):t,"function"===typeof e?e.call(this,this):e)}:t:e}function Ae(e,t){var i=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return i?Le(i):i}function Le(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t}function Ne(e,t,i,o){var r=Object.create(e||null);return t?O(r,t):r}je.data=function(e,t,i){return i?Me(e,t,i):t&&"function"!==typeof t?e:Me(e,t)},F.forEach((function(e){je[e]=Ae})),U.forEach((function(e){je[e+"s"]=Ne})),je.watch=function(e,t,i,o){if(e===ie&&(e=void 0),t===ie&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var r={};for(var a in O(r,e),t){var s=r[a],n=t[a];s&&!Array.isArray(s)&&(s=[s]),r[a]=s?s.concat(n):Array.isArray(n)?n:[n]}return r},je.props=je.methods=je.inject=je.computed=function(e,t,i,o){if(!e)return t;var r=Object.create(null);return O(r,e),t&&O(r,t),r},je.provide=Me;var Ue=function(e,t){return void 0===t?e:t};function Fe(e,t){var i=e.props;if(i){var o,r,a,s={};if(Array.isArray(i)){o=i.length;while(o--)r=i[o],"string"===typeof r&&(a=k(r),s[a]={type:null})}else if(l(i))for(var n in i)r=i[n],a=k(n),s[a]=l(r)?r:{type:r};else 0;e.props=s}}function qe(e,t){var i=e.inject;if(i){var o=e.inject={};if(Array.isArray(i))for(var r=0;r<i.length;r++)o[i[r]]={from:i[r]};else if(l(i))for(var a in i){var s=i[a];o[a]=l(s)?O({from:a},s):{from:s}}else 0}}function Ve(e){var t=e.directives;if(t)for(var i in t){var o=t[i];"function"===typeof o&&(t[i]={bind:o,update:o})}}function Be(e,t,i){if("function"===typeof t&&(t=t.options),Fe(t,i),qe(t,i),Ve(t),!t._base&&(t.extends&&(e=Be(e,t.extends,i)),t.mixins))for(var o=0,r=t.mixins.length;o<r;o++)e=Be(e,t.mixins[o],i);var a,s={};for(a in e)n(a);for(a in t)b(e,a)||n(a);function n(o){var r=je[o]||Ue;s[o]=r(e[o],t[o],i,o)}return s}function ze(e,t,i,o){if("string"===typeof i){var r=e[t];if(b(r,i))return r[i];var a=k(i);if(b(r,a))return r[a];var s=C(a);if(b(r,s))return r[s];var n=r[i]||r[a]||r[s];return n}}function Je(e,t,i,o){var r=t[e],a=!b(i,e),s=i[e],n=He(Boolean,r.type);if(n>-1)if(a&&!b(r,"default"))s=!1;else if(""===s||s===$(e)){var d=He(String,r.type);(d<0||n<d)&&(s=!0)}if(void 0===s){s=Ye(o,r,e);var c=ke;Ce(!0),Ie(s),Ce(c)}return s}function Ye(e,t,i){if(b(t,"default")){var o=t.default;return e&&e.$options.propsData&&void 0===e.$options.propsData[i]&&void 0!==e._props[i]?e._props[i]:"function"===typeof o&&"Function"!==Ge(t.type)?o.call(e):o}}function Ge(e){var t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function We(e,t){return Ge(e)===Ge(t)}function He(e,t){if(!Array.isArray(t))return We(t,e)?0:-1;for(var i=0,o=t.length;i<o;i++)if(We(t[i],e))return i;return-1}function Xe(e,t,i){he();try{if(t){var o=t;while(o=o.$parent){var r=o.$options.errorCaptured;if(r)for(var a=0;a<r.length;a++)try{var s=!1===r[a].call(o,e,t,i);if(s)return}catch(ir){Ke(ir,o,"errorCaptured hook")}}}Ke(e,t,i)}finally{fe()}}function Ze(e,t,i,o,r){var a;try{a=i?e.apply(t,i):e.call(t),a&&!a._isVue&&f(a)&&!a._handled&&(a.catch((function(e){return Xe(e,o,r+" (Promise/async)")})),a._handled=!0)}catch(ir){Xe(ir,o,r)}return a}function Ke(e,t,i){if(q.errorHandler)try{return q.errorHandler.call(null,e,t,i)}catch(ir){ir!==e&&Qe(ir,null,"config.errorHandler")}Qe(e,t,i)}function Qe(e,t,i){if(!H&&!X||"undefined"===typeof console)throw e;console.error(e)}var et,tt=[],it=!1;function ot(){it=!1;var e=tt.slice(0);tt.length=0;for(var t=0;t<e.length;t++)e[t]()}if("undefined"!==typeof Promise&&se(Promise)){var rt=Promise.resolve();et=function(){rt.then(ot),te&&setTimeout(j)}}else if(Q||"undefined"===typeof MutationObserver||!se(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())et="undefined"!==typeof setImmediate&&se(setImmediate)?function(){setImmediate(ot)}:function(){setTimeout(ot,0)};else{var at=1,st=new MutationObserver(ot),nt=document.createTextNode(String(at));st.observe(nt,{characterData:!0}),et=function(){at=(at+1)%2,nt.data=String(at)}}function dt(e,t){var i;if(tt.push((function(){if(e)try{e.call(t)}catch(ir){Xe(ir,t,"nextTick")}else i&&i(t)})),it||(it=!0,et()),!e&&"undefined"!==typeof Promise)return new Promise((function(e){i=e}))}var ct=new ne;function lt(e){ut(e,ct),ct.clear()}function ut(e,t){var i,o,r=Array.isArray(e);if(!(!r&&!d(e)||Object.isFrozen(e)||e instanceof pe)){if(e.__ob__){var a=e.__ob__.dep.id;if(t.has(a))return;t.add(a)}if(r){i=e.length;while(i--)ut(e[i],t)}else{o=Object.keys(e),i=o.length;while(i--)ut(e[o[i]],t)}}}var ht=D((function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var i="~"===e.charAt(0);e=i?e.slice(1):e;var o="!"===e.charAt(0);return e=o?e.slice(1):e,{name:e,once:i,capture:o,passive:t}}));function ft(e,t){function i(){var e=arguments,o=i.fns;if(!Array.isArray(o))return Ze(o,null,arguments,t,"v-on handler");for(var r=o.slice(),a=0;a<r.length;a++)Ze(r[a],null,e,t,"v-on handler")}return i.fns=e,i}function pt(e,t,i,r,s,n){var d,c,l,u;for(d in e)c=e[d],l=t[d],u=ht(d),o(c)||(o(l)?(o(c.fns)&&(c=e[d]=ft(c,n)),a(u.once)&&(c=e[d]=s(u.name,c,u.capture)),i(u.name,c,u.capture,u.passive,u.params)):c!==l&&(l.fns=c,e[d]=l));for(d in t)o(e[d])&&(u=ht(d),r(u.name,t[d],u.capture))}function mt(e,t,i,a){var s=t.options.mpOptions&&t.options.mpOptions.properties;if(o(s))return i;var n=t.options.mpOptions.externalClasses||[],d=e.attrs,c=e.props;if(r(d)||r(c))for(var l in s){var u=$(l),h=gt(i,c,l,u,!0)||gt(i,d,l,u,!1);h&&i[l]&&-1!==n.indexOf(u)&&a[k(i[l])]&&(i[l]=a[k(i[l])])}return i}function _t(e,t,i,a){var s=t.options.props;if(o(s))return mt(e,t,{},a);var n={},d=e.attrs,c=e.props;if(r(d)||r(c))for(var l in s){var u=$(l);gt(n,c,l,u,!0)||gt(n,d,l,u,!1)}return mt(e,t,n,a)}function gt(e,t,i,o,a){if(r(t)){if(b(t,i))return e[i]=t[i],a||delete t[i],!0;if(b(t,o))return e[i]=t[o],a||delete t[o],!0}return!1}function yt(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}function vt(e){return n(e)?[ge(e)]:Array.isArray(e)?Dt(e):void 0}function bt(e){return r(e)&&r(e.text)&&s(e.isComment)}function Dt(e,t){var i,s,d,c,l=[];for(i=0;i<e.length;i++)s=e[i],o(s)||"boolean"===typeof s||(d=l.length-1,c=l[d],Array.isArray(s)?s.length>0&&(s=Dt(s,(t||"")+"_"+i),bt(s[0])&&bt(c)&&(l[d]=ge(c.text+s[0].text),s.shift()),l.push.apply(l,s)):n(s)?bt(c)?l[d]=ge(c.text+s):""!==s&&l.push(ge(s)):bt(s)&&bt(c)?l[d]=ge(c.text+s.text):(a(e._isVList)&&r(s.tag)&&o(s.key)&&r(t)&&(s.key="__vlist"+t+"_"+i+"__"),l.push(s)));return l}function St(e){var t=e.$options.provide;t&&(e._provided="function"===typeof t?t.call(e):t)}function kt(e){var t=Ct(e.$options.inject,e);t&&(Ce(!1),Object.keys(t).forEach((function(i){Te(e,i,t[i])})),Ce(!0))}function Ct(e,t){if(e){for(var i=Object.create(null),o=de?Reflect.ownKeys(e):Object.keys(e),r=0;r<o.length;r++){var a=o[r];if("__ob__"!==a){var s=e[a].from,n=t;while(n){if(n._provided&&b(n._provided,s)){i[a]=n._provided[s];break}n=n.$parent}if(!n)if("default"in e[a]){var d=e[a].default;i[a]="function"===typeof d?d.call(t):d}else 0}}return i}}function Pt(e,t){if(!e||!e.length)return{};for(var i={},o=0,r=e.length;o<r;o++){var a=e[o],s=a.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,a.context!==t&&a.fnContext!==t||!s||null==s.slot)a.asyncMeta&&a.asyncMeta.data&&"page"===a.asyncMeta.data.slot?(i["page"]||(i["page"]=[])).push(a):(i.default||(i.default=[])).push(a);else{var n=s.slot,d=i[n]||(i[n]=[]);"template"===a.tag?d.push.apply(d,a.children||[]):d.push(a)}}for(var c in i)i[c].every($t)&&delete i[c];return i}function $t(e){return e.isComment&&!e.asyncFactory||" "===e.text}function wt(e,t,o){var r,a=Object.keys(t).length>0,s=e?!!e.$stable:!a,n=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(s&&o&&o!==i&&n===o.$key&&!a&&!o.$hasNormal)return o;for(var d in r={},e)e[d]&&"$"!==d[0]&&(r[d]=It(t,d,e[d]))}else r={};for(var c in t)c in r||(r[c]=Tt(t,c));return e&&Object.isExtensible(e)&&(e._normalized=r),z(r,"$stable",s),z(r,"$key",n),z(r,"$hasNormal",a),r}function It(e,t,i){var o=function(){var e=arguments.length?i.apply(null,arguments):i({});return e=e&&"object"===typeof e&&!Array.isArray(e)?[e]:vt(e),e&&(0===e.length||1===e.length&&e[0].isComment)?void 0:e};return i.proxy&&Object.defineProperty(e,t,{get:o,enumerable:!0,configurable:!0}),o}function Tt(e,t){return function(){return e[t]}}function xt(e,t){var i,o,a,s,n;if(Array.isArray(e)||"string"===typeof e)for(i=new Array(e.length),o=0,a=e.length;o<a;o++)i[o]=t(e[o],o,o,o);else if("number"===typeof e)for(i=new Array(e),o=0;o<e;o++)i[o]=t(o+1,o,o,o);else if(d(e))if(de&&e[Symbol.iterator]){i=[];var c=e[Symbol.iterator](),l=c.next();while(!l.done)i.push(t(l.value,i.length,o,o++)),l=c.next()}else for(s=Object.keys(e),i=new Array(s.length),o=0,a=s.length;o<a;o++)n=s[o],i[o]=t(e[n],n,o,o);return r(i)||(i=[]),i._isVList=!0,i}function Ot(e,t,i,o){var r,a=this.$scopedSlots[e];a?(i=i||{},o&&(i=O(O({},o),i)),r=a(i,this,i._i)||t):r=this.$slots[e]||t;var s=i&&i.slot;return s?this.$createElement("template",{slot:s},r):r}function Et(e){return ze(this.$options,"filters",e,!0)||M}function jt(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Rt(e,t,i,o,r){var a=q.keyCodes[t]||i;return r&&o&&!q.keyCodes[t]?jt(r,o):a?jt(a,e):o?$(o)!==t:void 0}function Mt(e,t,i,o,r){if(i)if(d(i)){var a;Array.isArray(i)&&(i=E(i));var s=function(s){if("class"===s||"style"===s||g(s))a=e;else{var n=e.attrs&&e.attrs.type;a=o||q.mustUseProp(t,n,s)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var d=k(s),c=$(s);if(!(d in a)&&!(c in a)&&(a[s]=i[s],r)){var l=e.on||(e.on={});l["update:"+s]=function(e){i[s]=e}}};for(var n in i)s(n)}else;return e}function At(e,t){var i=this._staticTrees||(this._staticTrees=[]),o=i[e];return o&&!t||(o=i[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),Nt(o,"__static__"+e,!1)),o}function Lt(e,t,i){return Nt(e,"__once__"+t+(i?"_"+i:""),!0),e}function Nt(e,t,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)e[o]&&"string"!==typeof e[o]&&Ut(e[o],t+"_"+o,i);else Ut(e,t,i)}function Ut(e,t,i){e.isStatic=!0,e.key=t,e.isOnce=i}function Ft(e,t){if(t)if(l(t)){var i=e.on=e.on?O({},e.on):{};for(var o in t){var r=i[o],a=t[o];i[o]=r?[].concat(r,a):a}}else;return e}function qt(e,t,i,o){t=t||{$stable:!i};for(var r=0;r<e.length;r++){var a=e[r];Array.isArray(a)?qt(a,t,i):a&&(a.proxy&&(a.fn.proxy=!0),t[a.key]=a.fn)}return o&&(t.$key=o),t}function Vt(e,t){for(var i=0;i<t.length;i+=2){var o=t[i];"string"===typeof o&&o&&(e[t[i]]=t[i+1])}return e}function Bt(e,t){return"string"===typeof e?t+e:e}function zt(e){e._o=Lt,e._n=m,e._s=p,e._l=xt,e._t=Ot,e._q=A,e._i=L,e._m=At,e._f=Et,e._k=Rt,e._b=Mt,e._v=ge,e._e=_e,e._u=qt,e._g=Ft,e._d=Vt,e._p=Bt}function Jt(e,t,o,r,s){var n,d=this,c=s.options;b(r,"_uid")?(n=Object.create(r),n._original=r):(n=r,r=r._original);var l=a(c._compiled),u=!l;this.data=e,this.props=t,this.children=o,this.parent=r,this.listeners=e.on||i,this.injections=Ct(c.inject,r),this.slots=function(){return d.$slots||wt(e.scopedSlots,d.$slots=Pt(o,r)),d.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return wt(e.scopedSlots,this.slots())}}),l&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=wt(e.scopedSlots,this.$slots)),c._scopeId?this._c=function(e,t,i,o){var a=ri(n,e,t,i,o,u);return a&&!Array.isArray(a)&&(a.fnScopeId=c._scopeId,a.fnContext=r),a}:this._c=function(e,t,i,o){return ri(n,e,t,i,o,u)}}function Yt(e,t,o,a,s){var n=e.options,d={},c=n.props;if(r(c))for(var l in c)d[l]=Je(l,c,t||i);else r(o.attrs)&&Wt(d,o.attrs),r(o.props)&&Wt(d,o.props);var u=new Jt(o,d,s,a,e),h=n.render.call(null,u._c,u);if(h instanceof pe)return Gt(h,o,u.parent,n,u);if(Array.isArray(h)){for(var f=vt(h)||[],p=new Array(f.length),m=0;m<f.length;m++)p[m]=Gt(f[m],o,u.parent,n,u);return p}}function Gt(e,t,i,o,r){var a=ye(e);return a.fnContext=i,a.fnOptions=o,t.slot&&((a.data||(a.data={})).slot=t.slot),a}function Wt(e,t){for(var i in t)e[k(i)]=t[i]}zt(Jt.prototype);var Ht={init:function(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var i=e;Ht.prepatch(i,i)}else{var o=e.componentInstance=Kt(e,ki);o.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var i=t.componentOptions,o=t.componentInstance=e.componentInstance;wi(o,i.propsData,i.listeners,t,i.children)},insert:function(e){var t=e.context,i=e.componentInstance;i._isMounted||(Oi(i,"onServiceCreated"),Oi(i,"onServiceAttached"),i._isMounted=!0,Oi(i,"mounted")),e.data.keepAlive&&(t._isMounted?Bi(i):Ti(i,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?xi(t,!0):t.$destroy())}},Xt=Object.keys(Ht);function Zt(e,t,i,s,n){if(!o(e)){var c=i.$options._base;if(d(e)&&(e=c.extend(e)),"function"===typeof e){var l;if(o(e.cid)&&(l=e,e=pi(l,c),void 0===e))return fi(l,t,i,s,n);t=t||{},fo(e),r(t.model)&&ti(e.options,t);var u=_t(t,e,n,i);if(a(e.options.functional))return Yt(e,u,t,i,s);var h=t.on;if(t.on=t.nativeOn,a(e.options.abstract)){var f=t.slot;t={},f&&(t.slot=f)}Qt(t);var p=e.options.name||n,m=new pe("vue-component-"+e.cid+(p?"-"+p:""),t,void 0,void 0,void 0,i,{Ctor:e,propsData:u,listeners:h,tag:n,children:s},l);return m}}}function Kt(e,t){var i={_isComponent:!0,_parentVnode:e,parent:t},o=e.data.inlineTemplate;return r(o)&&(i.render=o.render,i.staticRenderFns=o.staticRenderFns),new e.componentOptions.Ctor(i)}function Qt(e){for(var t=e.hook||(e.hook={}),i=0;i<Xt.length;i++){var o=Xt[i],r=t[o],a=Ht[o];r===a||r&&r._merged||(t[o]=r?ei(a,r):a)}}function ei(e,t){var i=function(i,o){e(i,o),t(i,o)};return i._merged=!0,i}function ti(e,t){var i=e.model&&e.model.prop||"value",o=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[i]=t.model.value;var a=t.on||(t.on={}),s=a[o],n=t.model.callback;r(s)?(Array.isArray(s)?-1===s.indexOf(n):s!==n)&&(a[o]=[n].concat(s)):a[o]=n}var ii=1,oi=2;function ri(e,t,i,o,r,s){return(Array.isArray(i)||n(i))&&(r=o,o=i,i=void 0),a(s)&&(r=oi),ai(e,t,i,o,r)}function ai(e,t,i,o,a){if(r(i)&&r(i.__ob__))return _e();if(r(i)&&r(i.is)&&(t=i.is),!t)return _e();var s,n,d;(Array.isArray(o)&&"function"===typeof o[0]&&(i=i||{},i.scopedSlots={default:o[0]},o.length=0),a===oi?o=vt(o):a===ii&&(o=yt(o)),"string"===typeof t)?(n=e.$vnode&&e.$vnode.ns||q.getTagNamespace(t),s=q.isReservedTag(t)?new pe(q.parsePlatformTagName(t),i,o,void 0,void 0,e):i&&i.pre||!r(d=ze(e.$options,"components",t))?new pe(t,i,o,void 0,void 0,e):Zt(d,i,e,o,t)):s=Zt(t,i,e,o);return Array.isArray(s)?s:r(s)?(r(n)&&si(s,n),r(i)&&ni(i),s):_e()}function si(e,t,i){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,i=!0),r(e.children))for(var s=0,n=e.children.length;s<n;s++){var d=e.children[s];r(d.tag)&&(o(d.ns)||a(i)&&"svg"!==d.tag)&&si(d,t,i)}}function ni(e){d(e.style)&&lt(e.style),d(e.class)&&lt(e.class)}function di(e){e._vnode=null,e._staticTrees=null;var t=e.$options,o=e.$vnode=t._parentVnode,r=o&&o.context;e.$slots=Pt(t._renderChildren,r),e.$scopedSlots=i,e._c=function(t,i,o,r){return ri(e,t,i,o,r,!1)},e.$createElement=function(t,i,o,r){return ri(e,t,i,o,r,!0)};var a=o&&o.data;Te(e,"$attrs",a&&a.attrs||i,null,!0),Te(e,"$listeners",t._parentListeners||i,null,!0)}var ci,li=null;function ui(e){zt(e.prototype),e.prototype.$nextTick=function(e){return dt(e,this)},e.prototype._render=function(){var e,t=this,i=t.$options,o=i.render,r=i._parentVnode;r&&(t.$scopedSlots=wt(r.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=r;try{li=t,e=o.call(t._renderProxy,t.$createElement)}catch(ir){Xe(ir,t,"render"),e=t._vnode}finally{li=null}return Array.isArray(e)&&1===e.length&&(e=e[0]),e instanceof pe||(e=_e()),e.parent=r,e}}function hi(e,t){return(e.__esModule||de&&"Module"===e[Symbol.toStringTag])&&(e=e.default),d(e)?t.extend(e):e}function fi(e,t,i,o,r){var a=_e();return a.asyncFactory=e,a.asyncMeta={data:t,context:i,children:o,tag:r},a}function pi(e,t){if(a(e.error)&&r(e.errorComp))return e.errorComp;if(r(e.resolved))return e.resolved;var i=li;if(i&&r(e.owners)&&-1===e.owners.indexOf(i)&&e.owners.push(i),a(e.loading)&&r(e.loadingComp))return e.loadingComp;if(i&&!r(e.owners)){var s=e.owners=[i],n=!0,c=null,l=null;i.$on("hook:destroyed",(function(){return y(s,i)}));var u=function(e){for(var t=0,i=s.length;t<i;t++)s[t].$forceUpdate();e&&(s.length=0,null!==c&&(clearTimeout(c),c=null),null!==l&&(clearTimeout(l),l=null))},h=N((function(i){e.resolved=hi(i,t),n?s.length=0:u(!0)})),p=N((function(t){r(e.errorComp)&&(e.error=!0,u(!0))})),m=e(h,p);return d(m)&&(f(m)?o(e.resolved)&&m.then(h,p):f(m.component)&&(m.component.then(h,p),r(m.error)&&(e.errorComp=hi(m.error,t)),r(m.loading)&&(e.loadingComp=hi(m.loading,t),0===m.delay?e.loading=!0:c=setTimeout((function(){c=null,o(e.resolved)&&o(e.error)&&(e.loading=!0,u(!1))}),m.delay||200)),r(m.timeout)&&(l=setTimeout((function(){l=null,o(e.resolved)&&p(null)}),m.timeout)))),n=!1,e.loading?e.loadingComp:e.resolved}}function mi(e){return e.isComment&&e.asyncFactory}function _i(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var i=e[t];if(r(i)&&(r(i.componentOptions)||mi(i)))return i}}function gi(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&Di(e,t)}function yi(e,t){ci.$on(e,t)}function vi(e,t){ci.$off(e,t)}function bi(e,t){var i=ci;return function o(){var r=t.apply(null,arguments);null!==r&&i.$off(e,o)}}function Di(e,t,i){ci=e,pt(t,i||{},yi,vi,bi,e),ci=void 0}function Si(e){var t=/^hook:/;e.prototype.$on=function(e,i){var o=this;if(Array.isArray(e))for(var r=0,a=e.length;r<a;r++)o.$on(e[r],i);else(o._events[e]||(o._events[e]=[])).push(i),t.test(e)&&(o._hasHookEvent=!0);return o},e.prototype.$once=function(e,t){var i=this;function o(){i.$off(e,o),t.apply(i,arguments)}return o.fn=t,i.$on(e,o),i},e.prototype.$off=function(e,t){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(e)){for(var o=0,r=e.length;o<r;o++)i.$off(e[o],t);return i}var a,s=i._events[e];if(!s)return i;if(!t)return i._events[e]=null,i;var n=s.length;while(n--)if(a=s[n],a===t||a.fn===t){s.splice(n,1);break}return i},e.prototype.$emit=function(e){var t=this,i=t._events[e];if(i){i=i.length>1?x(i):i;for(var o=x(arguments,1),r='event handler for "'+e+'"',a=0,s=i.length;a<s;a++)Ze(i[a],t,o,t,r)}return t}}var ki=null;function Ci(e){var t=ki;return ki=e,function(){ki=t}}function Pi(e){var t=e.$options,i=t.parent;if(i&&!t.abstract){while(i.$options.abstract&&i.$parent)i=i.$parent;i.$children.push(e)}e.$parent=i,e.$root=i?i.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function $i(e){e.prototype._update=function(e,t){var i=this,o=i.$el,r=i._vnode,a=Ci(i);i._vnode=e,i.$el=r?i.__patch__(r,e):i.__patch__(i.$el,e,t,!1),a(),o&&(o.__vue__=null),i.$el&&(i.$el.__vue__=i),i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode&&(i.$parent.$el=i.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Oi(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||y(t.$children,e),e._watcher&&e._watcher.teardown();var i=e._watchers.length;while(i--)e._watchers[i].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Oi(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}function wi(e,t,o,r,a){var s=r.data.scopedSlots,n=e.$scopedSlots,d=!!(s&&!s.$stable||n!==i&&!n.$stable||s&&e.$scopedSlots.$key!==s.$key),c=!!(a||e.$options._renderChildren||d);if(e.$options._parentVnode=r,e.$vnode=r,e._vnode&&(e._vnode.parent=r),e.$options._renderChildren=a,e.$attrs=r.data.attrs||i,e.$listeners=o||i,t&&e.$options.props){Ce(!1);for(var l=e._props,u=e.$options._propKeys||[],h=0;h<u.length;h++){var f=u[h],p=e.$options.props;l[f]=Je(f,p,t,e)}Ce(!0),e.$options.propsData=t}e._$updateProperties&&e._$updateProperties(e),o=o||i;var m=e.$options._parentListeners;e.$options._parentListeners=o,Di(e,o,m),c&&(e.$slots=Pt(a,r.context),e.$forceUpdate())}function Ii(e){while(e&&(e=e.$parent))if(e._inactive)return!0;return!1}function Ti(e,t){if(t){if(e._directInactive=!1,Ii(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var i=0;i<e.$children.length;i++)Ti(e.$children[i]);Oi(e,"activated")}}function xi(e,t){if((!t||(e._directInactive=!0,!Ii(e)))&&!e._inactive){e._inactive=!0;for(var i=0;i<e.$children.length;i++)xi(e.$children[i]);Oi(e,"deactivated")}}function Oi(e,t){he();var i=e.$options[t],o=t+" hook";if(i)for(var r=0,a=i.length;r<a;r++)Ze(i[r],e,null,e,o);e._hasHookEvent&&e.$emit("hook:"+t),fe()}var Ei=[],ji=[],Ri={},Mi=!1,Ai=!1,Li=0;function Ni(){Li=Ei.length=ji.length=0,Ri={},Mi=Ai=!1}var Ui=Date.now;if(H&&!Q){var Fi=window.performance;Fi&&"function"===typeof Fi.now&&Ui()>document.createEvent("Event").timeStamp&&(Ui=function(){return Fi.now()})}function qi(){var e,t;for(Ui(),Ai=!0,Ei.sort((function(e,t){return e.id-t.id})),Li=0;Li<Ei.length;Li++)e=Ei[Li],e.before&&e.before(),t=e.id,Ri[t]=null,e.run();var i=ji.slice(),o=Ei.slice();Ni(),zi(i),Vi(o),ae&&q.devtools&&ae.emit("flush")}function Vi(e){var t=e.length;while(t--){var i=e[t],o=i.vm;o._watcher===i&&o._isMounted&&!o._isDestroyed&&Oi(o,"updated")}}function Bi(e){e._inactive=!1,ji.push(e)}function zi(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,Ti(e[t],!0)}function Ji(e){var t=e.id;if(null==Ri[t]){if(Ri[t]=!0,Ai){var i=Ei.length-1;while(i>Li&&Ei[i].id>e.id)i--;Ei.splice(i+1,0,e)}else Ei.push(e);Mi||(Mi=!0,dt(qi))}}var Yi=0,Gi=function(e,t,i,o,r){this.vm=e,r&&(e._watcher=this),e._watchers.push(this),o?(this.deep=!!o.deep,this.user=!!o.user,this.lazy=!!o.lazy,this.sync=!!o.sync,this.before=o.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++Yi,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ne,this.newDepIds=new ne,this.expression="","function"===typeof t?this.getter=t:(this.getter=Y(t),this.getter||(this.getter=j)),this.value=this.lazy?void 0:this.get()};Gi.prototype.get=function(){var e;he(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(ir){if(!this.user)throw ir;Xe(ir,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&lt(e),fe(),this.cleanupDeps()}return e},Gi.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},Gi.prototype.cleanupDeps=function(){var e=this.deps.length;while(e--){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},Gi.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Ji(this)},Gi.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||d(e)||this.deep){var t=this.value;if(this.value=e,this.user)try{this.cb.call(this.vm,e,t)}catch(ir){Xe(ir,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,e,t)}}},Gi.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},Gi.prototype.depend=function(){var e=this.deps.length;while(e--)this.deps[e].depend()},Gi.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);var e=this.deps.length;while(e--)this.deps[e].removeSub(this);this.active=!1}};var Wi={enumerable:!0,configurable:!0,get:j,set:j};function Hi(e,t,i){Wi.get=function(){return this[t][i]},Wi.set=function(e){this[t][i]=e},Object.defineProperty(e,i,Wi)}function Xi(e){e._watchers=[];var t=e.$options;t.props&&Zi(e,t.props),t.methods&&ao(e,t.methods),t.data?Ki(e):Ie(e._data={},!0),t.computed&&to(e,t.computed),t.watch&&t.watch!==ie&&so(e,t.watch)}function Zi(e,t){var i=e.$options.propsData||{},o=e._props={},r=e.$options._propKeys=[],a=!e.$parent;a||Ce(!1);var s=function(a){r.push(a);var s=Je(a,t,i,e);Te(o,a,s),a in e||Hi(e,"_props",a)};for(var n in t)s(n);Ce(!0)}function Ki(e){var t=e.$options.data;t=e._data="function"===typeof t?Qi(t,e):t||{},l(t)||(t={});var i=Object.keys(t),o=e.$options.props,r=(e.$options.methods,i.length);while(r--){var a=i[r];0,o&&b(o,a)||B(a)||Hi(e,"_data",a)}Ie(t,!0)}function Qi(e,t){he();try{return e.call(t,t)}catch(ir){return Xe(ir,t,"data()"),{}}finally{fe()}}var eo={lazy:!0};function to(e,t){var i=e._computedWatchers=Object.create(null),o=re();for(var r in t){var a=t[r],s="function"===typeof a?a:a.get;0,o||(i[r]=new Gi(e,s||j,j,eo)),r in e||io(e,r,a)}}function io(e,t,i){var o=!re();"function"===typeof i?(Wi.get=o?oo(t):ro(i),Wi.set=j):(Wi.get=i.get?o&&!1!==i.cache?oo(t):ro(i.get):j,Wi.set=i.set||j),Object.defineProperty(e,t,Wi)}function oo(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),ue.SharedObject.target&&t.depend(),t.value}}function ro(e){return function(){return e.call(this,this)}}function ao(e,t){e.$options.props;for(var i in t)e[i]="function"!==typeof t[i]?j:T(t[i],e)}function so(e,t){for(var i in t){var o=t[i];if(Array.isArray(o))for(var r=0;r<o.length;r++)no(e,i,o[r]);else no(e,i,o)}}function no(e,t,i,o){return l(i)&&(o=i,i=i.handler),"string"===typeof i&&(i=e[i]),e.$watch(t,i,o)}function co(e){var t={get:function(){return this._data}},i={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",i),e.prototype.$set=xe,e.prototype.$delete=Oe,e.prototype.$watch=function(e,t,i){var o=this;if(l(t))return no(o,e,t,i);i=i||{},i.user=!0;var r=new Gi(o,e,t,i);if(i.immediate)try{t.call(o,r.value)}catch(a){Xe(a,o,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}var lo=0;function uo(e){e.prototype._init=function(e){var t=this;t._uid=lo++,t._isVue=!0,e&&e._isComponent?ho(t,e):t.$options=Be(fo(t.constructor),e||{},t),t._renderProxy=t,t._self=t,Pi(t),gi(t),di(t),Oi(t,"beforeCreate"),!t._$fallback&&kt(t),Xi(t),!t._$fallback&&St(t),!t._$fallback&&Oi(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}function ho(e,t){var i=e.$options=Object.create(e.constructor.options),o=t._parentVnode;i.parent=t.parent,i._parentVnode=o;var r=o.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,t.render&&(i.render=t.render,i.staticRenderFns=t.staticRenderFns)}function fo(e){var t=e.options;if(e.super){var i=fo(e.super),o=e.superOptions;if(i!==o){e.superOptions=i;var r=po(e);r&&O(e.extendOptions,r),t=e.options=Be(i,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function po(e){var t,i=e.options,o=e.sealedOptions;for(var r in i)i[r]!==o[r]&&(t||(t={}),t[r]=i[r]);return t}function mo(e){this._init(e)}function _o(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var i=x(arguments,1);return i.unshift(this),"function"===typeof e.install?e.install.apply(e,i):"function"===typeof e&&e.apply(null,i),t.push(e),this}}function go(e){e.mixin=function(e){return this.options=Be(this.options,e),this}}function yo(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var i=this,o=i.cid,r=e._Ctor||(e._Ctor={});if(r[o])return r[o];var a=e.name||i.options.name;var s=function(e){this._init(e)};return s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.cid=t++,s.options=Be(i.options,e),s["super"]=i,s.options.props&&vo(s),s.options.computed&&bo(s),s.extend=i.extend,s.mixin=i.mixin,s.use=i.use,U.forEach((function(e){s[e]=i[e]})),a&&(s.options.components[a]=s),s.superOptions=i.options,s.extendOptions=e,s.sealedOptions=O({},s.options),r[o]=s,s}}function vo(e){var t=e.options.props;for(var i in t)Hi(e.prototype,"_props",i)}function bo(e){var t=e.options.computed;for(var i in t)io(e.prototype,i,t[i])}function Do(e){U.forEach((function(t){e[t]=function(e,i){return i?("component"===t&&l(i)&&(i.name=i.name||e,i=this.options._base.extend(i)),"directive"===t&&"function"===typeof i&&(i={bind:i,update:i}),this.options[t+"s"][e]=i,i):this.options[t+"s"][e]}}))}function So(e){return e&&(e.Ctor.options.name||e.tag)}function ko(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"===typeof e?e.split(",").indexOf(t)>-1:!!u(e)&&e.test(t)}function Co(e,t){var i=e.cache,o=e.keys,r=e._vnode;for(var a in i){var s=i[a];if(s){var n=So(s.componentOptions);n&&!t(n)&&Po(i,a,o,r)}}}function Po(e,t,i,o){var r=e[t];!r||o&&r.tag===o.tag||r.componentInstance.$destroy(),e[t]=null,y(i,t)}uo(mo),co(mo),Si(mo),$i(mo),ui(mo);var $o=[String,RegExp,Array],wo={name:"keep-alive",abstract:!0,props:{include:$o,exclude:$o,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)Po(this.cache,e,this.keys)},mounted:function(){var e=this;this.$watch("include",(function(t){Co(e,(function(e){return ko(t,e)}))})),this.$watch("exclude",(function(t){Co(e,(function(e){return!ko(t,e)}))}))},render:function(){var e=this.$slots.default,t=_i(e),i=t&&t.componentOptions;if(i){var o=So(i),r=this,a=r.include,s=r.exclude;if(a&&(!o||!ko(a,o))||s&&o&&ko(s,o))return t;var n=this,d=n.cache,c=n.keys,l=null==t.key?i.Ctor.cid+(i.tag?"::"+i.tag:""):t.key;d[l]?(t.componentInstance=d[l].componentInstance,y(c,l),c.push(l)):(d[l]=t,c.push(l),this.max&&c.length>parseInt(this.max)&&Po(d,c[0],c,this._vnode)),t.data.keepAlive=!0}return t||e&&e[0]}},Io={KeepAlive:wo};function To(e){var t={get:function(){return q}};Object.defineProperty(e,"config",t),e.util={warn:ce,extend:O,mergeOptions:Be,defineReactive:Te},e.set=xe,e.delete=Oe,e.nextTick=dt,e.observable=function(e){return Ie(e),e},e.options=Object.create(null),U.forEach((function(t){e.options[t+"s"]=Object.create(null)})),e.options._base=e,O(e.options.components,Io),_o(e),go(e),yo(e),Do(e)}To(mo),Object.defineProperty(mo.prototype,"$isServer",{get:re}),Object.defineProperty(mo.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(mo,"FunctionalRenderContext",{value:Jt}),mo.version="2.6.11";var xo="[object Array]",Oo="[object Object]";function Eo(e,t){var i={};return jo(e,t),Ro(e,t,"",i),i}function jo(e,t){if(e!==t){var i=Ao(e),o=Ao(t);if(i==Oo&&o==Oo){if(Object.keys(e).length>=Object.keys(t).length)for(var r in t){var a=e[r];void 0===a?e[r]=null:jo(a,t[r])}}else i==xo&&o==xo&&e.length>=t.length&&t.forEach((function(t,i){jo(e[i],t)}))}}function Ro(e,t,i,o){if(e!==t){var r=Ao(e),a=Ao(t);if(r==Oo)if(a!=Oo||Object.keys(e).length<Object.keys(t).length)Mo(o,i,e);else{var s=function(r){var a=e[r],s=t[r],n=Ao(a),d=Ao(s);if(n!=xo&&n!=Oo)a!==t[r]&&Mo(o,(""==i?"":i+".")+r,a);else if(n==xo)d!=xo||a.length<s.length?Mo(o,(""==i?"":i+".")+r,a):a.forEach((function(e,t){Ro(e,s[t],(""==i?"":i+".")+r+"["+t+"]",o)}));else if(n==Oo)if(d!=Oo||Object.keys(a).length<Object.keys(s).length)Mo(o,(""==i?"":i+".")+r,a);else for(var c in a)Ro(a[c],s[c],(""==i?"":i+".")+r+"."+c,o)};for(var n in e)s(n)}else r==xo?a!=xo||e.length<t.length?Mo(o,i,e):e.forEach((function(e,r){Ro(e,t[r],i+"["+r+"]",o)})):Mo(o,i,e)}}function Mo(e,t,i){e[t]=i}function Ao(e){return Object.prototype.toString.call(e)}function Lo(e){if(e.__next_tick_callbacks&&e.__next_tick_callbacks.length){if(Object({NODE_ENV:"production",VUE_APP_NAME:" ",VUE_APP_PLATFORM:"mp-weixin",BASE_URL:"/"}).VUE_APP_DEBUG){var t=e.$scope;console.log("["+ +new Date+"]["+(t.is||t.route)+"]["+e._uid+"]:flushCallbacks["+e.__next_tick_callbacks.length+"]")}var i=e.__next_tick_callbacks.slice(0);e.__next_tick_callbacks.length=0;for(var o=0;o<i.length;o++)i[o]()}}function No(e){return Ei.find((function(t){return e._watcher===t}))}function Uo(e,t){if(!e.__next_tick_pending&&!No(e)){if(Object({NODE_ENV:"production",VUE_APP_NAME:" ",VUE_APP_PLATFORM:"mp-weixin",BASE_URL:"/"}).VUE_APP_DEBUG){var i=e.$scope;console.log("["+ +new Date+"]["+(i.is||i.route)+"]["+e._uid+"]:nextVueTick")}return dt(t,e)}if(Object({NODE_ENV:"production",VUE_APP_NAME:" ",VUE_APP_PLATFORM:"mp-weixin",BASE_URL:"/"}).VUE_APP_DEBUG){var o=e.$scope;console.log("["+ +new Date+"]["+(o.is||o.route)+"]["+e._uid+"]:nextMPTick")}var r;if(e.__next_tick_callbacks||(e.__next_tick_callbacks=[]),e.__next_tick_callbacks.push((function(){if(t)try{t.call(e)}catch(ir){Xe(ir,e,"nextTick")}else r&&r(e)})),!t&&"undefined"!==typeof Promise)return new Promise((function(e){r=e}))}function Fo(e){var t=Object.create(null),i=[].concat(Object.keys(e._data||{}),Object.keys(e._computedWatchers||{}));i.reduce((function(t,i){return t[i]=e[i],t}),t);var o=e.__composition_api_state__||e.__secret_vfa_state__,r=o&&o.rawBindings;return r&&Object.keys(r).forEach((function(i){t[i]=e[i]})),Object.assign(t,e.$mp.data||{}),Array.isArray(e.$options.behaviors)&&-1!==e.$options.behaviors.indexOf("uni://form-field")&&(t["name"]=e.name,t["value"]=e.value),JSON.parse(JSON.stringify(t))}var qo=function(e,t){var i=this;if(null!==t&&("page"===this.mpType||"component"===this.mpType)){var o=this.$scope,r=Object.create(null);try{r=Fo(this)}catch(n){console.error(n)}r.__webviewId__=o.data.__webviewId__;var a=Object.create(null);Object.keys(r).forEach((function(e){a[e]=o.data[e]}));var s=!1===this.$shouldDiffData?r:Eo(r,a);Object.keys(s).length?(Object({NODE_ENV:"production",VUE_APP_NAME:" ",VUE_APP_PLATFORM:"mp-weixin",BASE_URL:"/"}).VUE_APP_DEBUG&&console.log("["+ +new Date+"]["+(o.is||o.route)+"]["+this._uid+"]差量更新",JSON.stringify(s)),this.__next_tick_pending=!0,o.setData(s,(function(){i.__next_tick_pending=!1,Lo(i)}))):Lo(this)}};function Vo(){}function Bo(e,t,i){if(!e.mpType)return e;"app"===e.mpType&&(e.$options.render=Vo),e.$options.render||(e.$options.render=Vo),!e._$fallback&&Oi(e,"beforeMount");var o=function(){e._update(e._render(),i)};return new Gi(e,o,j,{before:function(){e._isMounted&&!e._isDestroyed&&Oi(e,"beforeUpdate")}},!0),i=!1,e}function zo(e,t){return r(e)||r(t)?Jo(e,Yo(t)):""}function Jo(e,t){return e?t?e+" "+t:e:t||""}function Yo(e){return Array.isArray(e)?Go(e):d(e)?Wo(e):"string"===typeof e?e:""}function Go(e){for(var t,i="",o=0,a=e.length;o<a;o++)r(t=Yo(e[o]))&&""!==t&&(i&&(i+=" "),i+=t);return i}function Wo(e){var t="";for(var i in e)e[i]&&(t&&(t+=" "),t+=i);return t}var Ho=D((function(e){var t={},i=/;(?![^(]*\))/g,o=/:(.+)/;return e.split(i).forEach((function(e){if(e){var i=e.split(o);i.length>1&&(t[i[0].trim()]=i[1].trim())}})),t}));function Xo(e){return Array.isArray(e)?E(e):"string"===typeof e?Ho(e):e}var Zo=["createSelectorQuery","createIntersectionObserver","selectAllComponents","selectComponent"];function Ko(e,t){var i=t.split("."),o=i[0];return 0===o.indexOf("__$n")&&(o=parseInt(o.replace("__$n",""))),1===i.length?e[o]:Ko(e[o],i.slice(1).join("."))}function Qo(e){e.config.errorHandler=function(t,i,o){e.util.warn("Error in "+o+': "'+t.toString()+'"',i),console.error(t);var r="function"===typeof getApp&&getApp();r&&r.onError&&r.onError(t)};var t=e.prototype.$emit;e.prototype.$emit=function(e){return this.$scope&&e&&this.$scope["triggerEvent"](e,{__args__:x(arguments,1)}),t.apply(this,arguments)},e.prototype.$nextTick=function(e){return Uo(this,e)},Zo.forEach((function(t){e.prototype[t]=function(e){return this.$scope&&this.$scope[t]?this.$scope[t](e):"undefined"!==typeof my?"createSelectorQuery"===t?my.createSelectorQuery(e):"createIntersectionObserver"===t?my.createIntersectionObserver(e):void 0:void 0}})),e.prototype.__init_provide=St,e.prototype.__init_injections=kt,e.prototype.__call_hook=function(e,t){var i=this;he();var o,r=i.$options[e],a=e+" hook";if(r)for(var s=0,n=r.length;s<n;s++)o=Ze(r[s],i,t?[t]:null,i,a);return i._hasHookEvent&&i.$emit("hook:"+e,t),fe(),o},e.prototype.__set_model=function(e,t,i,o){Array.isArray(o)&&(-1!==o.indexOf("trim")&&(i=i.trim()),-1!==o.indexOf("number")&&(i=this._n(i))),e||(e=this),e[t]=i},e.prototype.__set_sync=function(e,t,i){e||(e=this),e[t]=i},e.prototype.__get_orig=function(e){return l(e)&&e["$orig"]||e},e.prototype.__get_value=function(e,t){return Ko(t||this,e)},e.prototype.__get_class=function(e,t){return zo(t,e)},e.prototype.__get_style=function(e,t){if(!e&&!t)return"";var i=Xo(e),o=t?O(t,i):i;return Object.keys(o).map((function(e){return $(e)+":"+o[e]})).join(";")},e.prototype.__map=function(e,t){var i,o,r,a,s;if(Array.isArray(e)){for(i=new Array(e.length),o=0,r=e.length;o<r;o++)i[o]=t(e[o],o);return i}if(d(e)){for(a=Object.keys(e),i=Object.create(null),o=0,r=a.length;o<r;o++)s=a[o],i[s]=t(e[s],s,o);return i}if("number"===typeof e){for(i=new Array(e),o=0,r=e;o<r;o++)i[o]=t(o,o);return i}return[]}}var er=["onLaunch","onShow","onHide","onUniNViewMessage","onPageNotFound","onThemeChange","onError","onUnhandledRejection","onInit","onLoad","onReady","onUnload","onPullDownRefresh","onReachBottom","onTabItemTap","onAddToFavorites","onShareTimeline","onShareAppMessage","onResize","onPageScroll","onNavigationBarButtonTap","onBackPress","onNavigationBarSearchInputChanged","onNavigationBarSearchInputConfirmed","onNavigationBarSearchInputClicked","onPageShow","onPageHide","onPageResize"];function tr(e){var t=e.extend;e.extend=function(e){e=e||{};var i=e.methods;return i&&Object.keys(i).forEach((function(t){-1!==er.indexOf(t)&&(e[t]=i[t],delete i[t])})),t.call(this,e)};var i=e.config.optionMergeStrategies,o=i.created;er.forEach((function(e){i[e]=o})),e.prototype.__lifecycle_hooks__=er}mo.prototype.__patch__=qo,mo.prototype.$mount=function(e,t){return Bo(this,e,t)},tr(mo),Qo(mo),t["default"]=mo}.call(this,i("c8ba"))},"67ba":function(e,t){},"67fd":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},"68d1":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c={data:function(){var e;return e={seckill_id:0,skuId:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},memberId:0,contactData:{title:"",path:"",img:""},swiperInterval:1,swiperAutoplay:!1},d(e,"swiperCurrent",1),d(e,"switchMedia","img"),d(e,"detailTab",0),d(e,"service",{}),d(e,"goodsCircle",!1),d(e,"evaluateConfig",{evaluate_audit:1,evaluate_show:0,evaluate_status:1}),d(e,"kefuConfig",{}),d(e,"isCommunity",!1),d(e,"videoContext",""),d(e,"source_member",0),e},onLoad:function(t){var i=this;return n(o.default.mark((function r(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.seckill_id=t.seckill_id||0,t.id&&(i.seckill_id=t.id),i.isIphoneX=i.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.source_member&&(i.source_member=t.source_member),t.scene&&(a=decodeURIComponent(t.scene),a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(i.seckill_id=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))),i.getService(),o.next=9,i.getGoodsSkuDetail();case 9:i.getEvaluateConfig();case 10:case"end":return o.stop()}}),r)})))()},onShow:function(){this.$langConfig.refresh(),this.token=e.getStorageSync("token"),""!=this.token&&(this.getCartCount(),this.getMemberId()),this.getKekuConfig(),this.modifyGoodsInfo(),this.videoContext=e.createVideoContext("goodsVideo"),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},methods:{goConnect:function(){if(e.getStorageSync("token")){var t={sku_id:this.goodsSkuDetail.sku_id,type:"seckill",type_id:this.goodsSkuDetail.seckill_id};return this.$util.redirectTo("/otherpages/chat/room/room",t),!1}this.source_member?this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id+"&source_member="+this.source_member):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id)},getGoodsSkuDetail:function(){var e=this;return n(o.default.mark((function t(){var i,a,s,n,d,c,l;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/seckill/api/seckillgoods/detail",async:!1,data:{seckill_id:e.seckill_id}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,e.shopInfo=a.shop_info,e.skuId=e.goodsSkuDetail.sku_id,s=new Date(1e3*i.timestamp),n=60*s.getHours()*60+60*s.getMinutes()+s.getSeconds(),e.goodsSkuDetail.seckill_start_time<=n&&n<e.goodsSkuDetail.seckill_end_time?e.goodsSkuDetail.discountTimeMachine=e.$util.countDown(e.goodsSkuDetail.seckill_end_time-n):e.goodsSkuDetail.seckill_start_time>n&&n<e.goodsSkuDetail.seckill_end_time?(e.$util.showToast({title:"限时秒杀活动还未开始"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)):n<e.goodsSkuDetail.seckill_start_time&&n>e.goodsSkuDetail.seckill_end_time&&(e.$util.showToast({title:"限时秒杀活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),e.goodsSkuDetail.show_price=e.goodsSkuDetail.seckill_price,e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.save_price=e.goodsSkuDetail.price-e.goodsSkuDetail.seckill_price>0?(e.goodsSkuDetail.price-e.goodsSkuDetail.seckill_price).toFixed(2):0,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(d=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(d,"attr_id"),c=0;c<e.goodsSkuDetail.goods_attr_format.length;c++)for(l=0;l<d.length;l++)e.goodsSkuDetail.goods_attr_format[c].attr_id==d[l].attr_id&&e.goodsSkuDetail.goods_attr_format[c].attr_value_id!=d[l].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[c].attr_value_name+="、"+d[l].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/seckill/detail/detail?seckill_id="+e.seckill_id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},e.setWechatShare(),""!=e.token&&e.getWhetherCollection(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},seckill:function(){var t=this;e.getStorageSync("token")?this.$refs.goodsSku.show("seckill",(function(){t.getCartCount()})):this.source_member?this.$refs.login.open("/promotionpages/seckill/detail/detail?seckill_id="+this.seckill_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/seckill/detail/detail?seckill_id="+this.seckill_id)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.forEach((function(t,i){e.goodsEvaluate[i].images&&(e.goodsEvaluate[i].images=e.goodsEvaluate[i].images.split(",")),1==e.goodsEvaluate[i].is_anonymous&&(e.goodsEvaluate[i].member_name=e.goodsEvaluate[i].member_name.replace(e.goodsEvaluate[i].member_name.substring(1,e.goodsEvaluate[i].member_name.length-1),"***"))})))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.source_member?this.$refs.login.open("/promotionpages/seckill/detail/detail?seckill_id="+this.seckill_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/seckill/detail/detail?seckill_id="+this.seckill_id)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));""!=t.token?t.posterHeight=parseInt(1240/o):t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={id:this.goodsSkuDetail.goods_id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/seckill/api/seckillgoods/poster",data:{page:"/promotionpages/seckill/detail/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/seckill/detail/detail?seckill_id="+this.seckill_id;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toEvaluateList:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++)for(var a=i[r].children,s=0;s<a.length;s++)a[s].attrs&&a[s].attrs.src&&o.push(a[s].attrs.src);e.previewImage({current:o,urls:o})}}};t.default=c}).call(this,i("543d")["default"])},"6bd1":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我要评价"};t.lang=o},"6d13":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},7139:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"砍价专区"};t.lang=o},7484:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},"74b5":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},7512:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"充值记录"};t.lang=o},"752f":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={methods:{getList:function(){var e=this;this.$api.sendRequest({url:"/memberrecommend/api/memberrecommend/lists",data:{page:this.page,page_size:this.page_size},success:function(t){e.inviteList=e.inviteList.concat(t.data.list),e.total_num=t.data.page_count}})},moreList:function(){this.page++,this.isClick=!1,this.page<this.total_num?(this.getList(),this.isClick=!0):this.page==this.total_num&&this.getList()},getBaseInfo:function(){var e=this;this.$api.sendRequest({url:"/memberrecommend/api/memberrecommend/info",success:function(t){0==t.code&&(e.info=t.data)}})},getMemberId:function(){var t=this;this.$api.sendRequest({url:"/api/member/id",success:function(i){i.code>=0&&(t.memberId=i.data,t.token=e.getStorageSync("token")),t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openRulePopup:function(){this.$refs.rulePopup.open()},closeRulePopup:function(){this.$refs.rulePopup.close()},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/pages/index/index/index";this.memberId&&(t+="?source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},openPosterPopup:function(){this.getPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open()},closePosterPopup:function(){this.$refs.posterPopup.close()},getPoster:function(){var e=this,t={source_member:this.memberId};this.$api.sendRequest({url:"/memberrecommend/api/memberrecommend/poster",data:{page:"/pages/index/index/index",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},savePoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})},fail:function(e){}})}}};t.default=i}).call(this,i("543d")["default"])},"76dc":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的关注"};t.lang=o},7856:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"瓜分红包列表"};t.lang=o},"789a":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},"7a9c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"中奖纪录"};t.lang=o},"7b44":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},"7bd8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},"7c74":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"秒杀专区"};t.lang=o},"7cc8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},"7e97":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"注册",mobileRegister:"手机号注册",accountRegister:"账号注册",mobilePlaceholder:"手机号登录仅限中国大陆用户",dynacodePlaceholder:"请输入动态码",captchaPlaceholder:"请输入验证码",accountPlaceholder:"请输入用户名",passwordPlaceholder:"请输入密码",rePasswordPlaceholder:"请确认密码",completeRegister:"完成注册，并登录",registerTips:"点击注册即代表您已同意",registerAgreement:"注册协议",next:"下一步",save:"保存"};t.lang=o},"7f8b":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账号注销"};t.lang=o},"822c":function(e,t,i){var o={"./en-us/common.js":"0b23","./zh-cn/common.js":"a5c74"};function r(e){var t=a(e);return i(t)}function a(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id="822c"},8672:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},8795:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=52.35987755982988,r=3.141592653589793,a=6378245,s=.006693421622965943;function n(e,t){var i=52.35987755982988,o=e-.0065,r=t-.006,a=Math.sqrt(o*o+r*r)-2e-5*Math.sin(r*i),s=Math.atan2(r,o)-3e-6*Math.cos(o*i),n=a*Math.cos(s),d=a*Math.sin(s);return[n,d]}function d(e,t){var i=Math.sqrt(e*e+t*t)+2e-5*Math.sin(t*o),r=Math.atan2(t,e)+3e-6*Math.cos(e*o),a=i*Math.cos(r)+.0065,s=i*Math.sin(r)+.006;return[a,s]}function c(e,t){if(f(e,t))return[e,t];var i=u(e-105,t-35),o=h(e-105,t-35),n=t/180*r,d=Math.sin(n);d=1-s*d*d;var c=Math.sqrt(d);i=180*i/(a*(1-s)/(d*c)*r),o=180*o/(a/c*Math.cos(n)*r);var l=t+i,p=e+o;return[p,l]}function l(e,t){if(f(e,t))return[e,t];var i=u(e-105,t-35),o=h(e-105,t-35),n=t/180*r,d=Math.sin(n);d=1-s*d*d;var c=Math.sqrt(d);return i=180*i/(a*(1-s)/(d*c)*r),o=180*o/(a/c*Math.cos(n)*r),mglat=t+i,mglng=e+o,[2*e-mglng,2*t-mglat]}function u(e,t){var i=2*e-100+3*t+.2*t*t+.1*e*t+.2*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*r)+20*Math.sin(2*e*r))/3,i+=2*(20*Math.sin(t*r)+40*Math.sin(t/3*r))/3,i+=2*(160*Math.sin(t/12*r)+320*Math.sin(t*r/30))/3,i}function h(e,t){var i=300+e+2*t+.1*e*e+.1*e*t+.1*Math.sqrt(Math.abs(e));return i+=2*(20*Math.sin(6*e*r)+20*Math.sin(2*e*r))/3,i+=2*(20*Math.sin(e*r)+40*Math.sin(e/3*r))/3,i+=2*(150*Math.sin(e/12*r)+300*Math.sin(e/30*r))/3,i}function f(e,t){return e<72.004||e>137.8347||t<.8293||t>55.8271||!1}var p={bd09togcj02:n,gcj02tobd09:d,wgs84togcj02:c,gcj02towgs84:l};t.default=p},"88a2":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"拼团专区"};t.lang=o},"893d":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"刮刮乐"};t.lang=o},"89c8":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的优惠券"};t.lang=o},"8ba7":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"提现记录"};t.lang=o},"8d34":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},"8feb":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"推广海报"};t.lang=o},"90fd":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},9176:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"物流信息"};t.lang=o},"927e":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"会员等级",defaultLevelTips:"您已经是最高级别的会员了！",tag:"专属标签",tagDesc:"标签达人",discount:"专享折扣",discountDesc:"专享{0}折",service:"优质服务",serviceDesc:"360度全方位",memberLevel:"会员等级",condition:"条件",equity:"权益",giftPackage:"升级礼包",levelExplain:"等级说明",upgradeTips:"升级会员，享专属权益"};t.lang=o},9374:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i("3926"));function r(e){return e&&e.__esModule?e:{default:e}}var a=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,s=/^<\/([-A-Za-z0-9_]+)[^>]*>/,n=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,d=m("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),c=m("a,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),l=m("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),u=m("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),h=m("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),f=m("script,style");function p(e,t){var i,o,r,p=[],m=e;p.last=function(){return this[this.length-1]};while(e){if(o=!0,p.last()&&f[p.last()])e=e.replace(new RegExp("([\\s\\S]*?)</"+p.last()+"[^>]*>"),(function(e,i){return i=i.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),t.chars&&t.chars(i),""})),y("",p.last());else if(0==e.indexOf("\x3c!--")?(i=e.indexOf("--\x3e"),i>=0&&(t.comment&&t.comment(e.substring(4,i)),e=e.substring(i+3),o=!1)):0==e.indexOf("</")?(r=e.match(s),r&&(e=e.substring(r[0].length),r[0].replace(s,y),o=!1)):0==e.indexOf("<")&&(r=e.match(a),r&&(e=e.substring(r[0].length),r[0].replace(a,g),o=!1)),o){i=e.indexOf("<");var _=i<0?e:e.substring(0,i);e=i<0?"":e.substring(i),t.chars&&t.chars(_)}if(e==m)throw"Parse Error: "+e;m=e}function g(e,i,o,r){if(i=i.toLowerCase(),c[i])while(p.last()&&l[p.last()])y("",p.last());if(u[i]&&p.last()==i&&y("",i),r=d[i]||!!r,r||p.push(i),t.start){var a=[];o.replace(n,(function(e,t){var i=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:h[t]?t:"";a.push({name:t,value:i,escaped:i.replace(/(^|[^\\])"/g,'$1\\"')})})),t.start&&t.start(i,a,r)}}function y(e,i){if(i){for(o=p.length-1;o>=0;o--)if(p[o]==i)break}else var o=0;if(o>=0){for(var r=p.length-1;r>=o;r--)t.end&&t.end(p[r]);p.length=o}}y()}function m(e){for(var t={},i=e.split(","),o=0;o<i.length;o++)t[i[o]]=!0;return t}function _(e){return e.replace(/<\?xml.*\?>\n/,"").replace(/<!doctype.*>\n/,"").replace(/<!DOCTYPE.*>\n/,"")}function g(e){e=e.replace(/<!--[\s\S]*-->/gi,"");return e}function y(e){e=e.replace(/\\/g,"").replace(/<img/g,'<img style="width:100% !important;display:block;"');return e=e.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi,(function(e,t){return'<img style="width:100% !important;display:block;" src="'+o.default.img(t)+'"/>'})),e}function v(e){e=e.replace(/style\s*=\s*["][^>]*;[^"]?/gi,(function(e,t){return e=e.replace(/[:](\s?)[\s\S]*/gi,(function(e,t){return e.replace(/"/g,"'")})),e}));return e}function b(e){return e.reduce((function(e,t){var i=t.value,o=t.name;return e[o]?e[o]=e[o]+" "+i:e[o]=i,e}),{})}function D(e){e=_(e),e=g(e),e=y(e),e=v(e);var t=[],i={node:"root",children:[]};return p(e,{start:function(e,o,r){var a={name:e};if(0!==o.length&&(a.attrs=b(o)),r){var s=t[0]||i;s.children||(s.children=[]),s.children.push(a)}else t.unshift(a)},end:function(e){var o=t.shift();if(o.name!==e&&console.error("invalid state: mismatch end tag"),0===t.length)i.children.push(o);else{var r=t[0];r.children||(r.children=[]),r.children.push(o)}},chars:function(e){var o={type:"text",text:e};if(0===t.length)i.children.push(o);else{var r=t[0];r.children||(r.children=[]),r.children.push(o)}},comment:function(e){var i={node:"comment",text:e},o=t[0];o.children||(o.children=[]),o.children.push(i)}}),i.children}var S=D;t.default=S},9446:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{orderId:null,orderNo:"",memberName:"",memberNeadimg:"",isAnonymous:1,goodsList:[],goodsEvalList:[],imgList:[],isEvaluate:0,flag:!1,evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1}}},methods:{getUserInfo:function(){var e=this;this.$api.sendRequest({url:"/api/member/info",success:function(t){0==t.code?(e.memberName=t.data.nickname,e.memberNeadimg=t.data.headimg):e.$util.showToast({title:t.message})}})},getOrderInfo:function(){var e=this,t={order_id:this.orderId};this.$api.sendRequest({url:"/api/order/evluateinfo",data:t,success:function(t){if(0==t.code)if(e.isEvaluate=t.data.evaluate_status,e.orderNo=t.data.list[0].order_no,e.goodsList=t.data.list,e.isEvaluate)for(var i=0;i<t.data.list.length;i++){var o=[];e.imgList.push(o),e.goodsEvalList.push({order_goods_id:t.data.list[i].order_goods_id,goods_id:t.data.list[i].goods_id,sku_id:t.data.list[i].sku_id,again_content:"",again_images:""})}else for(var r=0;r<t.data.list.length;r++){var a=[];e.imgList.push(a),e.goodsEvalList.push({content:"",images:"",scores:5,explain_type:1,order_goods_id:t.data.list[r].order_goods_id,goods_id:t.data.list[r].goods_id,sku_id:t.data.list[r].sku_id,sku_name:t.data.list[r].sku_name,sku_price:t.data.list[r].price,sku_image:t.data.list[r].sku_image})}else e.$util.showToast({title:"未获取到订单数据"}),setTimeout((function(){e.$util.redirectTo("/pages/order/list/list",{},"redirectTo")}),1e3);e.$refs.loadingCover&&e.$refs.loadingCover.hide()},fail:function(){this.$refs.loadingCover&&this.$refs.loadingCover.hide()}})},setStar:function(e){this.goodsEvalList[e.index].scores=e.value,e.value>=4?this.goodsEvalList[e.index].explain_type=1:1<e.value&&e.value<4?this.goodsEvalList[e.index].explain_type=2:this.goodsEvalList[e.index].explain_type=3},isAll:function(){this.isAnonymous?this.isAnonymous=0:this.isAnonymous=1},addImg:function(e){var t=this,i=this.imgList[e].length?this.imgList[e].length:0;this.$util.upload(6-i,{path:"evaluateimg"},(function(i){var o=t.imgList[e];o=o.concat(i),t.imgList[e]=[],t.$set(t.imgList,e,o),t.isEvaluate?t.goodsEvalList[e].again_images=t.imgList[e].toString():t.goodsEvalList[e].images=t.imgList[e].toString()}))},deleteImg:function(e,t,i){this.imgList[t].splice(i,1),this.isEvaluate?this.goodsEvalList[t].again_images=this.imgList[t].toString():this.goodsEvalList[t].images=this.imgList[t].toString()},preview:function(t,i){for(var o=this.imgList[i],r=0;r<o.length;r++)o[r]=this.$util.img(o[r]);e.previewImage({urls:o,current:t})},save:function(){var e=this;if(0!=this.evaluateConfig.evaluate_status){for(var t=0;t<this.goodsEvalList.length;t++)if(this.isEvaluate&&!this.goodsEvalList[t].again_content.trim().length)return void this.$util.showToast({title:"商品的评价不能为空哦"});var i=JSON.stringify(this.goodsEvalList),o={order_id:this.orderId,goods_evaluate:i};this.isEvaluate||(o.order_no=this.orderNo,o.member_name=this.memberName,o.member_headimg=this.memberNeadimg,o.is_anonymous=this.isAnonymous),this.flag||(this.flag=!0,this.$api.sendRequest({url:this.isEvaluate?"/api/goodsevaluate/again":"/api/goodsevaluate/add",data:o,success:function(t){0==t.code?(e.$util.showToast({title:"评价成功"}),setTimeout((function(){e.$util.redirectTo("/pages/order/list/list",{},"redirectTo")}),1e3)):(e.$util.showToast({title:t.message}),e.flag=!1)},fail:function(t){e.flag=!1}}))}else this.$util.showToast({title:"商家未开启商品评价功能"})},imageError:function(e){this.goodsList[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i}}})}}};t.default=i}).call(this,i("543d")["default"])},"94d5":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},"94ea":function(e,t,i){function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}!function(t,i){e.exports=i(t)}(window,(function(e,t){function i(t,i,o){e.WeixinJSBridge?WeixinJSBridge.invoke(t,a(i),(function(e){n(t,e,o)})):c(t,o)}function r(t,i,o){e.WeixinJSBridge?WeixinJSBridge.on(t,(function(e){o&&o.trigger&&o.trigger(e),n(t,e,i)})):c(t,o||i)}function a(e){return(e=e||{}).appId=w.appId,e.verifyAppId=w.appId,e.verifySignType="sha1",e.verifyTimestamp=w.timestamp+"",e.verifyNonceStr=w.nonceStr,e.verifySignature=w.signature,e}function s(e){return{timeStamp:e.timestamp+"",nonceStr:e.nonceStr,package:e.package,paySign:e.paySign,signType:e.signType||"SHA1"}}function n(e,t,i){"openEnterpriseChat"==e&&(t.errCode=t.err_code),delete t.err_code,delete t.err_desc,delete t.err_detail;var o=t.errMsg;o||(o=t.err_msg,delete t.err_msg,o=function(e,t){var i=e,o=p[i];o&&(i=o);var r="ok";if(t){var a=t.indexOf(":");"confirm"==(r=t.substring(a+1))&&(r="ok"),"failed"==r&&(r="fail"),-1!=r.indexOf("failed_")&&(r=r.substring(7)),-1!=r.indexOf("fail_")&&(r=r.substring(5)),"access denied"!=(r=(r=r.replace(/_/g," ")).toLowerCase())&&"no permission to execute"!=r||(r="permission denied"),"config"==i&&"function not exist"==r&&(r="ok"),""==r&&(r="fail")}return i+":"+r}(e,o),t.errMsg=o),(i=i||{})._complete&&(i._complete(t),delete i._complete),o=t.errMsg||"",w.debug&&!i.isInnerInvoke&&alert(JSON.stringify(t));var r=o.indexOf(":");switch(o.substring(r+1)){case"ok":i.success&&i.success(t);break;case"cancel":i.cancel&&i.cancel(t);break;default:i.fail&&i.fail(t)}i.complete&&i.complete(t)}function d(e){if(e){for(var t=0,i=e.length;t<i;++t){var o=e[t],r=f[o];r&&(e[t]=r)}return e}}function c(e,t){if(!(!w.debug||t&&t.isInnerInvoke)){var i=p[e];i&&(e=i),t&&t._complete&&delete t._complete,console.log('"'+e+'",',t||"")}}function l(){return(new Date).getTime()}function u(t){D&&(e.WeixinJSBridge?t():m.addEventListener&&m.addEventListener("WeixinJSBridgeReady",t,!1))}if(!e.jWeixin){var h,f={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},p=function(){var e={};for(var t in f)e[f[t]]=t;return e}(),m=e.document,_=m.title,g=navigator.userAgent.toLowerCase(),y=navigator.platform.toLowerCase(),v=!(!y.match("mac")&&!y.match("win")),b=-1!=g.indexOf("wxdebugger"),D=-1!=g.indexOf("micromessenger"),S=-1!=g.indexOf("android"),k=-1!=g.indexOf("iphone")||-1!=g.indexOf("ipad"),C=(M=g.match(/micromessenger\/(\d+\.\d+\.\d+)/)||g.match(/micromessenger\/(\d+\.\d+)/))?M[1]:"",P={initStartTime:l(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},$={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:k?1:S?2:-1,clientVersion:C,url:encodeURIComponent(location.href)},w={},I={_completes:[]},T={state:0,data:{}};u((function(){P.initEndTime=l()}));var x=!1,O=[],E=(h={config:function(t){c("config",w=t);var o=!1!==w.check;u((function(){if(o)i(f.config,{verifyJsApiList:d(w.jsApiList)},function(){I._complete=function(e){P.preVerifyEndTime=l(),T.state=1,T.data=e},I.success=function(e){$.isPreVerifyOk=0},I.fail=function(e){I._fail?I._fail(e):T.state=-1};var e=I._completes;return e.push((function(){!function(e){if(!(v||b||w.debug||C<"6.0.2"||$.systemType<0)){var t=new Image;$.appId=w.appId,$.initTime=P.initEndTime-P.initStartTime,$.preVerifyTime=P.preVerifyEndTime-P.preVerifyStartTime,E.getNetworkType({isInnerInvoke:!0,success:function(e){$.networkType=e.networkType;var i="https://open.weixin.qq.com/sdk/report?v="+$.version+"&o="+$.isPreVerifyOk+"&s="+$.systemType+"&c="+$.clientVersion+"&a="+$.appId+"&n="+$.networkType+"&i="+$.initTime+"&p="+$.preVerifyTime+"&u="+$.url;t.src=i}})}}()})),I.complete=function(t){for(var i=0,o=e.length;i<o;++i)e[i]();I._completes=[]},I}()),P.preVerifyStartTime=l();else{T.state=1;for(var e=I._completes,t=0,r=e.length;t<r;++t)e[t]();I._completes=[]}})),E.invoke||(E.invoke=function(t,i,o){e.WeixinJSBridge&&WeixinJSBridge.invoke(t,a(i),o)},E.on=function(t,i){e.WeixinJSBridge&&WeixinJSBridge.on(t,i)})},ready:function(e){0!=T.state?e():(I._completes.push(e),!D&&w.debug&&e())},error:function(e){C<"6.0.2"||(-1==T.state?e(T.data):I._fail=e)},checkJsApi:function(e){i("checkJsApi",{jsApiList:d(e.jsApiList)},(e._complete=function(e){if(S){var t=e.checkResult;t&&(e.checkResult=JSON.parse(t))}e=function(e){var t=e.checkResult;for(var i in t){var o=p[i];o&&(t[o]=t[i],delete t[i])}return e}(e)},e))},onMenuShareTimeline:function(e){r(f.onMenuShareTimeline,{complete:function(){i("shareTimeline",{title:e.title||_,desc:e.title||_,img_url:e.imgUrl||"",link:e.link||location.href,type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareAppMessage:function(e){r(f.onMenuShareAppMessage,{complete:function(t){"favorite"===t.scene?i("sendAppMessage",{title:e.title||_,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""}):i("sendAppMessage",{title:e.title||_,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareQQ:function(e){r(f.onMenuShareQQ,{complete:function(){i("shareQQ",{title:e.title||_,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareWeibo:function(e){r(f.onMenuShareWeibo,{complete:function(){i("shareWeiboApp",{title:e.title||_,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareQZone:function(e){r(f.onMenuShareQZone,{complete:function(){i("shareQZone",{title:e.title||_,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},updateTimelineShareData:function(e){i("updateTimelineShareData",{title:e.title,link:e.link,imgUrl:e.imgUrl},e)},updateAppMessageShareData:function(e){i("updateAppMessageShareData",{title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl},e)},startRecord:function(e){i("startRecord",{},e)},stopRecord:function(e){i("stopRecord",{},e)},onVoiceRecordEnd:function(e){r("onVoiceRecordEnd",e)},playVoice:function(e){i("playVoice",{localId:e.localId},e)},pauseVoice:function(e){i("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){i("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){r("onVoicePlayEnd",e)},uploadVoice:function(e){i("uploadVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadVoice:function(e){i("downloadVoice",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},translateVoice:function(e){i("translateVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},chooseImage:function(e){i("chooseImage",{scene:"1|2",count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if(S){var t=e.localIds;try{t&&(e.localIds=JSON.parse(t))}catch(e){}}},e))},getLocation:function(e){},previewImage:function(e){i(f.previewImage,{current:e.current,urls:e.urls},e)},uploadImage:function(e){i("uploadImage",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadImage:function(e){i("downloadImage",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},getLocalImgData:function(e){!1===x?(x=!0,i("getLocalImgData",{localId:e.localId},(e._complete=function(e){if(x=!1,0<O.length){var t=O.shift();wx.getLocalImgData(t)}},e))):O.push(e)},getNetworkType:function(e){i("getNetworkType",{},(e._complete=function(e){e=function(e){var t=e.errMsg;e.errMsg="getNetworkType:ok";var i=e.subtype;if(delete e.subtype,i)e.networkType=i;else{var o=t.indexOf(":"),r=t.substring(o+1);switch(r){case"wifi":case"edge":case"wwan":e.networkType=r;break;default:e.errMsg="getNetworkType:fail"}}return e}(e)},e))},openLocation:function(e){i("openLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name||"",address:e.address||"",scale:e.scale||28,infoUrl:e.infoUrl||""},e)}},o(h,"getLocation",(function(e){i(f.getLocation,{type:(e=e||{}).type||"wgs84"},(e._complete=function(e){delete e.type},e))})),o(h,"hideOptionMenu",(function(e){i("hideOptionMenu",{},e)})),o(h,"showOptionMenu",(function(e){i("showOptionMenu",{},e)})),o(h,"closeWindow",(function(e){i("closeWindow",{},e=e||{})})),o(h,"hideMenuItems",(function(e){i("hideMenuItems",{menuList:e.menuList},e)})),o(h,"showMenuItems",(function(e){i("showMenuItems",{menuList:e.menuList},e)})),o(h,"hideAllNonBaseMenuItem",(function(e){i("hideAllNonBaseMenuItem",{},e)})),o(h,"showAllNonBaseMenuItem",(function(e){i("showAllNonBaseMenuItem",{},e)})),o(h,"scanQRCode",(function(e){i("scanQRCode",{needResult:(e=e||{}).needResult||0,scanType:e.scanType||["qrCode","barCode"]},(e._complete=function(e){if(k){var t=e.resultStr;if(t){var i=JSON.parse(t);e.resultStr=i&&i.scan_code&&i.scan_code.scan_result}}},e))})),o(h,"openAddress",(function(e){i(f.openAddress,{},(e._complete=function(e){var t;(t=e).postalCode=t.addressPostalCode,delete t.addressPostalCode,t.provinceName=t.proviceFirstStageName,delete t.proviceFirstStageName,t.cityName=t.addressCitySecondStageName,delete t.addressCitySecondStageName,t.countryName=t.addressCountiesThirdStageName,delete t.addressCountiesThirdStageName,t.detailInfo=t.addressDetailInfo,delete t.addressDetailInfo,e=t},e))})),o(h,"openProductSpecificView",(function(e){i(f.openProductSpecificView,{pid:e.productId,view_type:e.viewType||0,ext_info:e.extInfo},e)})),o(h,"addCard",(function(e){for(var t=e.cardList,o=[],r=0,a=t.length;r<a;++r){var s=t[r],n={card_id:s.cardId,card_ext:s.cardExt};o.push(n)}i(f.addCard,{card_list:o},(e._complete=function(e){var t=e.card_list;if(t){for(var i=0,o=(t=JSON.parse(t)).length;i<o;++i){var r=t[i];r.cardId=r.card_id,r.cardExt=r.card_ext,r.isSuccess=!!r.is_succ,delete r.card_id,delete r.card_ext,delete r.is_succ}e.cardList=t,delete e.card_list}},e))})),o(h,"chooseCard",(function(e){i("chooseCard",{app_id:w.appId,location_id:e.shopId||"",sign_type:e.signType||"SHA1",card_id:e.cardId||"",card_type:e.cardType||"",card_sign:e.cardSign,time_stamp:e.timestamp+"",nonce_str:e.nonceStr},(e._complete=function(e){e.cardList=e.choose_card_info,delete e.choose_card_info},e))})),o(h,"openCard",(function(e){for(var t=e.cardList,o=[],r=0,a=t.length;r<a;++r){var s=t[r],n={card_id:s.cardId,code:s.code};o.push(n)}i(f.openCard,{card_list:o},e)})),o(h,"consumeAndShareCard",(function(e){i(f.consumeAndShareCard,{consumedCardId:e.cardId,consumedCode:e.code},e)})),o(h,"chooseWXPay",(function(e){i(f.chooseWXPay,s(e),e)})),o(h,"openEnterpriseRedPacket",(function(e){i(f.openEnterpriseRedPacket,s(e),e)})),o(h,"startSearchBeacons",(function(e){i(f.startSearchBeacons,{ticket:e.ticket},e)})),o(h,"stopSearchBeacons",(function(e){i(f.stopSearchBeacons,{},e)})),o(h,"onSearchBeacons",(function(e){r(f.onSearchBeacons,e)})),o(h,"openEnterpriseChat",(function(e){i("openEnterpriseChat",{useridlist:e.userIds,chatname:e.groupName},e)})),o(h,"launchMiniProgram",(function(e){i("launchMiniProgram",{targetAppId:e.targetAppId,path:function(e){if("string"==typeof e&&0<e.length){var t=e.split("?")[0],i=e.split("?")[1];return t+=".html",void 0!==i?t+"?"+i:t}}(e.path),envVersion:e.envVersion},e)})),o(h,"miniProgram",{navigateBack:function(e){e=e||{},u((function(){i("invokeMiniProgramAPI",{name:"navigateBack",arg:{delta:e.delta||1}},e)}))},navigateTo:function(e){u((function(){i("invokeMiniProgramAPI",{name:"navigateTo",arg:{url:e.url}},e)}))},redirectTo:function(e){u((function(){i("invokeMiniProgramAPI",{name:"redirectTo",arg:{url:e.url}},e)}))},switchTab:function(e){u((function(){i("invokeMiniProgramAPI",{name:"switchTab",arg:{url:e.url}},e)}))},reLaunch:function(e){u((function(){i("invokeMiniProgramAPI",{name:"reLaunch",arg:{url:e.url}},e)}))},postMessage:function(e){u((function(){i("invokeMiniProgramAPI",{name:"postMessage",arg:e.data||{}},e)}))},getEnv:function(t){u((function(){t({miniprogram:"miniprogram"===e.__wxjs_environment})}))}}),h),j=1,R={};return m.addEventListener("error",(function(e){if(!S){var t=e.target,i=t.tagName,o=t.src;if(("IMG"==i||"VIDEO"==i||"AUDIO"==i||"SOURCE"==i)&&-1!=o.indexOf("wxlocalresource://")){e.preventDefault(),e.stopPropagation();var r=t["wx-id"];if(r||(r=j++,t["wx-id"]=r),R[r])return;R[r]=!0,wx.ready((function(){wx.getLocalImgData({localId:o,success:function(e){t.src=e.localData}})}))}}}),!0),m.addEventListener("load",(function(e){if(!S){var t=e.target,i=t.tagName;if(t.src,"IMG"==i||"VIDEO"==i||"AUDIO"==i||"SOURCE"==i){var o=t["wx-id"];o&&(R[o]=!1)}}}),!0),t&&(e.wx=e.jWeixin=E),E}var M}))},9656:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},"96cf":function(e,t){!function(t){"use strict";var i,o=Object.prototype,r=o.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",n=a.asyncIterator||"@@asyncIterator",d=a.toStringTag||"@@toStringTag",c="object"===typeof e,l=t.regeneratorRuntime;if(l)c&&(e.exports=l);else{l=t.regeneratorRuntime=c?e.exports:{},l.wrap=b;var u="suspendedStart",h="suspendedYield",f="executing",p="completed",m={},_={};_[s]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(E([])));y&&y!==o&&r.call(y,s)&&(_=y);var v=C.prototype=S.prototype=Object.create(_);k.prototype=v.constructor=C,C.constructor=k,C[d]=k.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,d in e||(e[d]="GeneratorFunction")),e.prototype=Object.create(v),e},l.awrap=function(e){return{__await:e}},P($.prototype),$.prototype[n]=function(){return this},l.AsyncIterator=$,l.async=function(e,t,i,o){var r=new $(b(e,t,i,o));return l.isGeneratorFunction(t)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},P(v),v[d]="Generator",v[s]=function(){return this},v.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){while(t.length){var o=t.pop();if(o in e)return i.value=o,i.done=!1,i}return i.done=!0,i}},l.values=E,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=i)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(o,r){return n.type="throw",n.arg=e,t.next=o,r&&(t.method="next",t.arg=i),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],n=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var d=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(d&&c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(d){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),x(i),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var o=i.completion;if("throw"===o.type){var r=o.arg;x(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:E(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=i),m}}}function b(e,t,i,o){var r=t&&t.prototype instanceof S?t:S,a=Object.create(r.prototype),s=new O(o||[]);return a._invoke=w(e,i,s),a}function D(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(o){return{type:"throw",arg:o}}}function S(){}function k(){}function C(){}function P(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function $(e){function t(i,o,a,s){var n=D(e[i],e,o);if("throw"!==n.type){var d=n.arg,c=d.value;return c&&"object"===typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,a,s)}),(function(e){t("throw",e,a,s)})):Promise.resolve(c).then((function(e){d.value=e,a(d)}),(function(e){return t("throw",e,a,s)}))}s(n.arg)}var i;function o(e,o){function r(){return new Promise((function(i,r){t(e,o,i,r)}))}return i=i?i.then(r,r):r()}this._invoke=o}function w(e,t,i){var o=u;return function(r,a){if(o===f)throw new Error("Generator is already running");if(o===p){if("throw"===r)throw a;return j()}i.method=r,i.arg=a;while(1){var s=i.delegate;if(s){var n=I(s,i);if(n){if(n===m)continue;return n}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(o===u)throw o=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o=f;var d=D(e,t,i);if("normal"===d.type){if(o=i.done?p:h,d.arg===m)continue;return{value:d.arg,done:i.done}}"throw"===d.type&&(o=p,i.method="throw",i.arg=d.arg)}}}function I(e,t){var o=e.iterator[t.method];if(o===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=i,I(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=D(o,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=i),t.delegate=null,m):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function E(e){if(e){var t=e[s];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){while(++o<e.length)if(r.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=i,t.done=!0,t};return a.next=a}}return{next:j}}function j(){return{value:i,done:!0}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},9720:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"编辑账户",name:"姓名",namePlaceholder:"请输入真实姓名",mobilePhone:"手机号码",mobilePhonePlaceholder:"请输入手机号",accountType:"账号类型",bankInfo:"支行信息",bankInfoPlaceholder:"请输入支行信息",withdrawalAccount:"提现账号",withdrawalAccountPlaceholder:"请输入提现账号",save:"保存"};t.lang=o},"979c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的砍价"};t.lang=o},9915:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"店铺打烊"};t.lang=o},9961:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c"),a(i("a7e3"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{id:0,skuId:0,groupId:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},currentPintuan:{headimg:"",timeMachine:{}},openPopup:!1,memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:{},goodsCircle:!1,timestamp:"",evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},kefuConfig:{},isCommunity:!1,videoContext:"",source_member:0}},onLoad:function(t){var i=this;return n(o.default.mark((function r(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.id=t.id||0,i.skuId=t.sku_id||0,i.isIphoneX=i.$util.uniappIsIPhoneX(),t.source_member&&(e.setStorageSync("source_member",t.source_member),i.source_member=t.source_member),t.scene&&(a=decodeURIComponent(t.scene),a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(i.id=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))),i.getService(),o.next=8,i.getGoodsSkuDetail();case 8:case"end":return o.stop()}}),r)})))()},onShow:function(){this.$langConfig.refresh(),this.token=e.getStorageSync("token"),this.getKekuConfig(),this.modifyGoodsInfo(),this.getEvaluateConfig(),""!=this.token&&(this.getCartCount(),this.getMemberId()),this.getGoodsEvaluate(),this.videoContext=e.createVideoContext("goodsVideo"),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},onHide:function(){},methods:{onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},goConnect:function(){if(e.getStorageSync("token")){var t={sku_id:this.goodsSkuDetail.sku_id,type:"presale",type_id:this.id};return this.$util.redirectTo("/otherpages/chat/room/room",t),!1}this.source_member?this.$refs.login.open("/promotionpages/presale/detail/detail",{id:this.id,source_member:this.source_member}):this.$refs.login.open("/promotionpages/presale/detail/detail",{id:this.id})},getGoodsSkuDetail:function(){var e=this;return n(o.default.mark((function t(){var i,a,s,n,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/presale/api/goods/detail",async:!1,data:{id:e.id,sku_id:e.skuId}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,e.goodsSkuDetail.purchased_num=e.goodsSkuDetail.purchased_num?e.goodsSkuDetail.purchased_num:0,e.skuId=e.goodsSkuDetail.sku_id,e.goodsSkuDetail.group_id=e.groupId,e.goodsSkuDetail.end_time-i.timestamp>0?e.goodsSkuDetail.timeMachine=e.$util.countDown(e.goodsSkuDetail.end_time-i.timestamp):(e.$util.showToast({title:"活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.show_price=e.goodsSkuDetail.goods_price,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(s=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(e.goodsSkuDetail.goods_attr_format,"attr_id"),n=0;n<e.goodsSkuDetail.goods_attr_format.length;n++)for(d=0;d<s.length;d++)e.goodsSkuDetail.goods_attr_format[n].attr_id==s[d].attr_id&&e.goodsSkuDetail.goods_attr_format[n].attr_value_id!=s[d].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[n].attr_value_name+="、"+s[d].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/presale/detail/detail?id="+e.id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},""!=e.token&&e.getWhetherCollection(),e.setWechatShare(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},presale:function(){var t=this;e.getStorageSync("token")?this.$refs.goodsSku.show("presale",(function(){t.getCartCount()})):this.source_member?this.$refs.login.open("/promotionpages/presale/detail/detail?id="+this.id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/presale/detail/detail?id="+this.id)},toOrderDetail:function(){this.$util.redirectTo("/promotionpages/presale/order_list/order_list")},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.images&&(e.goodsEvaluate.images=e.goodsEvaluate.images.split(",")),1==e.goodsEvaluate.is_anonymous&&(e.goodsEvaluate.member_name=e.goodsEvaluate.member_name.replace(e.goodsEvaluate.member_name.substring(1,e.goodsEvaluate.member_name.length-1),"***")))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;""!=this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.source_member?this.$refs.login.open("/promotionpages/presale/detail/detail?id="+this.id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/presale/detail/detail?id="+this.id)},getCartCount:function(){var e=this;this.$api.sendRequest({url:"/api/cart/count",data:{},success:function(t){e.cartCount=t.data}})},goTopClick:function(){e.pageScrollTo({duration:200,scrollTop:0})},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));t.token,t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={id:this.id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/presale/api/goods/poster",data:{page:"/promotionpages/presale/detail/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path:e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})},fail:function(e){}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/presale/detail/detail?id="+this.id;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})}}};t.default=d}).call(this,i("543d")["default"])},"999d":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{groupbuy_id:0,skuId:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:{},goodsCircle:!1,evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},kefuConfig:{},isCommunity:!1,videoContext:"",source_member:0}},onLoad:function(t){var i=this;return n(o.default.mark((function r(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.groupbuy_id=t.groupbuy_id||0,t.id&&(i.groupbuy_id=t.id),i.skuId=t.sku_id||0,t.source_member&&(i.source_member=t.source_member),i.isIphoneX=i.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene&&(a=decodeURIComponent(t.scene),a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(i.groupbuy_id=t.split("-")[1]),-1!=t.indexOf("sku_id")&&(i.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))),i.getService(),o.next=10,i.getGoodsSkuDetail();case 10:i.getEvaluateConfig();case 11:case"end":return o.stop()}}),r)})))()},onShow:function(){this.$langConfig.refresh(),this.token=e.getStorageSync("token"),""!=this.token&&(this.getCartCount(),this.getMemberId()),this.getKekuConfig(),this.modifyGoodsInfo(),this.videoContext=e.createVideoContext("goodsVideo"),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},methods:{goConnect:function(){if(e.getStorageSync("token")){var t={sku_id:this.goodsSkuDetail.sku_id,type:"groupbuy",type_id:this.goodsSkuDetail.groupbuy_id};return this.$util.redirectTo("/otherpages/chat/room/room",t),!1}this.source_member?this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id+"&source_member="+this.source_member):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id)},getGoodsSkuDetail:function(){var e=this;return n(o.default.mark((function t(){var i,a,s,n,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/groupbuy/api/goods/detail",async:!1,data:{groupbuy_id:e.groupbuy_id}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,0==e.skuId&&(e.skuId=e.goodsSkuDetail.sku_id),e.goodsSkuDetail.end_time-i.timestamp>0?e.goodsSkuDetail.timeMachine=e.$util.countDown(e.goodsSkuDetail.end_time-i.timestamp):(e.$util.showToast({title:"活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.show_price=e.goodsSkuDetail.groupbuy_price,e.goodsSkuDetail.save_price=e.goodsSkuDetail.price-e.goodsSkuDetail.show_price>0?(e.goodsSkuDetail.price-e.goodsSkuDetail.show_price).toFixed(2):0,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(s=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(s,"attr_id"),n=0;n<e.goodsSkuDetail.goods_attr_format.length;n++)for(d=0;d<s.length;d++)e.goodsSkuDetail.goods_attr_format[n].attr_id==s[d].attr_id&&e.goodsSkuDetail.goods_attr_format[n].attr_value_id!=s[d].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[n].attr_value_name+="、"+s[d].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/groupbuy/detail/detail?groupbuy_id="+e.groupbuy_id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},""!=e.token&&e.getWhetherCollection(),e.setWechatShare(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},groupbuy:function(){var t=this;e.getStorageSync("token")?this.$refs.goodsSku.show("groupbuy",(function(){t.getCartCount()})):this.source_member?this.$refs.login.open("/promotionpages/groupbuy/detail/detail?groupbuy_id="+this.groupbuy_id+"&sku_id="+this.skuId+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/groupbuy/detail/detail?groupbuy_id="+this.groupbuy_id+"&sku_id="+this.skuId)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.forEach((function(t,i){e.goodsEvaluate[i].images&&(e.goodsEvaluate[i].images=e.goodsEvaluate[i].images.split(",")),1==e.goodsEvaluate[i].is_anonymous&&(e.goodsEvaluate[i].member_name=e.goodsEvaluate[i].member_name.replace(e.goodsEvaluate[i].member_name.substring(1,e.goodsEvaluate[i].member_name.length-1),"***"))})))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.source_member?this.$refs.login.open("/promotionpages/groupbuy/detail/detail?groupbuy_id="+this.groupbuy_id+"&sku_id="+this.skuId+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/groupbuy/detail/detail?groupbuy_id="+this.groupbuy_id+"&sku_id="+this.skuId)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));""!=t.token?t.posterHeight=parseInt(1240/o):t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={groupbuy_id:this.groupbuy_id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/groupbuy/api/goods/poster",data:{page:"/promotionpages/groupbuy/detail/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/groupbuy/detail/detail?groupbuy_id="+this.groupbuy_id;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toEvaluateDetail:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++)for(var a=i[r].children,s=0;s<a.length;s++)a[s].attrs&&a[s].attrs.src&&o.push(a[s].attrs.src);e.previewImage({current:o,urls:o})}}};t.default=d}).call(this,i("543d")["default"])},"9bae":function(e,t,i){"use strict";(function(e){function i(e,t){var i=this;i.version="1.2.3",i.options=e||{},i.isScrollBody=t||!1,i.isDownScrolling=!1,i.isUpScrolling=!1;var o=i.options.down&&i.options.down.callback;i.initDownScroll(),i.initUpScroll(),setTimeout((function(){i.optDown.use&&i.optDown.auto&&o&&(i.optDown.autoShowLoading?i.triggerDownScroll():i.optDown.callback&&i.optDown.callback(i)),setTimeout((function(){i.optUp.use&&i.optUp.auto&&!i.isUpAutoLoad&&i.triggerUpScroll()}),100)}),30)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i,i.prototype.extendDownScroll=function(e){i.extend(e,{use:!0,auto:!0,native:!1,autoShowLoading:!1,isLock:!1,offset:80,startTop:100,fps:80,inOffsetRate:1,outOffsetRate:.2,bottomOffset:20,minAngle:45,textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",inited:null,inOffset:null,outOffset:null,onMoving:null,beforeLoading:null,showLoading:null,afterLoading:null,endDownScroll:null,callback:function(e){e.resetUpScroll()}})},i.prototype.extendUpScroll=function(e){i.extend(e,{use:!0,auto:!0,isLock:!1,isBoth:!0,isBounce:!1,callback:null,page:{num:0,size:10,time:null},noMoreSize:5,offset:80,textLoading:"加载中 ...",textNoMore:"-- END --",inited:null,showLoading:null,showNoMore:null,hideUpScroll:null,errDistance:60,toTop:{src:null,offset:1e3,duration:300,btnClick:null,onShow:null,zIndex:9990,left:null,right:20,bottom:120,safearea:!1,width:72,radius:"50%"},empty:{use:!0,icon:null,tip:"~ 暂无相关数据 ~",btnText:"",btnClick:null,onShow:null,fixed:!1,top:"100rpx",zIndex:99},onScroll:!1})},i.extend=function(e,t){if(!e)return t;for(var o in t)if(null==e[o]){var r=t[o];e[o]=null!=r&&"object"===typeof r?i.extend({},r):r}else"object"===typeof e[o]&&i.extend(e[o],t[o]);return e},i.prototype.initDownScroll=function(){var e=this;e.optDown=e.options.down||{},e.extendDownScroll(e.optDown),e.isScrollBody&&e.optDown.native?e.optDown.use=!1:e.optDown.native=!1,e.downHight=0,e.optDown.use&&e.optDown.inited&&setTimeout((function(){e.optDown.inited(e)}),0)},i.prototype.touchstartEvent=function(e){this.optDown.use&&(this.startPoint=this.getPoint(e),this.startTop=this.getScrollTop(),this.lastPoint=this.startPoint,this.maxTouchmoveY=this.getBodyHeight()-this.optDown.bottomOffset,this.inTouchend=!1)},i.prototype.touchmoveEvent=function(e){if(this.optDown.use&&this.startPoint){var t=this,i=(new Date).getTime();if(!(t.moveTime&&i-t.moveTime<t.moveTimeDiff)){t.moveTime=i,t.moveTimeDiff||(t.moveTimeDiff=1e3/t.optDown.fps);var o=t.getScrollTop(),r=t.getPoint(e),a=r.y-t.startPoint.y;if(a>0&&(t.isScrollBody&&o<=0||!t.isScrollBody&&(o<=0||o<=t.optDown.startTop&&o===t.startTop))&&!t.inTouchend&&!t.isDownScrolling&&!t.optDown.isLock&&(!t.isUpScrolling||t.isUpScrolling&&t.optUp.isBoth)){var s=t.getAngle(t.lastPoint,r);if(s<t.optDown.minAngle)return;if(t.maxTouchmoveY>0&&r.y>=t.maxTouchmoveY)return t.inTouchend=!0,void t.touchendEvent();t.preventDefault(e);var n=r.y-t.lastPoint.y;t.downHight<t.optDown.offset?(1!==t.movetype&&(t.movetype=1,t.optDown.inOffset&&t.optDown.inOffset(t),t.isMoveDown=!0),t.downHight+=n*t.optDown.inOffsetRate):(2!==t.movetype&&(t.movetype=2,t.optDown.outOffset&&t.optDown.outOffset(t),t.isMoveDown=!0),t.downHight+=n>0?Math.round(n*t.optDown.outOffsetRate):n);var d=t.downHight/t.optDown.offset;t.optDown.onMoving&&t.optDown.onMoving(t,d,t.downHight)}t.lastPoint=r}}},i.prototype.touchendEvent=function(e){if(this.optDown.use)if(this.isMoveDown)this.downHight>=this.optDown.offset?this.triggerDownScroll():(this.downHight=0,this.optDown.endDownScroll&&this.optDown.endDownScroll(this)),this.movetype=0,this.isMoveDown=!1;else if(!this.isScrollBody&&this.getScrollTop()===this.startTop){var t=this.getPoint(e).y-this.startPoint.y<0;if(t){var i=this.getAngle(this.getPoint(e),this.startPoint);i>80&&this.triggerUpScroll(!0)}}},i.prototype.getPoint=function(e){return e?e.touches&&e.touches[0]?{x:e.touches[0].pageX,y:e.touches[0].pageY}:e.changedTouches&&e.changedTouches[0]?{x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}:{x:e.clientX,y:e.clientY}:{x:0,y:0}},i.prototype.getAngle=function(e,t){var i=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y),r=Math.sqrt(i*i+o*o),a=0;return 0!==r&&(a=Math.asin(o/r)/Math.PI*180),a},i.prototype.triggerDownScroll=function(){this.optDown.beforeLoading&&this.optDown.beforeLoading(this)||(this.showDownScroll(),this.optDown.callback&&this.optDown.callback(this))},i.prototype.showDownScroll=function(){this.isDownScrolling=!0,this.optDown.native?(e.startPullDownRefresh(),this.optDown.showLoading&&this.optDown.showLoading(this,0)):(this.downHight=this.optDown.offset,this.optDown.showLoading&&this.optDown.showLoading(this,this.downHight))},i.prototype.onPullDownRefresh=function(){this.isDownScrolling=!0,this.optDown.showLoading&&this.optDown.showLoading(this,0),this.optDown.callback&&this.optDown.callback(this)},i.prototype.endDownScroll=function(){if(this.optDown.native)return this.isDownScrolling=!1,this.optDown.endDownScroll&&this.optDown.endDownScroll(this),void e.stopPullDownRefresh();var t=this,i=function(){t.downHight=0,t.isDownScrolling=!1,t.optDown.endDownScroll&&t.optDown.endDownScroll(t),!t.isScrollBody&&t.setScrollHeight(0)},o=0;t.optDown.afterLoading&&(o=t.optDown.afterLoading(t)),"number"===typeof o&&o>0?setTimeout(i,o):i()},i.prototype.lockDownScroll=function(e){null==e&&(e=!0),this.optDown.isLock=e},i.prototype.lockUpScroll=function(e){null==e&&(e=!0),this.optUp.isLock=e},i.prototype.initUpScroll=function(){var e=this;e.optUp=e.options.up||{use:!1},e.extendUpScroll(e.optUp),e.optUp.isBounce||e.setBounce(!1),!1!==e.optUp.use&&(e.optUp.hasNext=!0,e.startNum=e.optUp.page.num+1,e.optUp.inited&&setTimeout((function(){e.optUp.inited(e)}),0))},i.prototype.onReachBottom=function(){this.isScrollBody&&!this.isUpScrolling&&!this.optUp.isLock&&this.optUp.hasNext&&this.triggerUpScroll()},i.prototype.onPageScroll=function(e){this.isScrollBody&&(this.setScrollTop(e.scrollTop),e.scrollTop>=this.optUp.toTop.offset?this.showTopBtn():this.hideTopBtn())},i.prototype.scroll=function(e,t){this.setScrollTop(e.scrollTop),this.setScrollHeight(e.scrollHeight),null==this.preScrollY&&(this.preScrollY=0),this.isScrollUp=e.scrollTop-this.preScrollY>0,this.preScrollY=e.scrollTop,this.isScrollUp&&this.triggerUpScroll(!0),e.scrollTop>=this.optUp.toTop.offset?this.showTopBtn():this.hideTopBtn(),this.optUp.onScroll&&t&&t()},i.prototype.triggerUpScroll=function(e){if(!this.isUpScrolling&&this.optUp.use&&this.optUp.callback){if(!0===e){var t=!1;if(!this.optUp.hasNext||this.optUp.isLock||this.isDownScrolling||this.getScrollBottom()<=this.optUp.offset&&(t=!0),!1===t)return}this.showUpScroll(),this.optUp.page.num++,this.isUpAutoLoad=!0,this.num=this.optUp.page.num,this.size=this.optUp.page.size,this.time=this.optUp.page.time,this.optUp.callback(this)}},i.prototype.showUpScroll=function(){this.isUpScrolling=!0,this.optUp.showLoading&&this.optUp.showLoading(this)},i.prototype.showNoMore=function(){this.optUp.hasNext=!1,this.optUp.showNoMore&&this.optUp.showNoMore(this)},i.prototype.hideUpScroll=function(){this.optUp.hideUpScroll&&this.optUp.hideUpScroll(this)},i.prototype.endUpScroll=function(e){null!=e&&(e?this.showNoMore():this.hideUpScroll()),this.isUpScrolling=!1},i.prototype.resetUpScroll=function(e){if(this.optUp&&this.optUp.use){var t=this.optUp.page;this.prePageNum=t.num,this.prePageTime=t.time,t.num=this.startNum,t.time=null,this.isDownScrolling||!1===e||(null==e?(this.removeEmpty(),this.showUpScroll()):this.showDownScroll()),this.isUpAutoLoad=!0,this.num=t.num,this.size=t.size,this.time=t.time,this.optUp.callback&&this.optUp.callback(this)}},i.prototype.setPageNum=function(e){this.optUp.page.num=e-1},i.prototype.setPageSize=function(e){this.optUp.page.size=e},i.prototype.endByPage=function(e,t,i){var o;this.optUp.use&&null!=t&&(o=this.optUp.page.num<t),this.endSuccess(e,o,i)},i.prototype.endBySize=function(e,t,i){var o;if(this.optUp.use&&null!=t){var r=(this.optUp.page.num-1)*this.optUp.page.size+e;o=r<t}this.endSuccess(e,o,i)},i.prototype.endSuccess=function(e,t,i){var o=this;if(o.isDownScrolling&&o.endDownScroll(),o.optUp.use){var r;if(null!=e){var a=o.optUp.page.num,s=o.optUp.page.size;if(1===a&&i&&(o.optUp.page.time=i),e<s||!1===t)if(o.optUp.hasNext=!1,0===e&&1===a)r=!1,o.showEmpty();else{var n=(a-1)*s+e;r=!(n<o.optUp.noMoreSize),o.removeEmpty()}else r=!1,o.optUp.hasNext=!0,o.removeEmpty()}o.endUpScroll(r)}},i.prototype.endErr=function(e){if(this.isDownScrolling){var t=this.optUp.page;t&&this.prePageNum&&(t.num=this.prePageNum,t.time=this.prePageTime),this.endDownScroll()}this.isUpScrolling&&(this.optUp.page.num--,this.endUpScroll(!1),this.isScrollBody&&0!==e&&(e||(e=this.optUp.errDistance),this.scrollTo(this.getScrollTop()-e,0)))},i.prototype.showEmpty=function(){this.optUp.empty.use&&this.optUp.empty.onShow&&this.optUp.empty.onShow(!0)},i.prototype.removeEmpty=function(){this.optUp.empty.use&&this.optUp.empty.onShow&&this.optUp.empty.onShow(!1)},i.prototype.showTopBtn=function(){this.topBtnShow||(this.topBtnShow=!0,this.optUp.toTop.onShow&&this.optUp.toTop.onShow(!0))},i.prototype.hideTopBtn=function(){this.topBtnShow&&(this.topBtnShow=!1,this.optUp.toTop.onShow&&this.optUp.toTop.onShow(!1))},i.prototype.getScrollTop=function(){return this.scrollTop||0},i.prototype.setScrollTop=function(e){this.scrollTop=e},i.prototype.scrollTo=function(e,t){this.myScrollTo&&this.myScrollTo(e,t)},i.prototype.resetScrollTo=function(e){this.myScrollTo=e},i.prototype.getScrollBottom=function(){return this.getScrollHeight()-this.getClientHeight()-this.getScrollTop()},i.prototype.getStep=function(e,t,i,o,r){var a=t-e;if(0!==o&&0!==a){o=o||300,r=r||30;var s=o/r,n=a/s,d=0,c=setInterval((function(){d<s-1?(e+=n,i&&i(e,c),d++):(i&&i(t,c),clearInterval(c))}),r)}else i&&i(t)},i.prototype.getClientHeight=function(e){var t=this.clientHeight||0;return 0===t&&!0!==e&&(t=this.getBodyHeight()),t},i.prototype.setClientHeight=function(e){this.clientHeight=e},i.prototype.getScrollHeight=function(){return this.scrollHeight||0},i.prototype.setScrollHeight=function(e){this.scrollHeight=e},i.prototype.getBodyHeight=function(){return this.bodyHeight||0},i.prototype.setBodyHeight=function(e){this.bodyHeight=e},i.prototype.preventDefault=function(e){e&&e.cancelable&&!e.defaultPrevented&&e.preventDefault()},i.prototype.setBounce=function(e){}}).call(this,i("543d")["default"])},"9ced":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},groupbuy_info:{name:""},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/groupbuy/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("groupbuyOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/groupbuy/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);for(var i=0;i<this.orderPaymentData.shop_goods_list.goods_list.length;i++)this.orderPaymentData.shop_goods_list.goods_list[i].goods_image=this.orderPaymentData.shop_goods_list.goods_list[i].goods_image?this.orderPaymentData.shop_goods_list.goods_list[i].goods_image.split(",")[0]:"";var o=this.orderPaymentData;if(void 0!=o.shop_goods_list.express_type&&void 0!=o.shop_goods_list.express_type[0]){var r=o.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var a=e.getStorageSync("delivery");if(a){var s=a.name,n=a.title;"store"==s&&(o.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""})}else{s=r[0].name;"store"==s&&(this.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""});n=r[0].title}this.orderCreateData.delivery.delivery_type=s,this.orderCreateData.delivery.delivery_type_name=n,"store"==r[0].name&&this.storeSelected(r[0])}if(void 0!=o.shop_goods_list.coupon_list&&void 0!=o.shop_goods_list.coupon_list[0]){var d=o.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=d[0].coupon_id,this.orderCreateData.coupon.coupon_money=d[0].money}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=o.member_account.mobile?o.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var c=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;c.length&&(this.orderCreateData.invoice_content=c[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;var l=this.orderPaymentData.shop_goods_list.local_config.info.time_week,u=!1;for(i=0;i<l.length;i++)if(i+1<l.length){var h=l[i+1]-l[i];if(h>1){u=!0;break}}var f=["周日","周一","周二","周三","周四","周五","周六"];if(u){var p=[];for(i=0;i<l.length;i++)p.push(f[l[i]]);this.deliveryWeek=p.join("、")}else this.deliveryWeek=f[l[0]]+"至"+f[l[l.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var m=(new Date).getHours().toString(),_=(new Date).getMinutes().toString();1==m.length&&(m="0"+m),1==_.length&&(_="0"+_),this.orderCreateData.buyer_ask_delivery_time=m+":"+_;var g=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(g);var y=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(y);var v=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),b=v.getHours(),D=v.getMinutes(),S=parseInt(this.timeInfo.start_time.split(":")[0]),k=parseInt(this.timeInfo.start_time.split(":")[1]),C=parseInt(this.timeInfo.end_time.split(":")[0]),P=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(S==C&&k==P||((b<S||b==S&&D<k)&&(this.orderCreateData.buyer_ask_delivery_time=(1==S.toString().length?"0"+S:S)+":"+(1==k.toString().length?"0"+k:k)),(b>C||b==C&&D>P)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/groupbuy/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/groupbuy/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else{var o=e.getStorageSync("groupbuyOrderCreateData");o.out_trade_no=t.data,e.setStorageSync("groupbuyOrderCreateData",o),i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1}else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].goods_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this,i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/groupbuy/api/ordercreate/verifyareaorstock",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login");var t=e.getStorageSync("groupbuyOrderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.judge=!0,this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},"9e2e":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("b056"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{registerConfig:{},indent:"all",customNavTitle:"",memberInfo:{headimg:""},formData:{userHeadImg:"",number:"",nickName:"",sex:"",realName:"",birthday:"",currentPassword:"",newPassword:"",confirmPassword:"",mobile:"",mobileVercode:"",mobileDynacode:"",mobileCodeText:"",username:""},memberInfoformData:{userHeadImg:"",number:"",nickName:"",sex:"",realName:"",birthday:"",currentPassword:"",newPassword:"",confirmPassword:"",mobile:"",mobileVercode:"",mobileDynacode:"",mobileCodeText:""},langList:[],langIndex:0,seconds:120,timer:null,isSend:!1,captcha:{id:"",img:""},isIphoneX:!1,items:[{value:"0",name:"未知"},{value:"1",name:"男",checked:"true"},{value:"2",name:"女"}],current:0,memberConfig:{is_audit:0,is_enable:0}}},onLoad:function(e){this.$langConfig.refresh(),this.formData.mobileCodeText=this.$lang("findanimateCode"),e.back&&(this.back=e.back),this.getCaptcha(),e.action&&(this.indent=e.action,this.setNavbarTitle()),this.getRegisterConfig(),this.isIphoneX=this.$util.uniappIsIPhoneX(),this.initLang(),this.getMemberConfig()},onShow:function(){var t=this;e.getStorageSync("token")?this.getInfo():setTimeout((function(){t.$refs.login.open("/otherpages/member/info/info")}))},onHide:function(){this.seconds=120,this.formData.mobileCodeText="获取动态码",this.isSend=!1,clearInterval(this.timer)},watch:{seconds:function(e){0==e&&(this.seconds=120,this.formData.mobileCodeText="获取动态码",this.isSend=!1,clearInterval(this.timer))},storeToken:function(e,t){e&&this.getInfo()}},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")},storeToken:function(){return this.$store.state.token}},methods:{initLang:function(){if(this.langList=this.$langConfig.list(),e.getStorageSync("lang")){for(var t=0;t<this.langList.length;t++)if(this.langList[t].value==e.getStorageSync("lang")){this.langIndex=t;break}}else this.langIndex=0},setNavbarTitle:function(){var t="个人资料";switch(this.indent){case"name":t=this.$lang("modifyNickname");break;case"realName":t=this.$lang("realName");break;case"sex":t=this.$lang("sex");break;case"birthday":t=this.$lang("birthday");break;case"password":t=this.$lang("password");break;case"mobile":t=this.$lang("mobile");break}e.setNavigationBarTitle({title:t})},getInfo:function(){var e=this;this.$api.sendRequest({url:"/api/member/info",success:function(t){0==t.code&&(e.memberInfo=t.data,e.memberInfoformData.userHeadImg=e.memberInfo.headimg,e.memberInfoformData.number=e.memberInfo.username,e.memberInfoformData.nickName=e.memberInfo.nickname,e.memberInfoformData.realName=e.memberInfo.realname?e.memberInfo.realname:"请输入真实姓名",e.memberInfoformData.sex=0==e.memberInfo.sex?"未知":1==e.memberInfo.sex?"男":"女",e.memberInfoformData.birthday=e.memberInfo.birthday?e.$util.timeStampTurnTime(e.memberInfo.birthday,"YYYY-MM-DD"):"请选择生日",e.memberInfoformData.mobile=e.memberInfo.mobile,e.formData.username=e.memberInfo.username,e.formData.nickName=e.memberInfo.nickname,e.formData.realName=e.memberInfo.realname,e.formData.sex=e.memberInfo.sex,e.formData.birthday=e.memberInfo.birthday?e.$util.timeStampTurnTime(e.memberInfo.birthday,"YYYY-MM-DD"):"请选择生日"),e.$refs.loadingCover&&e.$refs.loadingCover.hide()},fail:function(t){e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},modifyInfo:function(t){switch(t){case"cancellation":this.getCancelStatus();break;case"language":for(var i=[],o=0;o<this.langList.length;o++)i.push(this.langList[o].name);e.showActionSheet({itemList:i,success:function(e){vm.langIndex!=e.tapIndex&&vm.$langConfig.change(vm.langList[e.tapIndex].value)}});break;default:this.$util.redirectTo("/otherpages/member/info_edit/info_edit",{action:t})}},getCancelStatus:function(){var e=this;this.$api.sendRequest({url:"/membercancel/api/membercancel/info",success:function(t){t.code>=0&&(t.data?0==t.data.status?e.$util.redirectTo("/otherpages/member/cancelstatus/cancelstatus",{back:"/otherpages/member/info/info"}):1==t.data.status?e.$util.redirectTo("/otherpages/member/cancelsuccess/cancelsuccess",{back:"/otherpages/member/info/info"}):e.$util.redirectTo("/otherpages/member/cancelrefuse/cancelrefuse",{back:"/otherpages/member/info/info"}):e.$util.redirectTo("/otherpages/member/cancellation/cancellation",{back:"/otherpages/member/info/info"}))}})},NavReturn:function(){e.navigateBack({delta:1})},getCaptcha:function(){var e=this;this.$api.sendRequest({url:"/api/captcha/captcha",data:{captcha_id:this.captcha.id},success:function(t){t.code>=0&&(e.captcha=t.data,e.captcha.img=e.captcha.img.replace(/\r\n/g,""))}})},logout:function(){var t=this;e.showModal({title:"提示",content:"确定要退出登录吗",success:function(i){i.confirm&&e.removeStorage({key:"token",success:function(i){e.setStorageSync("loginLock",1),e.removeStorageSync("userInfo"),t.$store.dispatch("getCartNumber").then((function(e){})),t.$util.redirectTo("/pages/member/index/index")}})}})},headImage:function(){this.$util.redirectTo("/otherpages/member/modify_face/modify_face")},testBinding:function(e){var t=this;return n(o.default.mark((function e(){var i;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.checkMobile();case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})))()},getMemberConfig:function(){var e=this;this.$api.sendRequest({url:"/membercancel/api/membercancel/config",success:function(t){t.code>=0&&(e.memberConfig=t.data)}})},save:function(e){switch(e){case"username":this.modifyUserName();break;case"name":this.modifyNickName();break;case"realName":this.modifyRealName();break;case"sex":this.modifySex();break;case"birthday":this.modifyBirthday();break;case"password":this.modifyPassword();break;case"mobile":this.modifyMobile();break}},modifyUserName:function(){var e=this;if(this.formData.username!=this.memberInfo.username){var t=[{name:"username",checkType:"required",errorMsg:this.$lang("noEmityUsername")}];if(t.length){var i=r.default.check(this.formData,t);i?this.$api.sendRequest({url:"/api/member/modifyusername",data:{username:this.formData.username},success:function(t){0==t.code?(e.$util.showToast({title:e.$lang("updateSuccess")}),e.NavReturn()):e.$util.showToast({title:t.message})}}):this.$util.showToast({title:r.default.error})}}else this.$util.showToast({title:this.$lang("alikeusername")})},modifyNickName:function(){var e=this;if(this.formData.nickName!=this.memberInfo.nickname){var t=[{name:"nickName",checkType:"required",errorMsg:this.$lang("noEmityNickname")}];if(t.length){var i=r.default.check(this.formData,t);i?this.$api.sendRequest({url:"/api/member/modifynickname",data:{nickname:this.formData.nickName},success:function(t){0==t.code?(e.$util.showToast({title:e.$lang("updateSuccess")}),e.NavReturn()):e.$util.showToast({title:t.message})}}):this.$util.showToast({title:r.default.error})}}else this.$util.showToast({title:this.$lang("alikeNickname")})},modifyRealName:function(){var e=this;if(this.formData.realName==this.memberInfo.realname&&this.memberInfo.realname)this.$util.showToast({title:"与原真实姓名一致，无需修改"});else{var t=[{name:"realName",checkType:"required",errorMsg:"真实姓名不能为空"}];if(t.length){var i=r.default.check(this.formData,t);i?this.$api.sendRequest({url:"/api/member/modifyrealname",data:{realname:this.formData.realName},success:function(t){0==t.code?(e.$util.showToast({title:e.$lang("updateSuccess")}),e.NavReturn()):e.$util.showToast({title:t.message})}}):this.$util.showToast({title:r.default.error})}}},radioChange:function(e){for(var t=0;t<this.items.length;t++)if(this.items[t].value===e.target.value){this.formData.sex=t;break}},modifySex:function(){var e=this;this.$api.sendRequest({url:"/api/member/modifysex",data:{sex:this.formData.sex},success:function(t){0==t.code?(e.$util.showToast({title:e.$lang("updateSuccess")}),e.NavReturn()):e.$util.showToast({title:t.message})}})},bindDateChange:function(e){this.formData.birthday=e.target.value},getDate:function(e){var t=new Date,i=t.getFullYear(),o=t.getMonth()+1,r=t.getDate();return"start"===e?i-=60:"end"===e&&(i+=2),o=o>9?o:"0"+o,r=r>9?r:"0"+r,"".concat(i,"-").concat(o,"-").concat(r)},modifyBirthday:function(){var e=this;this.$api.sendRequest({url:"/api/member/modifybirthday",data:{birthday:this.$util.timeTurnTimeStamp(this.formData.birthday)},success:function(t){0==t.code?(e.$util.showToast({title:e.$lang("updateSuccess")}),e.NavReturn()):e.$util.showToast({title:t.message})}})},getRegisterConfig:function(){var e=this;this.$api.sendRequest({url:"/api/register/config",success:function(t){t.code>=0&&(e.registerConfig=t.data.value)}})},modifyPassword:function(){var t=this;if(this.memberInfo.password)var i=[{name:"currentPassword",checkType:"required",errorMsg:this.$lang("pleaseInputOldPassword")},{name:"newPassword",checkType:"required",errorMsg:this.$lang("pleaseInputNewPassword")}];else i=[{name:"mobileVercode",checkType:"required",errorMsg:this.$lang("confirmCodeInput")},{name:"mobileDynacode",checkType:"required",errorMsg:this.$lang("animateCodeInput")},{name:"newPassword",checkType:"required",errorMsg:this.$lang("pleaseInputNewPassword")}];var o=this.registerConfig;if(o.pwd_len>0&&i.push({name:"newPassword",checkType:"lengthMin",checkRule:o.pwd_len,errorMsg:"新密码长度不能小于"+o.pwd_len+"位"}),o.pwd_complexity){var a="密码需包含",s="";-1!=o.pwd_complexity.indexOf("number")&&(s+="(?=.*?[0-9])",a+="数字"),-1!=o.pwd_complexity.indexOf("letter")&&(s+="(?=.*?[a-z])",a+="、小写字母"),-1!=o.pwd_complexity.indexOf("upper_case")&&(s+="(?=.*?[A-Z])",a+="、大写字母"),-1!=o.pwd_complexity.indexOf("symbol")&&(s+="(?=.*?[#?!@$%^&*-])",a+="、特殊字符"),i.push({name:"newPassword",checkType:"reg",checkRule:s,errorMsg:a})}var n=r.default.check(this.formData,i);if(n){if(this.formData.currentPassword==this.formData.newPassword)return void this.$util.showToast({title:"新密码不能与原密码相同"});if(this.formData.newPassword!=this.formData.confirmPassword)return void this.$util.showToast({title:"两次密码不一致"});this.$api.sendRequest({url:"/api/member/modifypassword",data:{new_password:this.formData.newPassword,old_password:this.formData.currentPassword,code:this.formData.mobileDynacode,key:e.getStorageSync("password_mobile_key")},success:function(i){0==i.code?(t.$util.showToast({title:t.$lang("updateSuccess")}),t.NavReturn(),e.removeStorageSync("password_mobile_key")):t.$util.showToast({title:i.message})}})}else this.$util.showToast({title:r.default.error})},vertifyMobile:function(){var e=[{name:"mobile",checkType:"required",errorMsg:"请输入手机号"},{name:"mobile",checkType:"phoneno",errorMsg:"请输入正确的手机号"}],t=r.default.check(this.formData,e);return!!t||(this.$util.showToast({title:r.default.error}),!1)},checkMobile:function(){var e=this;return n(o.default.mark((function t(){var i;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.vertifyMobile()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$api.sendRequest({url:"/api/member/checkmobile",data:{mobile:e.formData.mobile},async:!1});case 4:if(i=t.sent,0==i.code){t.next=8;break}return e.$util.showToast({title:i.message}),t.abrupt("return",!1);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})))()},bindMoblieCode:function(){var t=this;return n(o.default.mark((function i(){var a,s;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(120==t.seconds){i.next=2;break}return i.abrupt("return");case 2:a=[{name:"mobile",checkType:"phoneno",errorMsg:t.$lang("surePhoneNumber")},{name:"mobileVercode",checkType:"required",errorMsg:t.$lang("confirmCodeInput")}],s=r.default.check(t.formData,a),s&&!t.isSend?(t.isSend=!0,t.$api.sendRequest({url:"/api/member/bindmobliecode",data:{mobile:t.formData.mobile,captcha_id:t.captcha.id,captcha_code:t.formData.mobileVercode},success:function(i){var o=i.data;o.key?(120==t.seconds&&null==t.timer&&(t.timer=setInterval((function(){t.seconds--,t.formData.mobileCodeText="已发送("+t.seconds+"s)"}),1e3)),e.setStorageSync("mobile_key",o.key)):(t.$util.showToast({title:i.message}),t.isSend=!1)},fail:function(e){t.isSend=!1,t.getCaptcha()}})):t.$util.showToast({title:r.default.error?r.default.error:"请勿重复点击"});case 5:case"end":return i.stop()}}),i)})))()},modifyMobile:function(){var t=this;return n(o.default.mark((function i(){var a,s;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=[{name:"mobile",checkType:"phoneno",errorMsg:t.$lang("surePhoneNumber")},{name:"mobileVercode",checkType:"required",errorMsg:t.$lang("confirmCodeInput")},{name:"mobileDynacode",checkType:"required",errorMsg:t.$lang("animateCodeInput")}],s=r.default.check(t.formData,a),!s){i.next=9;break}if(t.formData.mobile!=t.memberInfo.mobile){i.next=6;break}return t.$util.showToast({title:t.$lang("alikePhone")}),i.abrupt("return");case 6:t.$api.sendRequest({url:"/api/member/modifymobile",data:{mobile:t.formData.mobile,captcha_id:t.captcha.id,captcha_code:t.formData.mobileVercode,code:t.formData.mobileDynacode,key:e.getStorageSync("mobile_key")},success:function(e){0==e.code?(t.$util.showToast({title:t.$lang("updateSuccess")}),t.back?t.$util.redirectTo("/otherpages/member/pay_password/pay_password",{back:t.back},"redirectTo"):t.NavReturn()):t.$util.showToast({title:e.message})},fail:function(e){t.isSend=!1,t.getCaptcha()}}),i.next=10;break;case 9:t.$util.showToast({title:r.default.error});case 10:case"end":return i.stop()}}),i)})))()},passwordMoblieCode:function(){var t=this;120==this.seconds&&(""!=this.formData.mobileVercode?this.isSend?this.$util.showToast({title:"请勿重复点击"}):(this.isSend=!0,this.$api.sendRequest({url:"/api/member/pwdmobliecode",data:{captcha_id:this.captcha.id,captcha_code:this.formData.mobileVercode},success:function(i){var o=i.data;o.key?(120==t.seconds&&null==t.timer&&(t.timer=setInterval((function(){t.seconds--,t.formData.mobileCodeText="已发送("+t.seconds+"s)"}),1e3)),e.setStorageSync("password_mobile_key",o.key)):(t.$util.showToast({title:i.message}),t.isSend=!1)},fail:function(e){t.isSend=!1,t.getCaptcha()}})):this.$util.showToast({title:this.$lang("confirmCodeInput")}))},initFormData:function(){this.formData.currentPassword="",this.formData.newPassword="",this.formData.confirmPassword="",this.formData.mobileVercode="",this.formData.mobileDynacode="",this.formData.mobile=""}}};t.default=d}).call(this,i("543d")["default"])},"9fd1":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"领取优惠券"};t.lang=o},a049:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"申请退款"};t.lang=o},a34a:function(e,t,i){e.exports=i("bbdd")},a396:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,is_point:1,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""},is_open_card:0,member_card_unit:""},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,manjian:[],storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},post_free:{},canLocalDelicery:!0,deliveryWeek:"",out_trade_no:null}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/giftcard/payment/payment?giftcard_i="+this.giftcard_id+"&id="+this.id,local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;if(!this.out_trade_no){this.orderCreateData=e.getStorageSync("orderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.orderCreateData.cart_ids&&this.orderCreateData.jielong_id?this.$api.sendRequest({url:"/jielong/api/cart/goodsLists",data:{jielong_id:this.orderCreateData.jielong_id},success:function(e){if(0==e.data.length)return t.$util.redirectTo("/pages/index/index/index",{},"reLaunch"),!1;t.dingdna()}}):this.dingdna()}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))}},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.is_point=1,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);var i=this.orderPaymentData;if(i.recommend_member_card&&(this.orderCreateData.member_card_unit=Object.keys(i.recommend_member_card.charge_rule)[0]),void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var n=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;n.length&&(this.orderCreateData.invoice_content=n[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var d=this.orderPaymentData.shop_goods_list.local_config.info.time_week,c=!1,l=0;l<d.length;l++)if(l+1<d.length){var u=d[l+1]-d[l];if(u>1){c=!0;break}}var h=["周日","周一","周二","周三","周四","周五","周六"];if(c){var f=[];for(l=0;l<d.length;l++)f.push(h[d[l]]);this.deliveryWeek=f.join("、")}else this.deliveryWeek=h[d[0]]+"至"+h[d[d.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var p=(new Date).getHours().toString(),m=(new Date).getMinutes().toString();1==p.length&&(p="0"+p),1==m.length&&(m="0"+m),this.orderCreateData.buyer_ask_delivery_time=p+":"+m;var _=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(_);var g=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(g);var y=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),v=y.getHours(),b=y.getMinutes(),D=parseInt(this.timeInfo.start_time.split(":")[0]),S=parseInt(this.timeInfo.start_time.split(":")[1]),k=parseInt(this.timeInfo.end_time.split(":")[0]),C=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(D==k&&S==C||((v<D||v==D&&b<S)&&(this.orderCreateData.buyer_ask_delivery_time=(1==D.toString().length?"0"+D:D)+":"+(1==S.toString().length?"0"+S:S)),(v>k||v==k&&b>C)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";i.system_form&&(this.orderPaymentData.system_form=i.system_form),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]}))},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},dingdna:function(){var e=this;this.orderCreateData.giftcard_id=this.giftcard_id,this.$api.sendRequest({url:"/giftcard/api/giftcard/payment",data:this.orderCreateData,success:function(t){t.code>=0?(e.post_free=t.data.shop_goods_list.promotion,e.orderPaymentData=t.data,e.orderPaymentData.timestamp=t.timestamp,e.handlePaymentData(),e.$refs.loadingCover&&e.$refs.loadingCover.hide()):(e.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(t){e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if("店铺未开启配送时间"==this.deliveryWeek)return this.$util.showToast({title:"店铺未设置配送时间"}),!1;if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}if(this.orderPaymentData.system_form){var c=this.$refs.form.verify();if(!c)return!1}return!0},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(t,i){var o=this;this.orderCreateData.giftcard_id=t,this.orderCreateData.id=i,this.orderCreateData.delivery=JSON.stringify(this.orderCreateData.delivery),this.verify()&&e.showModal({title:"提示",content:"确定要使用该礼品卡吗",success:function(e){e.confirm&&o.$api.sendRequest({url:"/giftcard/api/giftcard/use",data:o.orderCreateData,success:function(e){o.$util.showToast({title:e.message}),setTimeout((function(){o.$util.redirectTo("/promotionpages/giftcard/my_giftcard/my_giftcard")}),1e3)}})}})},subscribeMessage:function(){var t="ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY";this.orderCreateData.delivery&&"store"==this.orderCreateData.delivery.delivery_type&&(t="ORDER_PAY,ORDER_TAKE_DELIVERY"),this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:t},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},a44e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"购物车",complete:"完成",edit:"管理",allElection:"全选",total:"合计",settlement:"结算",emptyTips:"暂无商品",goForStroll:"去逛逛",del:"删除",login:"去登录"};t.lang=o},a460:function(e,t,i){"use strict";(function(e){function i(t,i){return new Promise((function(o,r){var a=i?e.createSelectorQuery().in(i):e.createSelectorQuery();return a.select(t).boundingClientRect(o).exec()}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getClientRect=i}).call(this,i("543d")["default"])},a4f6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={contact:"",person:"",personadd:"","contact-filled":"","person-filled":"","personadd-filled":"",phone:"",email:"",chatbubble:"",chatboxes:"","phone-filled":"","email-filled":"","chatbubble-filled":"","chatboxes-filled":"",weibo:"",weixin:"",pengyouquan:"",chat:"",qq:"",videocam:"",camera:"",mic:"",location:"","mic-filled":"",speech:"","location-filled":"",micoff:"",image:"",map:"",compose:"",trash:"",upload:"",download:"",close:"",redo:"",undo:"",refresh:"",star:"",plus:"",minus:"",circle:"",checkbox:"","close-filled":"",clear:"","refresh-filled":"","star-filled":"","plus-filled":"","minus-filled":"","circle-filled":"","checkbox-filled":"",closeempty:"",refreshempty:"",reload:"",starhalf:"",spinner:"","spinner-cycle":"",search:"",plusempty:"",forward:"",back:"","left-nav":"",checkmarkempty:"",home:"",navigate:"",gear:"",paperplane:"",info:"",help:"",locked:"",more:"",flag:"","home-filled":"","gear-filled":"","info-filled":"","help-filled":"","more-filled":"",settings:"",list:"",bars:"",loop:"",paperclip:"",eye:"",arrowup:"",arrowdown:"",arrowleft:"",arrowright:"",arrowthinup:"",arrowthindown:"",arrowthinleft:"",arrowthinright:"",pulldown:"",closefill:"",sound:"",scan:""};t.default=o},a5c74:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={tabBar:{home:"首页",category:"分类",cart:"购物车",member:"个人中心"},common:{name:"中文",mescrollTextInOffset:"下拉刷新",mescrollTextOutOffset:"释放更新",mescrollEmpty:"暂无相关数据",goodsRecommendTitle:"猜你喜欢",currencySymbol:"¥",submit:"提交"}};t.lang=o},a7e3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={baseUrl:"{{$baseUrl}}",imgDomain:"{{$imgDomain}}",h5Domain:"{{$h5Domain}}",mpKey:"{{$mpKey}}",webSocket:"{{$webSocket}}",pingInterval:1500},r=o;t.default=r},aa11:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单详情"};t.lang=o},aa36:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i("8795"));function r(e){return e&&e.__esModule?e:{default:e}}function a(t,i,o){e.openLocation({latitude:t,longitude:i,name:o,fail:function(t){e.showModal({content:"打开地图失败，请稍后重试"})}})}function s(e,t,i){switch(i){case"gcj02":return[e,t];case"bd09":return o.default.bd09togcj02(e,t);case"wgs84":return o.default.wgs84togcj02(e,t);default:return[e,t]}}var n={openMap:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"gcj02",r=s(t,e,o);a(r[1],r[0],i)}};t.default=n}).call(this,i("543d")["default"])},aacf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"申请退款"};t.lang=o},ab5c:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账户列表",name:"姓名",accountType:"账号类型",mobilePhone:"手机号码",withdrawalAccount:"提现账号",bankInfo:"支行信息",newAddAccount:"新增账户",del:"删除",update:"修改",emptyText:"当前暂无账户"};t.lang=o},af9e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"个人资料",headImg:"头像",account:"账号",nickname:"昵称",realName:"真实姓名",sex:"性别",birthday:"生日",password:"密码",paypassword:"支付密码",mobilePhone:"手机",bindMobile:"绑定手机",cancellation:"注销账号",lang:"语言",logout:"退出登录",save:"保存",noset:"未设置",nickPlaceholder:"请输入新昵称",pleaseRealName:"请输入真实姓名",nowPassword:"当前密码",newPassword:"新密码",confirmPassword:"确认新密码",phoneNumber:"手机号",confirmCode:"验证码",confirmCodeInput:"请输入验证码",confirmCodeInputerror:"验证码错误",findanimateCode:"获取动态码",animateCode:"动态码",animateCodeInput:"请输入动态码",modifyNickname:"修改昵称",modifyPassword:"修改密码",bindPhone:"绑定手机",alikeNickname:"与原昵称一致，无需修改",noEmityNickname:"昵称不能为空",updateSuccess:"修改成功",pleaseInputOldPassword:"请输入原始密码",pleaseInputNewPassword:"请输入新密码",passwordLength:"密码长度不能小于6位",alikePassword:"两次密码不一致",samePassword:"新密码不能与原密码相同",surePhoneNumber:"请输入正确的手机号",alikePhone:"与原手机号一致，无需修改",modify:"修改"};t.lang=o},b056:function(e,t){e.exports={error:"",check:function(e,t){for(var i=0;i<t.length;i++){if(!t[i].checkType)return!0;if(!t[i].name)return!0;if(!t[i].errorMsg)return!0;if(!e[t[i].name])return this.error=t[i].errorMsg,!1;switch(t[i].checkType){case"custom":if("function"==typeof t[i].validate&&!t[i].validate(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"required":var o=new RegExp("/[S]+/");if(o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"string":o=new RegExp("^.{"+t[i].checkRule+"}$");if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"int":o=new RegExp("^(-[1-9]|[1-9])[0-9]{"+t[i].checkRule+"}$");if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"between":if(!this.isNumber(e[t[i].name]))return this.error=t[i].errorMsg,!1;var r=t[i].checkRule.split(",");if(r[0]=Number(r[0]),r[1]=Number(r[1]),e[t[i].name]>r[1]||e[t[i].name]<r[0])return this.error=t[i].errorMsg,!1;break;case"betweenD":o=/^-?[1-9][0-9]?$/;if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;r=t[i].checkRule.split(",");if(r[0]=Number(r[0]),r[1]=Number(r[1]),e[t[i].name]>r[1]||e[t[i].name]<r[0])return this.error=t[i].errorMsg,!1;break;case"betweenF":o=/^-?[0-9][0-9]?.+[0-9]+$/;if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;r=t[i].checkRule.split(",");if(r[0]=Number(r[0]),r[1]=Number(r[1]),e[t[i].name]>r[1]||e[t[i].name]<r[0])return this.error=t[i].errorMsg,!1;break;case"same":if(e[t[i].name]!=t[i].checkRule)return this.error=t[i].errorMsg,!1;break;case"notsame":if(e[t[i].name]==t[i].checkRule)return this.error=t[i].errorMsg,!1;break;case"email":o=/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"phoneno":o=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][0-9]))[0-9]{8}$/;if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"zipcode":o=/^[0-9]{6}$/;if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"reg":o=new RegExp(t[i].checkRule);if(!o.test(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"in":if(-1==t[i].checkRule.indexOf(e[t[i].name]))return this.error=t[i].errorMsg,!1;break;case"notnull":if(0==e[t[i].name]||void 0==e[t[i].name]||null==e[t[i].name]||e[t[i].name].length<1)return this.error=t[i].errorMsg,!1;break;case"lengthMin":if(e[t[i].name].length<t[i].checkRule)return this.error=t[i].errorMsg,!1;break;case"lengthMax":if(e[t[i].name].length>t[i].checkRule)return this.error=t[i].errorMsg,!1;break}}return!0},isNumber:function(e){var t=/^-?[1-9][0-9]?.?[0-9]*$/;return t.test(e)}}},b0ec:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"支付结果",paymentSuccess:"支付成功",paymentFail:"支付失败",goHome:"回到首页",memberCenter:"会员中心",payMoney:"支付金额",unit:"元"};t.lang=o},b146:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"登录",mobileLogin:"手机号登录",accountLogin:"账号登录",autoLogin:"一键授权登录",login:"登录",mobilePlaceholder:"手机号登录仅限中国大陆用户",dynacodePlaceholder:"请输入动态码",captchaPlaceholder:"请输入验证码",accountPlaceholder:"请输入账号",passwordPlaceholder:"请输入密码",rePasswordPlaceholder:"请确认密码",forgetPassword:"忘记密码",register:"注册",registerTips:"没有账号的用户快来",registerTips1:"注册",registerTips2:"吧",newUserRegister:"新用户注册"};t.lang=o},b19e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"砍价详情"};t.lang=o},b30d:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的足迹",emptyTpis:"您还未浏览过任何商品！"};t.lang=o},b63e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"积分兑换订单详情"};t.lang=o},b685:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"积分兑换",emptyTips:"暂无更多数据了"};t.lang=o},b6ac:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={computed:{themeStyleScore:function(){return this.$store.state.themeStyle},themeStyle:function(){return"theme-"+this.$store.state.themeStyle},addonIsExit:function(){return this.$store.state.addonIsExit},showToastValue:function(){return this.$store.state.showToastValue},diySeckillInterval:function(){return this.$store.state.diySeckillInterval}}};t.default=o},b8a2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={};t.lang=o},b8be:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},b8ea:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={methods:{orderPay:function(t){var i=this;0==t.adjust_money?this.openChoosePayment():e.showModal({title:"提示",content:"商家已将支付金额调整为"+t.pay_money+"元，是否继续支付？",success:function(e){e.confirm&&i.openChoosePayment()}})},pay:function(){var e=this;this.$api.sendRequest({url:"/api/order/pay",data:{order_ids:this.orderData.order_id},success:function(t){t.code>=0?e.$refs.choosePaymentPopup.getPayInfo(t.data):e.$util.showToast({title:t.message})}})},orderClose:function(t,i){var o=this;e.showModal({title:"提示",content:"您确定要关闭该订单吗？",success:function(e){e.confirm&&o.$api.sendRequest({url:"/api/order/close",data:{order_id:t},success:function(e){e.code>=0?"function"==typeof i&&i():o.$util.showToast({title:"当前订单可能存在拼团，维权等操作，"+e.message+"不可以关闭哦!",duration:2e3})}})}})},orderDelivery:function(t,i){var o=this;e.showModal({title:"提示",content:"您确定已经收到货物了吗？",success:function(e){e.confirm&&o.$api.sendRequest({url:"/api/order/takedelivery",data:{order_id:t},success:function(e){o.$util.showToast({title:e.message}),"function"==typeof i&&i()}})}})}}};t.default=i}).call(this,i("543d")["default"])},b8f2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},bbdd:function(e,t,i){var o=function(){return this||"object"===typeof self&&self}()||Function("return this")(),r=o.regeneratorRuntime&&Object.getOwnPropertyNames(o).indexOf("regeneratorRuntime")>=0,a=r&&o.regeneratorRuntime;if(o.regeneratorRuntime=void 0,e.exports=i("96cf"),r)o.regeneratorRuntime=a;else try{delete o.regeneratorRuntime}catch(s){o.regeneratorRuntime=void 0}},bc6f:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i("23e9"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(t.date,t.selected),o=t.startDate,r=t.endDate,s=t.range;a(this,e),this.date=this.getDate(new Date),this.selected=i||[],this.startDate=o,this.endDate=r,this.range=s,this.cleanMultipleStatus(),this.weeks={}}return n(e,[{key:"setDate",value:function(e){this.selectDate=this.getDate(e),this._getWeek(this.selectDate.fullDate)}},{key:"cleanMultipleStatus",value:function(){this.multipleStatus={before:"",after:"",data:[]}}},{key:"resetSatrtDate",value:function(e){this.startDate=e}},{key:"resetEndDate",value:function(e){this.endDate=e}},{key:"getDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day";e||(e=new Date),"object"!==typeof e&&(e=e.replace(/-/g,"/"));var o=new Date(e);switch(i){case"day":o.setDate(o.getDate()+t);break;case"month":31===o.getDate()?o.setDate(o.getDate()+t):o.setMonth(o.getMonth()+t);break;case"year":o.setFullYear(o.getFullYear()+t);break}var r=o.getFullYear(),a=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,s=o.getDate()<10?"0"+o.getDate():o.getDate();return{fullDate:r+"-"+a+"-"+s,year:r,month:a,date:s,day:o.getDay()}}},{key:"_getLastMonthDays",value:function(e,t){for(var i=[],o=e;o>0;o--){var r=new Date(t.year,t.month-1,1-o).getDate();i.push({date:r,month:t.month-1,lunar:this.getlunar(t.year,t.month-1,r),disable:!0})}return i}},{key:"_currentMonthDys",value:function(e,t){for(var i=this,o=[],r=this.date.fullDate,a=function(e){var a=t.year+"-"+(t.month,t.month+"-")+(e<10?"0"+e:e),s=r===a,n=i.selected&&i.selected.find((function(e){if(i.dateEqual(a,e.date))return e})),d=!0,c=!0;if(i.startDate){var l=i.dateCompare(i.startDate,r);d=i.dateCompare(l?i.startDate:r,a)}if(i.endDate){var u=i.dateCompare(r,i.endDate);c=i.dateCompare(a,u?i.endDate:r)}var h=i.multipleStatus.data,f=!1,p=-1;i.range&&(h&&(p=h.findIndex((function(e){return i.dateEqual(e,a)}))),-1!==p&&(f=!0));var m={fullDate:a,year:t.year,date:e,multiple:!!i.range&&f,beforeMultiple:i.dateEqual(i.multipleStatus.before,a),afterMultiple:i.dateEqual(i.multipleStatus.after,a),month:t.month,lunar:i.getlunar(t.year,t.month,e),disable:!d||!c,isDay:s};n&&(m.extraInfo=n),o.push(m)},s=1;s<=e;s++)a(s);return o}},{key:"_getNextMonthDays",value:function(e,t){for(var i=[],o=1;o<e+1;o++)i.push({date:o,month:Number(t.month)+1,lunar:this.getlunar(t.year,Number(t.month)+1,o),disable:!0});return i}},{key:"getInfo",value:function(e){var t=this;e||(e=new Date);var i=this.canlender.find((function(i){return i.fullDate===t.getDate(e).fullDate}));return i}},{key:"dateCompare",value:function(e,t){return e=new Date(e.replace("-","/").replace("-","/")),t=new Date(t.replace("-","/").replace("-","/")),e<=t}},{key:"dateEqual",value:function(e,t){return e=new Date(e.replace("-","/").replace("-","/")),t=new Date(t.replace("-","/").replace("-","/")),e.getTime()-t.getTime()===0}},{key:"geDateAll",value:function(e,t){var i=[],o=e.split("-"),r=t.split("-"),a=new Date;a.setFullYear(o[0],o[1]-1,o[2]);var s=new Date;s.setFullYear(r[0],r[1]-1,r[2]);for(var n=a.getTime()-864e5,d=s.getTime()-864e5,c=n;c<=d;)c+=864e5,i.push(this.getDate(new Date(parseInt(c))).fullDate);return i}},{key:"getlunar",value:function(e,t,i){return o.default.solar2lunar(e,t,i)}},{key:"setSelectInfo",value:function(e,t){this.selected=t,this._getWeek(e)}},{key:"setMultiple",value:function(e){var t=this.multipleStatus,i=t.before,o=t.after;this.range&&(i&&o?(this.multipleStatus.before="",this.multipleStatus.after="",this.multipleStatus.data=[]):i?(this.multipleStatus.after=e,this.dateCompare(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this._getWeek(e))}},{key:"_getWeek",value:function(e){var t=this.getDate(e),i=(t.fullDate,t.year),o=t.month,r=(t.date,t.day,new Date(i,o-1,1).getDay()),a=new Date(i,o,0).getDate(),s={lastMonthDays:this._getLastMonthDays(r,this.getDate(e)),currentMonthDys:this._currentMonthDys(a,this.getDate(e)),nextMonthDays:[],weeks:[]},n=[],d=42-(s.lastMonthDays.length+s.currentMonthDys.length);s.nextMonthDays=this._getNextMonthDays(d,this.getDate(e)),n=n.concat(s.lastMonthDays,s.currentMonthDys,s.nextMonthDays);for(var c={},l=0;l<n.length;l++)l%7===0&&(c[parseInt(l/7)]=new Array(7)),c[parseInt(l/7)][l%7]=n[l];this.canlender=n,this.weeks=c}}]),e}(),c=d;t.default=c},bd8f:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},bd9c:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"账号注销"};t.lang=o},c5be:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品详情",select:"选择",params:"参数",service:"商品服务",allGoods:"全部商品",image:"图片",video:"视频"};t.lang=o},c8ae:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{authInfo:{}}},methods:{getCode:function(t){var i=this;this.getUserInfo(),e.login({provider:"weixin",timeout:3e3,success:function(e){e.code&&i.$api.sendRequest({url:"/weapp/api/weapp/authcodetoopenid",data:{code:e.code},success:function(e){e.code>=0?(e.data.openid&&(i.authInfo.weapp_openid=e.data.openid),e.data.unionid&&(i.authInfo.wx_unionid=e.data.unionid),"function"==typeof t&&t(i.authInfo)):i.$util.showToast({title:"小程序配置错误"})}})},fail:function(){i.$util.showToast({title:"请求失败"})}})},getUserInfo:function(){var t=this;wx.getUserProfile||e.getUserInfo({success:function(e){"getUserInfo:ok"==e.errMsg&&(e.userInfo.nickName&&(t.authInfo.nickName=e.userInfo.nickName),e.userInfo.avatarUrl&&(t.authInfo.avatarUrl=e.userInfo.avatarUrl))}})},handleAuthInfo:function(){try{this.checkOpenidIsExits()}catch(e){}}},onLoad:function(e){var t=this;e.code&&this.$util.isWeiXin()&&this.$api.sendRequest({url:"/wechat/api/wechat/authcodetoopenid",data:{code:e.code},success:function(e){e.code>=0&&(e.data.openid&&(t.authInfo.wx_openid=e.data.openid),e.data.unionid&&(t.authInfo.wx_unionid=e.data.unionid),Object.assign(t.authInfo,e.data.userinfo),t.handleAuthInfo())}})}};t.default=i}).call(this,i("543d")["default"])},c8ba:function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(o){"object"===typeof window&&(i=window)}e.exports=i},cabf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"充值详情"};t.lang=o},cb09:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return l(e)||c(e)||d(e)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"===typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?u(e,t):void 0}}function c(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function l(e){if(Array.isArray(e))return u(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function h(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function f(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function s(e){h(a,o,r,s,n,"next",e)}function n(e){h(a,o,r,s,n,"throw",e)}s(void 0)}))}}var p={data:function(){return{skuId:0,groupId:0,pinfan_id:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},pintuanList:[],currentPintuan:{headimg:"",timeMachine:{}},openPopup:!1,memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:{},goodsCircle:!1,timestamp:"",newList:[],evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},kefuConfig:{},isCommunity:!1,videoContext:"",source_member:0,shareImg:""}},onLoad:function(t){var i=this;return f(o.default.mark((function r(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.pinfan_id=t.pinfan_id||0,t.id&&(i.pinfan_id=t.id),i.groupId=t.group_id||0,i.isIphoneX=i.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.source_member&&(i.source_member=t.source_member),t.scene&&(a=decodeURIComponent(t.scene),a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(i.pinfan_id=t.split("-")[1]),-1!=t.indexOf("group_id")&&(i.group_id=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))),i.getService(),o.next=10,i.getGoodsSkuDetail();case 10:i.getEvaluateConfig(),i.getPintuanGroupList(),setTimeout((function(){console.log("this.goodsSkuDetail.sku_images",i.$util.img(i.goodsSkuDetail.sku_images[0]))}),1e3);case 13:case"end":return o.stop()}}),r)})))()},onShow:function(){this.$langConfig.refresh(),this.token=e.getStorageSync("token"),""!=this.token&&(this.getCartCount(),this.getMemberId()),this.getKekuConfig(),this.modifyGoodsInfo(),this.videoContext=e.createVideoContext("goodsVideo"),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},methods:{goConnect:function(){if(e.getStorageSync("token")){var t={sku_id:this.goodsSkuDetail.sku_id,type:"pintuan",type_id:this.goodsSkuDetail.pintuan_id};return this.$util.redirectTo("/otherpages/chat/room/room",t),!1}this.source_member?this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id+"&source_member="+this.source_member):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id)},getGoodsSkuDetail:function(){var e=this;return f(o.default.mark((function t(){var i,a,n,d,c;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/pinfan/api/goods/detail",async:!1,data:{pintuan_id:e.pinfan_id}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,e.skuId=e.goodsSkuDetail.sku_id,e.goodsSkuDetail.group_id=e.groupId,e.goodsSkuDetail.end_time-i.timestamp>0?e.goodsSkuDetail.timeMachine=e.$util.countDown(e.goodsSkuDetail.end_time-i.timestamp):(e.$util.showToast({title:"活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.goods_image&&(e.shareImg=s(e.goodsSkuDetail.sku_images)[0],console.log("this.shareImg",e.shareImg)),console.log(e.shareImg),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.show_price=0==e.goodsSkuDetail.group_id?e.goodsSkuDetail.promotion_price:e.goodsSkuDetail.pintuan_price,e.goodsSkuDetail.save_price=e.goodsSkuDetail.price-e.goodsSkuDetail.show_price>0?(e.goodsSkuDetail.price-e.goodsSkuDetail.show_price).toFixed(2):0,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(n=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(n,"attr_id"),d=0;d<e.goodsSkuDetail.goods_attr_format.length;d++)for(c=0;c<n.length;c++)e.goodsSkuDetail.goods_attr_format[d].attr_id==n[c].attr_id&&e.goodsSkuDetail.goods_attr_format[d].attr_value_id!=n[c].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[d].attr_value_name+="、"+n[c].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/rebate/rebate/detail?pinfan_id="+e.pinfan_id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},""!=e.token&&e.getWhetherCollection(),e.setWechatShare(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},pintuan:function(){var t=this,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.getStorageSync("token")?(i&&this.resetPrice(),this.$refs.goodsSku.show("pinfan",(function(){t.resetPrice(),t.getCartCount()}))):this.source_member?this.$refs.login.open("/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id)},buyNow:function(){var t=this;e.getStorageSync("token")?this.$refs.goodsSku.show("buy_now",(function(){t.getCartCount()})):this.source_member?this.$refs.login.open("/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.forEach((function(t,i){e.goodsEvaluate[i].images&&(e.goodsEvaluate[i].images=e.goodsEvaluate[i].images.split(",")),1==e.goodsEvaluate[i].is_anonymous&&(e.goodsEvaluate[i].member_name=e.goodsEvaluate[i].member_name.replace(e.goodsEvaluate[i].member_name.substring(1,e.goodsEvaluate[i].member_name.length-1),"***"))})))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.source_member?this.$refs.login.open("/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));t.token,t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={id:this.goodsSkuDetail.id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/pinfan/api/goods/poster",data:{page:"/promotionpages/rebate/rebate/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},getPintuanGroupList:function(){var e=this;this.$api.sendRequest({url:"/pinfan/api/pinfangroup/lists",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;if(e.timestamp=t.timestamp,null!=i&&i.length){e.pintuanList=i;for(var o=0;o<e.pintuanList.length;o++)e.pintuanList[o]["end_time"]>t.timestamp?(e.pintuanList[o].timeMachine=e.$util.countDown(e.pintuanList[o]["end_time"]-t.timestamp),e.pintuanList[o].currentTime=t.timestamp):e.pintuanList[o].timeMachine=null;e.newList=e.pintuanList.filter((function(e){return e.end_time>t.timestamp})),e.$forceUpdate()}}})},openPinTuan:function(e,t,i,o,r){var a=this;this.memberId!=r?(this.openPopup=!0,this.currentPintuan={groupId:e,pintuan_num:t,timeMachine:this.$util.countDown(i),headimg:o},this.$refs.pintuanPopup.open((function(){a.goodsSkuDetail.group_id=0,a.openPopup=!1}))):this.$util.showToast({title:"您不能参与自己的团"})},closePinTuanPopup:function(){this.$refs.pintuanPopup.close()},joinPintuan:function(){this.closePinTuanPopup(),this.goodsSkuDetail.group_id=this.currentPintuan.groupId,this.goodsSkuDetail.show_price=this.goodsSkuDetail.pintuan_price,this.goodsSkuDetail.save_price=this.goodsSkuDetail.price-this.goodsSkuDetail.show_price>0?(this.goodsSkuDetail.price-this.goodsSkuDetail.show_price).toFixed(2):0,this.$forceUpdate(),this.pintuan(!1)},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},pintuanImageError:function(e){this.pintuanList[e].headimg=this.$util.getDefaultImage().default_headimg,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/rebate/rebate/detail?pinfan_id="+this.pinfan_id+"&group_id="+this.groupId;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toEvaluateDetail:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},resetPrice:function(){this.goodsSkuDetail.group_id=0,this.goodsSkuDetail.show_price=this.goodsSkuDetail.promotion_price,this.goodsSkuDetail.save_price=this.goodsSkuDetail.price-this.goodsSkuDetail.show_price>0?(this.goodsSkuDetail.price-this.goodsSkuDetail.show_price).toFixed(2):0,this.$forceUpdate()},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++)for(var a=i[r].children,s=0;s<a.length;s++)a[s].attrs&&a[s].attrs.src&&o.push(a[s].attrs.src);e.previewImage({current:o,urls:o})}}};t.default=p}).call(this,i("543d")["default"])},cd49:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{member_address:{mobile:""}},orderPaymentData:{exchange_info:{type:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}},express_type:[]},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/point/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("exchangeOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/pointexchange/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.buyer_message="";var i=this.orderPaymentData;if(void 0!=i.express_type&&void 0!=i.express_type[0]){var o=i.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.local_config.info&&1==this.orderPaymentData.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.local_config.info.time_week.length||7==this.orderPaymentData.local_config.info.time_week.length||this.orderPaymentData.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var n=this.orderPaymentData.local_config.info.time_week,d=!1,c=0;c<n.length;c++)if(c+1<n.length){var l=n[c+1]-n[c];if(l>1){d=!0;break}}var u=["周日","周一","周二","周三","周四","周五","周六"];if(d){var h=[];for(c=0;c<n.length;c++)h.push(u[n[c]]);this.deliveryWeek=h.join("、")}else this.deliveryWeek=u[n[0]]+"至"+u[n[n.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var f=(new Date).getHours().toString(),p=(new Date).getMinutes().toString();1==f.length&&(f="0"+f),1==p.length&&(p="0"+p),this.orderCreateData.buyer_ask_delivery_time=f+":"+p;var m=this.orderPaymentData.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(m);var _=this.orderPaymentData.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(_);var g=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),y=g.getHours(),v=g.getMinutes(),b=parseInt(this.timeInfo.start_time.split(":")[0]),D=parseInt(this.timeInfo.start_time.split(":")[1]),S=parseInt(this.timeInfo.end_time.split(":")[0]),k=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(b==S&&D==k||((y<b||y==b&&v<D)&&(this.orderCreateData.buyer_ask_delivery_time=(1==b.toString().length?"0"+b:b)+":"+(1==D.toString().length?"0"+D:D)),(y>S||y==S&&v>k)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/pointexchange/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.delivery=t.data.delivery,t.data.delivery_store_info&&(e.orderPaymentData.delivery_store_info=JSON.parse(t.data.delivery_store_info),e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1)),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!(this.orderPaymentData.delivery&&"local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.delivery&&this.orderPaymentData.delivery.error&&this.orderPaymentData.delivery.start_money>this.orderPaymentData.price)&&!(this.orderPaymentData.delivery&&"local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.delivery&&this.orderPaymentData.delivery.error&&""!==this.orderPaymentData.delivery.error)},orderCreate:function(){var t=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,e.setStorageSync("paySource","pointexchange");var i=this.$util.deepClone(this.orderCreateData);i.delivery=JSON.stringify(i.delivery),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.$api.sendRequest({url:"/pointexchange/api/ordercreate/create",data:i,success:function(i){if(e.hideLoading(),i.code>=0)if(1==t.orderPaymentData.exchange_info.type&&"0.00"!=t.orderPaymentData.order_money){var o=e.getStorageSync("exchangeOrderCreateData");o.out_trade_no=i.data,e.setStorageSync("exchangeOrderCreateData",o),t.$refs.choosePaymentPopup.getPayInfo(i.data),t.isSub=!1}else t.$util.redirectTo("/promotionpages/point/result/result",{},"redirectTo");else t.isSub=!1,10==i.data.error_code||12==i.data.error_code?e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}}):t.$util.showToast({title:i.message})},fail:function(i){e.hideLoading(),t.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.exchange_info.type){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}}return!0},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},imageError:function(){var e="";e=1==this.orderPaymentData.exchange_info.type?this.$util.img("upload/uniapp/point/gift.png"):2==this.orderPaymentData.exchange_info.type?this.$util.img("upload/uniapp/point/coupon.png"):3==this.orderPaymentData.exchange_info.type?this.$util.img("upload/uniapp/point/hongbao.png"):this.$util.getDefaultImage().default_goods_img,this.orderPaymentData.exchange_info.image=e,this.$forceUpdate()},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){this.verify()&&1==this.orderPaymentData.exchange_info.type&&"0.00"!=this.orderPaymentData.order_money?this.$refs.choosePaymentPopup.open():this.orderCreate()},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.delivery_store_info){var t=this.orderPaymentData.delivery_store_info,i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.judge=!0;var t=e.getStorageSync("exchangeOrderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},ce17:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},d0ad:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"支付密码"};t.lang=o},d5cd:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={methods:{orderClose:function(t,i){var o=this;e.showModal({title:"提示",content:"您确定要关闭该订单吗？",success:function(e){e.confirm&&o.$api.sendRequest({url:"/presale/api/order/close",data:{order_id:t},success:function(e){0==e.code?"function"==typeof i&&i():o.$util.showToast({title:e.message,duration:2e3})}})}})},deleteOrder:function(t,i){var o=this;e.showModal({title:"提示",content:"您确定要删除该订单吗？",success:function(e){e.confirm&&o.$api.sendRequest({url:"/presale/api/order/delete",data:{order_id:t},success:function(e){0==e.code?"function"==typeof i&&i():o.$util.showToast({title:e.message,duration:2e3})}})}})},refundDeposit:function(t,i){var o=this;e.showModal({title:"提示",content:"您确定要退定金吗？",success:function(e){e.confirm&&o.$api.sendRequest({url:"/presale/api/refund/applyRefund",data:{order_id:t},success:function(e){0==e.code?"function"==typeof i&&i():o.$util.showToast({title:e.message,duration:2e3})}})}})},orderPayFinal:function(e,t){var i=this,o="/presale/api/order/pay",r={id:e.id};""==e.final_out_trade_no&&(o="/presale/api/ordercreate/finalCreate",r.is_balance=this.isBalance),this.$api.sendRequest({url:o,data:r,success:function(e){i.isSub=!1,e.code>=0?0==i.payMoney?i.$util.redirectTo("/otherpages/pay/result/result",{code:e.data},"redirectTo"):i.$refs.choosePaymentPopup.getPayInfo(e.data):i.$util.showToast({title:e.message}),i.isBalance=0},fail:function(e){i.isSub=!1}})},orderPayDeposit:function(e,t){var i=this;this.$api.sendRequest({url:"/presale/api/order/pay",data:{id:e.id},success:function(e){i.isSub=!1,e.code>=0?i.$refs.choosePaymentPopup.getPayInfo(e.data):i.$util.showToast({title:e.message})},fail:function(e){i.isSub=!1}})},openPaymentPopup:function(t,i){this.payType=i,"final_money"==i?""==t.final_out_trade_no&&(this.payMoney=t.order_money-t.presale_deposit_money):"presale_deposit_money"==i&&(this.payMoney=t.pay_deposit_money),e.setStorageSync("paySource","presale"),this.$refs.choosePaymentPopup.open()}}};t.default=i}).call(this,i("543d")["default"])},d609:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:""};t.lang=o},d736:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"砸金蛋"};t.lang=o},d78b:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{showTop:!1,scrollTop:0,oldLocation:0}},methods:{scrollToTopNative:function(){e.pageScrollTo({duration:200,scrollTop:0})}},onReachBottom:function(){this.$refs.goodrecommend&&this.$refs.goodrecommend.getLikeList(10)},onPageScroll:function(e){this.oldLocation=e.scrollTop,e.scrollTop>400?this.showTop=!0:this.showTop=!1}};t.default=i}).call(this,i("543d")["default"])},d7b9:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的预售",emptyTips:"暂无相关预售订单",update:"释放刷新",updateIng:"加载中..."};t.lang=o},d7ea:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},d7f6:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"订单列表",emptyTips:"暂无相关订单",all:"全部",waitPay:"待付款",readyDelivery:"待发货",waitDelivery:"待收货",waitEvaluate:"待评价",update:"释放刷新",updateIng:"加载中..."};t.lang=o},d978:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(i("66fd")),r=s(i("2f62")),a=s(i("3631"));function s(e){return e&&e.__esModule?e:{default:e}}o.default.use(r.default);var n=new r.default.Store({state:{siteState:1,showToastValue:{title:"",icon:"",duration:1500},tabbarList:{},cartNumber:0,themeStyle:"",Development:1,addonIsExit:{bundling:0,coupon:0,discount:0,fenxiao:0,gift:0,groupbuy:0,manjian:0,memberconsume:0,memberrecharge:0,memberregister:0,membersignin:0,memberwithdraw:0,memberrecommend:0,pintuan:0,pointexchange:0,seckill:0,store:0,topic:0,bargain:0,membercancel:0,servicer:0,supermember:0,giftcard:0,divideticket:0,scenefestival:0,birthdaygift:0,pinfan:0},sourceMember:0,authInfo:{},paySource:"",token:null,diySeckillInterval:null,isGoodsGroupChange:0,groupTitle:"",shareConfiguration:{},flRefresh:0},mutations:{setSiteState:function(e,t){e.siteState=t},setCartNumber:function(e,t){e.cartNumber=t},setThemeStyle:function(e,t){e.themeStyle=t},setAddonIsexit:function(e,t){e.addonIsExit=Object.assign(e.addonIsExit,t)},updateShowToastValue:function(e,t){e.showToastValue=t},setTabbarList:function(e,t){e.tabbarList=t},setToken:function(e,t){e.token=t},setAuthinfo:function(e,t){e.authInfo=t},setSourceMember:function(e,t){e.sourceMember=t},setPaySource:function(e,t){e.paySource=t},setDiySeckillInterval:function(e,t){e.diySeckillInterval=t},setIsGoodsGroupChange:function(e,t){e.isGoodsGroupChange=t},setGroupTitle:function(e,t){e.groupTitle=t},shareConfigurationse:function(e,t){e.shareConfiguration=t},setflRefresh:function(e,t){e.flRefresh=t}},actions:{init:function(){var t=this;return e.getStorageSync("setThemeStyle")&&this.commit("setThemeStyle",e.getStorageSync("setThemeStyle")),e.getStorageSync("memberAddonIsExit")&&this.commit("setAddonIsexit",e.getStorageSync("memberAddonIsExit")),e.getStorageSync("bottomNav")&&this.commit("setTabbarList",e.getStorageSync("bottomNav")),new Promise((function(i,o){a.default.sendRequest({url:"/api/config/init",success:function(o){var r=o.data;r&&(t.commit("setCartNumber",r.cart_count),t.commit("setThemeStyle",r.style_theme),e.setStorageSync("setThemeStyle",r.style_theme),e.setStorageSync("memberAddonIsExit",r.addon_is_exit),t.commit("setAddonIsexit",r.addon_is_exit),t.commit("setTabbarList",r.diy_bottom_nav),e.setStorageSync("default_img",JSON.stringify(r.default_img)),e.setStorageSync("copyright",JSON.stringify(r.copyright)),i(r))}})}))},getCartNumber:function(){var t=this;if(e.getStorageSync("token"))return new Promise((function(e,i){a.default.sendRequest({url:"/api/cart/count",success:function(i){0==i.code&&(t.commit("setCartNumber",i.data),e(i.data))}})}));this.commit("setCartNumber",0)},shareConfigurationse:function(e){var t=this;a.default.sendRequest({url:"/weapp/api/weapp/share",success:function(e){e.code>=0&&t.commit("shareConfiguration","111")}})},getThemeStyle:function(){var t=this;e.getStorageSync("setThemeStyle")&&this.commit("setThemeStyle",e.getStorageSync("setThemeStyle")),a.default.sendRequest({url:"/api/diyview/style",success:function(i){0==i.code&&(t.commit("setThemeStyle",i.data.style_theme),e.setStorageSync("setThemeStyle",i.data.style_theme))}})},getAddonIsexit:function(){var t=this;return e.getStorageSync("memberAddonIsExit")&&this.commit("setAddonIsexit",e.getStorageSync("memberAddonIsExit")),new Promise((function(i,o){a.default.sendRequest({url:"/api/addon/addonisexit",success:function(o){0==o.code&&(e.setStorageSync("memberAddonIsExit",o.data),t.commit("setAddonIsexit",o.data),i(o.data))}})}))},getTabbarList:function(){var t=this;return e.getStorageSync("bottomNav")&&this.commit("setTabbarList",e.getStorageSync("bottomNav")),new Promise((function(i,o){a.default.sendRequest({url:"/api/diyview/bottomNav",success:function(o){var r=o.data;r&&r.value&&r.value.length&&(t.commit("setTabbarList",JSON.parse(r.value)),e.setStorageSync("bottomNav",r.value),i(o.data))}})}))},defaultImg:function(){a.default.sendRequest({url:"/api/config/defaultimg",success:function(t){var i=t.data;0==t.code&&i&&e.setStorageSync("default_img",JSON.stringify(i))}})}}}),d=n;t.default=d}).call(this,i("543d")["default"])},db30:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a")),r=a(i("9374"));i("319c");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,o,r,a,s){try{var n=e[a](s),d=n.value}catch(c){return void i(c)}n.done?t(d):Promise.resolve(d).then(o,r)}function n(e){return function(){var t=this,i=arguments;return new Promise((function(o,r){var a=e.apply(t,i);function n(e){s(a,o,r,n,d,"next",e)}function d(e){s(a,o,r,n,d,"throw",e)}n(void 0)}))}}var d={data:function(){return{skuId:0,groupId:0,pintuan_id:0,goodsSkuDetail:{goods_id:0,goods_service:[]},cartCount:0,whetherCollection:0,swiperInterval:1,swiperAutoplay:!1,swiperCurrent:1,switchMedia:"img",token:"",isIphoneX:!1,poster:"-1",posterMsg:"",posterHeight:0,goodsEvaluate:{member_headimg:"",member_name:"",content:"",images:[],create_time:0,sku_name:""},pintuanList:[],currentPintuan:{headimg:"",timeMachine:{}},openPopup:!1,memberId:0,contactData:{title:"",path:"",img:""},detailTab:0,service:{},goodsCircle:!1,timestamp:"",newList:[],evaluateConfig:{evaluate_audit:1,evaluate_show:0,evaluate_status:1},kefuConfig:{},isCommunity:!1,videoContext:"",source_member:0}},onLoad:function(t){var i=this;return n(o.default.mark((function r(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i.pintuan_id=t.pintuan_id||0,t.id&&(i.pintuan_id=t.id),i.groupId=t.group_id||0,i.isIphoneX=i.$util.uniappIsIPhoneX(),t.source_member&&e.setStorageSync("source_member",t.source_member),t.source_member&&(i.source_member=t.source_member),t.scene&&(a=decodeURIComponent(t.scene),a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(i.pintuan_id=t.split("-")[1]),-1!=t.indexOf("group_id")&&(i.group_id=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1])}))),i.getService(),o.next=10,i.getGoodsSkuDetail();case 10:i.getEvaluateConfig(),i.getPintuanGroupList();case 12:case"end":return o.stop()}}),r)})))()},onShow:function(){this.$langConfig.refresh(),this.token=e.getStorageSync("token"),""!=this.token&&(this.getCartCount(),this.getMemberId()),this.getKekuConfig(),this.modifyGoodsInfo(),this.videoContext=e.createVideoContext("goodsVideo"),e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},methods:{goConnect:function(){if(e.getStorageSync("token")){var t={sku_id:this.goodsSkuDetail.sku_id,type:"pintuan",type_id:this.goodsSkuDetail.pintuan_id};return this.$util.redirectTo("/otherpages/chat/room/room",t),!1}this.source_member?this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id+"&source_member="+this.source_member):this.$refs.login.open("/pages/goods/detail/detail?sku_id="+this.goodsSkuDetail.sku_id)},getGoodsSkuDetail:function(){var e=this;return n(o.default.mark((function t(){var i,a,s,n,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.sendRequest({url:"/pintuan/api/goods/detail",async:!1,data:{pintuan_id:e.pintuan_id}});case 2:if(i=t.sent,a=i.data,null!=a.goods_sku_detail){if(e.goodsSkuDetail=a.goods_sku_detail,e.skuId=e.goodsSkuDetail.sku_id,e.goodsSkuDetail.group_id=e.groupId,e.goodsSkuDetail.end_time-i.timestamp>0?e.goodsSkuDetail.timeMachine=e.$util.countDown(e.goodsSkuDetail.end_time-i.timestamp):(e.$util.showToast({title:"活动已结束"}),setTimeout((function(){e.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.goodsSkuDetail.sku_id},"redirectTo")}),1e3)),e.goodsSkuDetail.video_url&&(e.switchMedia="video"),e.goodsSkuDetail.sku_images?e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.split(","):e.goodsSkuDetail.sku_images=[],e.goodsSkuDetail.goods_spec_format&&e.goodsSkuDetail.goods_image&&(e.goodsSkuDetail.goods_image=e.goodsSkuDetail.goods_image.split(","),e.goodsSkuDetail.sku_images=e.goodsSkuDetail.sku_images.concat(e.goodsSkuDetail.goods_image)),e.goodsSkuDetail.unit=e.goodsSkuDetail.unit||"件",e.goodsSkuDetail.show_price=0==e.goodsSkuDetail.group_id?e.goodsSkuDetail.promotion_price:e.goodsSkuDetail.pintuan_price,e.goodsSkuDetail.save_price=e.goodsSkuDetail.price-e.goodsSkuDetail.show_price>0?(e.goodsSkuDetail.price-e.goodsSkuDetail.show_price).toFixed(2):0,e.goodsSkuDetail.sku_spec_format&&(e.goodsSkuDetail.sku_spec_format=JSON.parse(e.goodsSkuDetail.sku_spec_format)),e.goodsSkuDetail.goods_attr_format)for(s=JSON.parse(e.goodsSkuDetail.goods_attr_format),e.goodsSkuDetail.goods_attr_format=e.$util.unique(s,"attr_id"),n=0;n<e.goodsSkuDetail.goods_attr_format.length;n++)for(d=0;d<s.length;d++)e.goodsSkuDetail.goods_attr_format[n].attr_id==s[d].attr_id&&e.goodsSkuDetail.goods_attr_format[n].attr_value_id!=s[d].attr_value_id&&(e.goodsSkuDetail.goods_attr_format[n].attr_value_name+="、"+s[d].attr_value_name);e.goodsSkuDetail.goods_spec_format&&(e.goodsSkuDetail.goods_spec_format=JSON.parse(e.goodsSkuDetail.goods_spec_format)),e.$langConfig.title(e.goodsSkuDetail.goods_name),e.goodsSkuDetail.goods_content&&(e.goodsSkuDetail.goods_content=(0,r.default)(e.goodsSkuDetail.goods_content)),e.contactData={title:e.goodsSkuDetail.sku_name,path:"/promotionpages/pintuan/detail/detail?pintuan_id="+e.pintuan_id,img:e.$util.img(e.goodsSkuDetail.sku_image,{size:"big"})},""!=e.token&&e.getWhetherCollection(),e.setWechatShare(),e.$refs.loadingCover&&e.$refs.loadingCover.hide(),e.goodsSyncToGoodsCircle()}else e.$util.redirectTo("/pages/index/index/index",{},"reLaunch");case 5:case"end":return t.stop()}}),t)})))()},refreshGoodsSkuDetail:function(e){var t=this;Object.assign(this.goodsSkuDetail,e),this.goodsSkuDetail.unit=this.goodsSkuDetail.unit||"件",this.swiperCurrent>this.goodsSkuDetail.sku_images.length&&(this.swiperAutoplay=!0,this.swiperCurrent=1,setTimeout((function(){t.swiperAutoplay=!1}),40))},goHome:function(){this.$util.redirectTo("/pages/index/index/index",{},"reLaunch")},goCart:function(){this.$util.redirectTo("/pages/goods/cart/cart",{},"reLaunch")},pintuan:function(){var t=this,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.getStorageSync("token")?(i&&this.resetPrice(),this.$refs.goodsSku.show("pintuan",(function(){t.resetPrice(),t.getCartCount()}))):this.source_member?this.$refs.login.open("/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id)},buyNow:function(){var t=this;e.getStorageSync("token")?this.$refs.goodsSku.show("buy_now",(function(){t.getCartCount()})):this.source_member?this.$refs.login.open("/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id)},swiperChange:function(e){this.swiperCurrent=e.detail.current+1},onCommunity:function(){this.isCommunity=!0},onCloseCommunity:function(){this.isCommunity=!1},openMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.open()},closeMerchantsServicePopup:function(){this.$refs.merchantsServicePopup.close()},openAttributePopup:function(){this.$refs.attributePopup.open()},closeAttributePopup:function(){this.$refs.attributePopup.close()},getGoodsEvaluate:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/firstinfo",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i&&(e.goodsEvaluate=i,e.goodsEvaluate.forEach((function(t,i){e.goodsEvaluate[i].images&&(e.goodsEvaluate[i].images=e.goodsEvaluate[i].images.split(",")),1==e.goodsEvaluate[i].is_anonymous&&(e.goodsEvaluate[i].member_name=e.goodsEvaluate[i].member_name.replace(e.goodsEvaluate[i].member_name.substring(1,e.goodsEvaluate[i].member_name.length-1),"***"))})))}})},previewEvaluate:function(t,i){for(var o=[],r=0;r<this.goodsEvaluate[i].length;r++)o.push(this.$util.img(this.goodsEvaluate[i][r]));e.previewImage({current:t,urls:o})},getWhetherCollection:function(){var e=this;this.$api.sendRequest({url:"/api/goodscollect/iscollect",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){e.whetherCollection=t.data}})},editCollection:function(){var e=this;this.token?0==this.whetherCollection?this.$api.sendRequest({url:"/api/goodscollect/add",data:{sku_id:this.skuId,goods_id:this.goodsSkuDetail.goods_id,sku_name:this.goodsSkuDetail.sku_name,sku_price:this.goodsSkuDetail.show_price,sku_image:this.goodsSkuDetail.sku_image},success:function(t){var i=t.data;i>0&&(e.whetherCollection=1)}}):this.$api.sendRequest({url:"/api/goodscollect/delete",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;i>0&&(e.whetherCollection=0)}}):this.source_member?this.$refs.login.open("/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id+"&source_member="+this.source_member):this.$refs.login.open("/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id)},getCartCount:function(){var e=this;this.$store.dispatch("getCartNumber").then((function(t){e.cartCount=t}))},modifyGoodsInfo:function(){this.$api.sendRequest({url:"/api/goods/modifyclicks",data:{sku_id:this.skuId},success:function(e){}}),this.$api.sendRequest({url:"/api/goodsbrowse/add",data:{goods_id:this.goodsSkuDetail.goods_id,sku_id:this.skuId},success:function(e){}})},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},openPosterPopup:function(){var t=this;this.getGoodsPoster(),this.$refs.sharePopup.close(),this.$refs.posterPopup.open(),"-1"!=this.poster&&setTimeout((function(){var i=e.createSelectorQuery().in(t).select(".poster-layer .image-wrap");i.fields({size:!0},(function(e){var i=e.width,o=parseFloat((740/i).toFixed(2));t.token,t.posterHeight=parseInt(1100/o)})).exec()}),100)},closePosterPopup:function(){this.$refs.posterPopup.close()},getGoodsPoster:function(){var e=this,t={id:this.goodsSkuDetail.id};this.memberId&&(t.source_member=this.memberId),this.$api.sendRequest({url:"/pintuan/api/goods/poster",data:{page:"/promotionpages/pintuan/detail/detail",qrcode_param:JSON.stringify(t)},success:function(t){0==t.code?e.poster=t.data.path+"?time="+(new Date).getTime():e.posterMsg=t.message}})},previewMedia:function(t){for(var i=[],o=0;o<this.goodsSkuDetail.sku_images.length;o++)i.push(this.$util.img(this.goodsSkuDetail.sku_images[o],{size:"big"}));e.previewImage({current:t,urls:i})},getPintuanGroupList:function(){var e=this;this.$api.sendRequest({url:"/pintuan/api/pintuangroup/lists",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){var i=t.data;if(e.timestamp=t.timestamp,null!=i&&i.length){e.pintuanList=i;for(var o=0;o<e.pintuanList.length;o++)e.pintuanList[o]["end_time"]>t.timestamp?(e.pintuanList[o].timeMachine=e.$util.countDown(e.pintuanList[o]["end_time"]-t.timestamp),e.pintuanList[o].currentTime=t.timestamp):e.pintuanList[o].timeMachine=null;e.newList=e.pintuanList.filter((function(e){return e.end_time>t.timestamp})),e.$forceUpdate()}}})},openPinTuan:function(e,t,i,o,r){var a=this;this.memberId!=r?(this.openPopup=!0,this.currentPintuan={groupId:e,pintuan_num:t,timeMachine:this.$util.countDown(i),headimg:o},this.$refs.pintuanPopup.open((function(){a.goodsSkuDetail.group_id=0,a.openPopup=!1}))):this.$util.showToast({title:"您不能参与自己的团"})},closePinTuanPopup:function(){this.$refs.pintuanPopup.close()},joinPintuan:function(){this.closePinTuanPopup(),this.goodsSkuDetail.group_id=this.currentPintuan.groupId,this.goodsSkuDetail.show_price=this.goodsSkuDetail.pintuan_price,this.goodsSkuDetail.save_price=this.goodsSkuDetail.price-this.goodsSkuDetail.show_price>0?(this.goodsSkuDetail.price-this.goodsSkuDetail.show_price).toFixed(2):0,this.$forceUpdate(),this.pintuan(!1)},swiperImageError:function(e){this.goodsSkuDetail.sku_images[e]=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},pintuanImageError:function(e){this.pintuanList[e].headimg=this.$util.getDefaultImage().default_headimg,this.$forceUpdate()},saveGoodsPoster:function(){var t=this,i=this.$util.img(this.poster);e.downloadFile({url:i,success:function(i){200===i.statusCode&&e.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(){t.$util.showToast({title:"保存成功"})},fail:function(){t.$util.showToast({title:"保存失败，请稍后重试"})}})}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data,e.setWechatShare())}})},getService:function(){var e=this;this.$api.sendRequest({url:"/api/goods/aftersale",success:function(t){0==t.code&&t.data&&(e.service=t.data)}})},setWechatShare:function(){},goodsSyncToGoodsCircle:function(){var e=this;this.$api.sendRequest({url:"/goodscircle/api/goods/sync",data:{goods_id:this.goodsSkuDetail.goods_id},success:function(t){0==t.code&&(e.goodsCircle=!0)}})},openBusinessView:function(){var e=this;wx.openBusinessView&&wx.openBusinessView({businessType:"friendGoodsRecommend",extraData:{product:{item_code:this.goodsSkuDetail.goods_id,title:this.goodsSkuDetail.sku_name,image_list:this.goodsSkuDetail.sku_images.map((function(t){return e.$util.img(t)}))}},success:function(e){console.log("success",e)},fail:function(e){console.log("fail",e)}})},getEvaluateConfig:function(){var e=this;this.$api.sendRequest({url:"/api/goodsevaluate/config",success:function(t){if(0==t.code){var i=t.data;e.evaluateConfig=i,1==e.evaluateConfig.evaluate_show&&e.getGoodsEvaluate()}}})},copyUrl:function(){var e=this,t=this.$config.h5Domain+"/promotionpages/pintuan/detail/detail?pintuan_id="+this.pintuan_id+"&group_id="+this.groupId;this.memberId&&(t+="&source_member="+this.memberId),this.$util.copy(t,(function(){e.closeSharePopup()}))},getKekuConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/servicer",success:function(t){0==t.code&&(e.kefuConfig=t.data,e.kefuConfig.system&&!e.addonIsExit.servicer&&(e.kefuConfig.system=0))}})},toEvaluateDetail:function(e){this.$util.redirectTo("/otherpages/goods/evaluate/evaluate",{goods_id:e})},resetPrice:function(){this.goodsSkuDetail.group_id=0,this.goodsSkuDetail.show_price=this.goodsSkuDetail.promotion_price,this.goodsSkuDetail.save_price=this.goodsSkuDetail.price-this.goodsSkuDetail.show_price>0?(this.goodsSkuDetail.price-this.goodsSkuDetail.show_price).toFixed(2):0,this.$forceUpdate()},showImg:function(t){for(var i=t.target.dataset.nodes,o=[],r=0;r<i.length;r++)for(var a=i[r].children,s=0;s<a.length;s++)a[s].attrs&&a[s].attrs.src&&o.push(a[s].attrs.src);e.previewImage({current:o,urls:o})}}};t.default=d}).call(this,i("543d")["default"])},dd96:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{listStyle:"",loadingType:"loading",orderType:"",priceOrder:"desc",categoryList:[],goodsList:[],order:"",sort:"desc",showCategory:!1,showScreen:!1,keyword:"",categoryId:0,minPrice:"",maxPrice:"",isFreeShipping:!1,isIphoneX:!1,emptyShow:!1}},onLoad:function(e){this.categoryId=e.category_id||0,this.keyword=e.keyword||"",this.loadCategoryList(this.categoryId),this.isIphoneX=this.$util.uniappIsIPhoneX()},onShow:function(){this.$langConfig.refresh()},methods:{getGoodsList:function(e){var t=this;this.$api.sendRequest({url:"/fenxiao/api/goods/page",data:{page:e.num,page_size:e.size,keyword:this.keyword,category_id:this.categoryId,min_price:this.minPrice,max_price:this.maxPrice,is_free_shipping:this.isFreeShipping?1:0,order:this.order,sort:this.sort},success:function(i){var o=[],r=i.message;0==i.code&&i.data?(0==i.data.page_count&&(t.emptyShow=!0),o=i.data.list):t.$util.showToast({title:r}),e.endSuccess(o.length),1==e.num&&(t.goodsList=[]),t.goodsList=t.goodsList.concat(o),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(i){e.endErr(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},changeListStyle:function(){this.listStyle?this.listStyle="":this.listStyle="largest"},loadCategoryList:function(e,t){var i=this;this.$api.sendRequest({url:"/api/goodscategory/tree",data:{},success:function(e){null!=e.data&&(i.categoryList=e.data)}})},sortTabClick:function(e){if("sales"==e)this.order="sale_num",this.sort="desc";else if("discount_price"==e)this.order="discount_price",this.sort="desc";else{if("screen"==e)return void(this.showScreen=!0);this.order="",this.sort=""}this.orderType===e&&"discount_price"!==e||(this.orderType=e,"discount_price"===e?(this.priceOrder="asc"===this.priceOrder?"desc":"asc",this.sort=this.priceOrder):this.priceOrder="",this.$refs.mescroll.refresh())},navToDetailPage:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e.sku_id})},search:function(){this.emptyShow=!1,this.goodsList=[],this.$refs.mescroll.refresh()},selectedCategory:function(e){this.categoryId=e},screenData:function(){if(""!=this.minPrice||""!=this.maxPrice){if(!Number(this.minPrice)&&this.minPrice)return void this.$util.showToast({title:"请输入最低价"});if(!Number(this.maxPrice)&&this.maxPrice)return void this.$util.showToast({title:"最输入最高价"});if(Number(this.minPrice)<0||Number(this.maxPrice)<0)return void this.$util.showToast({title:"筛选价格不能小于0"});if(""!=this.minPrice&&Number(this.minPrice)>Number(this.maxPrice)&&this.maxPrice)return void this.$util.showToast({title:"最低价不能大于最高价"});if(""!=this.maxPrice&&Number(this.maxPrice)<Number(this.minPrice))return void this.$util.showToast({title:"最高价不能小于最低价"})}this.emptyShow=!1,this.goodsList=[],this.$refs.mescroll.refresh(),this.showScreen=!1},imageError:function(e){this.goodsList[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},followGoods:function(e,t,i){var o=this;this.$api.sendRequest({url:"/fenxiao/api/goodscollect/add",data:{goods_id:t,sku_id:i},success:function(t){var i="";i=t.code>=0?"关注成功":t.message,o.$util.showToast({title:i}),o.goodsList[e].is_collect=1}})},delFollow:function(e,t){var i=this;this.$api.sendRequest({url:"/fenxiao/api/goodscollect/delete",data:{collect_id:e},success:function(e){var o="";o=0==e.code?"取消成功":e.message,i.$util.showToast({title:o});var r=i.goodsList;r[t].is_collect=0,i.goodsList=r}})},resetData:function(){this.categoryId=0,this.minPrice="",this.maxPrice="",this.isFreeShipping=!1}}};t.default=o},ddb2:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"邀请好友"};t.lang=o},e00f:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"商品评价"};t.lang=o},e01b:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"待付款订单"};t.lang=o},e0aa:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={down:{textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",offset:80,native:!1},up:{textLoading:"加载中 ...",textNoMore:"",offset:80,isBounce:!1,toTop:{src:"http://www.mescroll.com/img/mescroll-totop.png?v=1",offset:1e3,right:20,bottom:120,width:72},empty:{use:!0,icon:"http://www.mescroll.com/img/mescroll-empty.png?v=1",tip:"~ 暂无相关数据 ~"}}},r=o;t.default=r},e0b7:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"修改头像"};t.lang=o},e279:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,is_point:1,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""},is_open_card:0,member_card_unit:""},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,manjian:[],storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},post_free:{},canLocalDelicery:!0,deliveryWeek:"",out_trade_no:null,judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/pages/order/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;if(!this.out_trade_no){this.orderCreateData=e.getStorageSync("orderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.orderCreateData.cart_ids&&this.orderCreateData.jielong_id?this.$api.sendRequest({url:"/jielong/api/cart/goodsLists",data:{jielong_id:this.orderCreateData.jielong_id},success:function(e){if(0==e.data.length)return t.$util.redirectTo("/pages/index/index/index",{},"reLaunch"),!1;t.dingdna()}}):this.dingdna()}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))}},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.is_point=1,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);var i=this.orderPaymentData;if(i.recommend_member_card&&(this.orderCreateData.member_card_unit=Object.keys(i.recommend_member_card.charge_rule)[0]),void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(i.shop_goods_list.promotion.manjian.manjian_info.rule){var d=i.shop_goods_list.promotion.manjian.manjian_info;this.manjian=d;var c=0==d.type?"元":"件";Object.keys(d.rule).forEach((function(e){var i=d.rule[e];if(i.dataList)for(var o=0;o<i.coupon_data.length;o++)i.coupon_data[o].coupon_num=i.coupon_num[o];if(i.limit=0==d.type?parseFloat(i.limit).toFixed(2):parseInt(i.limit),void 0!=i.discount_money&&(void 0==t.manjian.manjian?t.manjian.manjian="购买可享受满"+i.limit+c+"减"+i.discount_money+"元":t.manjian.manjian+="；满"+i.limit+c+"减"+i.discount_money+"元"),void 0!=i.point||void 0!=i.coupon){var r="",a="";void 0!=i.point&&(a="可得"+i.point+"积分"),void 0!=i.coupon&&void 0!=i.coupon_data&&i.coupon_data.forEach((function(e,t){"discount"==e.type?""==r?r="送"+i.coupon_num[t]+"张"+parseFloat(e.discount)+"折优惠券":r+="、送"+i.coupon_num[t]+"张"+parseFloat(e.discount)+"折优惠券":""==r?r="送"+i.coupon_num[t]+"张"+parseFloat(e.money)+"元优惠券":r+="、送"+i.coupon_num[t]+"张"+parseFloat(e.money)+"元优惠券"})),void 0==t.manjian.point_text?t.manjian.point_text="购物满"+i.limit+c+a:t.manjian.point_text+="；满"+i.limit+c+a,void 0==t.manjian.mansong?t.manjian.mansong="购物满"+i.limit+c+r:t.manjian.mansong+="；满"+i.limit+c+r}void 0!=i.free_shipping&&void 0==t.manjian.free_shipping&&(t.manjian.free_shipping="购物满"+i.limit+c+"包邮")}))}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var l=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;l.length&&(this.orderCreateData.invoice_content=l[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var u=this.orderPaymentData.shop_goods_list.local_config.info.time_week,h=!1,f=0;f<u.length;f++)if(f+1<u.length){var p=u[f+1]-u[f];if(p>1){h=!0;break}}var m=["周日","周一","周二","周三","周四","周五","周六"];if(h){var _=[];for(f=0;f<u.length;f++)_.push(m[u[f]]);this.deliveryWeek=_.join("、")}else this.deliveryWeek=m[u[0]]+"至"+m[u[u.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var g=(new Date).getHours().toString(),y=(new Date).getMinutes().toString();1==g.length&&(g="0"+g),1==y.length&&(y="0"+y),this.orderCreateData.buyer_ask_delivery_time=g+":"+y;var v=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(v);var b=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(b);var D=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp).replace(/-/g,"/")),S=D.getHours(),k=D.getMinutes(),C=parseInt(this.timeInfo.start_time.split(":")[0]),P=parseInt(this.timeInfo.start_time.split(":")[1]),$=parseInt(this.timeInfo.end_time.split(":")[0]),w=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(C==$&&P==w||((S<C||S==C&&k<P)&&(this.orderCreateData.buyer_ask_delivery_time=(1==C.toString().length?"0"+C:C)+":"+(1==P.toString().length?"0"+P:P)),(S>$||S==$&&k>w)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";i.system_form&&(this.orderPaymentData.system_form=i.system_form),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.point_money=t.data.point_money,e.orderPaymentData.member_card_money=t.data.member_card_money,e.orderPaymentData.shop_goods_list.promotion=t.data.shop_goods_list.promotion,e.orderPaymentData.shop_goods_list.coupon_list=t.data.shop_goods_list.coupon_list,e.orderPaymentData.shop_goods_list.goods_list=t.data.shop_goods_list.goods_list,e.orderPaymentData.shop_goods_list.max_usable_point=t.data.shop_goods_list.max_usable_point,0==e.orderPaymentData.shop_goods_list.coupon_list.length&&(e.orderCreateData.coupon={}),e.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},dingdna:function(){var e=this;this.$api.sendRequest({url:"/api/ordercreate/payment",data:this.orderCreateData,success:function(t){t.code>=0?(e.post_free=t.data.shop_goods_list.promotion,e.orderPaymentData=t.data,e.orderPaymentData.timestamp=t.timestamp,e.handlePaymentData(),e.$refs.loadingCover&&e.$refs.loadingCover.hide()):(e.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(t){e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else{var o=e.getStorageSync("orderCreateData");o.out_trade_no=t.data,e.setStorageSync("orderCreateData",o),i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1}else""==t.data&&i.$util.showToast({title:t.message}),i.isSub=!1;i.getCartNumber()},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if("店铺未开启配送时间"==this.deliveryWeek)return this.$util.showToast({title:"店铺未设置配送时间"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}if(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())return!1;if(this.orderPaymentData.system_form){var c=this.$refs.form.verify();if(!c)return!1}return!0},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},openSiteCoupon:function(){this.tempData={coupon:this.$util.deepClone(this.orderPaymentData.coupon)},this.$refs.couponPopup.open()},selectCoupon:function(e){this.orderCreateData.coupon.coupon_id!=e.coupon_id?(this.orderCreateData.coupon.coupon_id=e.coupon_id,this.orderCreateData.coupon.coupon_money=e.money):(this.orderCreateData.coupon.coupon_id=0,this.orderCreateData.coupon.coupon_money="0.00"),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},usePoint:function(){this.orderCreateData.is_point?this.orderCreateData.is_point=0:this.orderCreateData.is_point=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},getCartNumber:function(){e.getStorageSync("token")&&this.$store.dispatch("getCartNumber")},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this,i=JSON.parse(JSON.stringify(this.orderCreateData));if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:JSON.parse(JSON.stringify(this.$refs.form.verify()))};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/api/ordercreate/verifyarea",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},selectMemberCard:function(e){this.orderCreateData.is_open_card=1==this.orderCreateData.is_open_card?0:1,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},selectMembercardUnit:function(e){this.orderCreateData.member_card_unit=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate()},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};console.log(i,"obj"),this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login");var t=e.getStorageSync("orderCreateData");t&&t.out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.judge=!0,this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)},promotionExits:function(){return!!this.orderPaymentData.shop_goods_list.promotion&&(!!this.orderPaymentData.shop_goods_list.promotion.manjian&&!!this.orderPaymentData.shop_goods_list.promotion.manjian.manjian_info)},promotionList:function(){return this.orderPaymentData.shop_goods_list.promotion},cardChargeType:function(){if(this.orderPaymentData.recommend_member_card){var e=[],t=this.orderPaymentData.recommend_member_card.charge_rule;return Object.keys(t).forEach((function(i,o){switch(i){case"week":e.push({key:i,value:t[i],title:"周卡",unit:"周"});break;case"month":e.push({key:i,value:t[i],title:"月卡",unit:"月"});break;case"quarter":e.push({key:i,value:t[i],title:"季卡",unit:"季"});break;case"year":e.push({key:i,value:t[i],title:"年卡",unit:"年"});break}})),e}}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)},promotion:function(e){var t=[];return e&&Object.keys(e).forEach((function(i){e[i];switch(i){case"manjian":t.push("满减送");break;case"freeshipping":t.push("满额包邮");break}})),t.join(" ")}}};t.default=i}).call(this,i("543d")["default"])},e48c:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=["zh-cn","en-us"],r=e.getStorageSync("lang")||"zh-cn",a={langList:["zh-cn","en-us"],lang:function(e){var t=getCurrentPages()[getCurrentPages().length-1];if(t){var o,a="";try{var s=i("822c")("./"+r+"/common.js").lang,n=t.route.split("/");o=n.slice(1,n.length-1);var d=i("12d5")("./"+r+"/"+o.join("/")+".js").lang;for(var c in d)s[c]=d[c];var l=e.split(".");if(l.length>1)for(var u in l){var h=parseInt(u)+1;h<l.length&&(a=s[l[u]][l[h]])}else a=s[e]}catch(p){a=-1!=e.indexOf("common.")||-1!=e.indexOf("tabBar.")?s[e]:e}if(arguments.length>1)for(var f=1;f<arguments.length;f++)a=a.replace("{"+(f-1)+"}",arguments[f]);return(void 0==a||"title"==a&&"title"==e)&&(a=""),a}},change:function(t){var i=getCurrentPages()[getCurrentPages().length-1];i&&(e.setStorageSync("lang",t),r=e.getStorageSync("lang")||"zh-cn",this.refresh(),e.reLaunch({url:"/pages/member/index/index"}))},refresh:function(){var t=getCurrentPages()[getCurrentPages().length-1];t&&(this.title(this.lang("title")),e.setTabBarItem({index:0,text:this.lang("tabBar.home")}),e.setTabBarItem({index:1,text:this.lang("tabBar.category")}),e.setTabBarItem({index:2,text:this.lang("tabBar.cart")}),e.setTabBarItem({index:3,text:this.lang("tabBar.member")}))},title:function(t){t&&e.setNavigationBarTitle({title:t})},list:function(){var e=[];try{for(var t=0;t<o.length;t++){var r=i("822c")("./"+o[t]+"/common.js").lang;e.push({name:r.common.name,value:o[t]})}}catch(a){}return e}};t.default=a}).call(this,i("543d")["default"])},e65d:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{fenxiaoWords:{}}},methods:{getFenxiaoWrods:function(){var t=this;this.$api.sendRequest({url:"/fenxiao/api/config/words",success:function(i){i.code>=0&&i.data&&(t.fenxiaoWords=i.data,e.setStorageSync("fenxiaoWords",i.data))}})}},onShow:function(){e.getStorageSync("fenxiaoWords")&&(this.fenxiaoWords=e.getStorageSync("fenxiaoWords")),this.getFenxiaoWrods()}};t.default=i}).call(this,i("543d")["default"])},e72d:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{info:null,timeMachine:null,page:1,goodsList:[],cart:{},totalPrice:0,totalNum:0,goodsSkuDetail:null,skuList:[],cartShow:!1,isSub:!1,token:null,memberId:0}},onLoad:function(t){var i=this;if(t.id&&(this.id=t.id),t.scene){var o=decodeURIComponent(t.scene);o=o.split("&"),o.length&&o.forEach((function(e){-1!=e.indexOf("id")&&(i.id=e.split("-")[1])}))}if(t.source_member&&e.setStorageSync("source_member",t.source_member),t.scene){o=decodeURIComponent(t.scene);o=o.split("&"),o.length&&o.forEach((function(t){-1!=t.indexOf("sku_id")&&(i.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&e.setStorageSync("source_member",t.split("-")[1]),-1!=t.indexOf("is_test")&&e.setStorageSync("is_test",1)}))}this.getBaleInfo(),this.getMemberId()},onShow:function(){e.getStorageSync("token")&&e.getStorageSync("source_member")&&this.$util.onSourceMember(e.getStorageSync("source_member"))},methods:{getBaleInfo:function(){var e=this;this.$api.sendRequest({url:"/bale/api/bale/detail",data:{bale_id:this.id},success:function(t){0==t.code?(e.info=t.data,e.info?1==e.info.status?e.timeMachine=e.$util.countDown(e.info.end_time-t.timestamp):2==e.info.status&&(e.$util.showToast({title:"该活动已关闭"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index")}),1500)):(e.$util.showToast({title:"未找到活动"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index")}),1500))):(e.$util.showToast({title:"未找到活动"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index")}),1500))},fail:function(t){e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},getMemberId:function(){var e=this;this.$api.sendRequest({url:"/api/member/id",success:function(t){t.code>=0&&(e.memberId=t.data)}})},getGoodsList:function(e){var t=this;this.$api.sendRequest({url:"/api/goodssku/page",data:{page:e.num,page_size:e.size,goods_id_arr:this.info.goods_ids},success:function(i){t.$refs.loadingCover&&t.$refs.loadingCover.hide();var o=[],r=i.message;0==i.code&&i.data?(0==i.data.page_count&&(t.emptyShow=!0),o=i.data.list):t.$util.showToast({title:r}),e.endSuccess(o.length),1==e.num&&(t.goodsList=[]),t.goodsList=t.goodsList.concat(o),t.$refs.loadingCover&&t.$refs.loadingCover.hide()},fail:function(i){e.endErr(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},imageError:function(e){this.goodsList[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},singleSkuPlus:function(e){if(void 0!=this.cart["goods_"+e.goods_id]){var t=this.cart["goods_"+e.goods_id].num;if(t+1>e.stock)return void this.$util.showToast({title:"库存不足"});this.cart["goods_"+e.goods_id].num+=1,this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num+=1}else this.cart["goods_"+e.goods_id]={num:1},this.cart["goods_"+e.goods_id]["sku_"+e.sku_id]=e,this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num=1;this.totalNum+=1,this.cart=Object.assign({},this.cart)},singleSkuReduce:function(e){if(void 0!=this.cart["goods_"+e.goods_id]){var t=this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num;this.cart["goods_"+e.goods_id].num-=1,this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num-=1,this.totalNum-=1,t-1==0&&(delete this.cart["goods_"+e.goods_id]["sku_"+e.sku_id],1==Object.keys(this.cart["goods_"+e.goods_id]).length&&delete this.cart["goods_"+e.goods_id]),this.cart=Object.assign({},this.cart)}},manySkuSelect:function(e){var t=this;this.$api.sendRequest({url:"/api/goodssku/detail",data:{sku_id:e.sku_id},success:function(e){0==e.code&&null!=e.data.goods_sku_detail&&(t.goodsSkuDetail=e.data.goods_sku_detail,t.goodsSkuDetail.bale_id=t.id,t.goodsSkuDetail.sku_spec_format&&(t.goodsSkuDetail.sku_spec_format=JSON.parse(t.goodsSkuDetail.sku_spec_format)),t.goodsSkuDetail.goods_spec_format&&(t.goodsSkuDetail.goods_spec_format=JSON.parse(t.goodsSkuDetail.goods_spec_format)),t.goodsSkuDetail.sku_images=t.goodsSkuDetail.sku_images.split(","),t.goodsSkuDetail.unit=t.goodsSkuDetail.unit||"件",t.goodsSkuDetail.show_price=t.goodsSkuDetail.price,t.goodsSkuDetail.activity_sku_ids=t.info.sku_ids.split(","),setTimeout((function(){t.$refs.goodsSku.show("bale",(function(){}))}),100))}})},refreshGoodsSkuDetail:function(e){Object.assign(this.goodsSkuDetail,e)},joinCart:function(e){void 0!=this.cart["goods_"+e.goods_id]?void 0!=this.cart["goods_"+e.goods_id]["sku_"+e.sku_id]?(this.cart["goods_"+e.goods_id].num+=e.num-this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num,this.totalNum+=e.num-this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num,this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num=e.num):(this.cart["goods_"+e.goods_id]["sku_"+e.sku_id]=e.detail,this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num=e.num,this.cart["goods_"+e.goods_id].num+=e.num,this.totalNum+=e.num):(this.cart["goods_"+e.goods_id]={num:e.num},this.cart["goods_"+e.goods_id]["sku_"+e.sku_id]=e.detail,this.cart["goods_"+e.goods_id]["sku_"+e.sku_id].num=e.num,this.totalNum+=e.num),this.cart=Object.assign({},this.cart),this.$refs.goodsSku.hide()},openCartPopup:function(){this.skuList.length&&(this.cartShow=!this.cartShow)},closeCartPopup:function(){this.cartShow=!1},clearCart:function(){this.cart={},this.totalNum=0,this.closeCartPopup()},submit:function(){var t=this;if(e.getStorageSync("token")){if(this.isSub)return;this.isSub=!0;var i=[];this.skuList.forEach((function(e){i.push({sku_id:e.sku_id,num:e.num})})),e.setStorage({key:"baleOrderCreateData",data:{bale_id:this.id,sku_list_json:JSON.stringify(i)},success:function(){t.isSub=!1,t.$util.redirectTo("/promotionpages/bale/payment/payment")}})}else setTimeout((function(){t.$refs.login.open("/promotionpages/bale/detail/detail?id="+t.id)}))}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)},sku:function(e){var t="";return e&&(t=e.sku_name.replace(e.goods_name,"")),t}},watch:{cart:{deep:!0,handler:function(e,t){var i=[],o=1;for(var r in this.cart){var a=this.cart[r];for(var s in a)if(-1==s.indexOf("num")){var n=a[s];n.start=o,n.end=o+n.num,i.push(a[s]),o+=n.num}}this.skuList=i}},totalNum:function(e){if(e>0)if(e%this.info.num==0)this.totalPrice=this.info.price*(e/this.info.num);else{for(var t=Math.floor(e/this.info.num),i=parseFloat(t*this.info.price),o=t*this.info.num,r=0;r<e%this.info.num;r++){o+=1;for(var a=0;a<this.skuList.length;a++){var s=this.skuList[a];if(o>=s.start&&o<s.end){i+=parseFloat(s.price);break}}}this.totalPrice=i}else this.totalPrice=0}},onShareAppMessage:function(){var e=this.$util.getCurrentShareRoute(this.memberId),t=e.path;return{title:"这些商品"+this.info.price+"元任选"+this.info.num+"件",imageUrl:"",path:t,success:function(e){},fail:function(e){}}},onShareTimeline:function(){var e="这些商品"+this.info.price+"元任选"+this.info.num+"件",t=this.$util.getCurrentShareRoute(this.memberId),i=t.query;return{title:e,query:i,imageUrl:""}}};t.default=i}).call(this,i("543d")["default"])},e7b0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"积分明细",emptyTpis:"您暂时还没有积分记录哦!",pointExplain:"积分说明"};t.lang=o},e7db:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(i("bc6f"));function o(e){return e&&e.__esModule?e:{default:e}}var r={data:function(){return{rule:[{}],hasSign:0,signDaysSeries:0,timestamp:"",time:"",MonthData:[],signList:[],back:"",redirect:"",successTip:{},startDate:null,endDate:null,isActive:"",signState:1,headimg:"",point:0,growth:0,signPoint:0,signGrowth:0,rewardRuleDay:[],cycle:0}},methods:{getSignPointData:function(){var e=this;this.$api.sendRequest({url:"/api/memberaccount/sum",data:{account_type:"point",from_type:"signin"},success:function(t){0==t.code&&(e.signPoint=t.data)}})},getSignGrowthData:function(){var e=this;this.$api.sendRequest({url:"/api/memberaccount/sum",data:{account_type:"growth",from_type:"signin"},success:function(t){0==t.code&&(e.signGrowth=t.data)}})},getSignState:function(){var e=this;this.$api.sendRequest({url:"/api/membersignin/getSignStatus",success:function(t){0==t.code&&(e.signState=t.data.is_use)}})},navigateBack:function(){""!=this.back?this.$util.redirectTo(this.back,{},this.redirect):this.$util.redirectTo("/pages/member/index/index",{},"reLaunch")},getRule:function(){var e=this;this.$api.sendRequest({url:"/api/membersignin/award",success:function(t){if(0==t.code){e.cycle=t.data.cycle,e.rule=t.data.reward,e.rule.length>1&&e.rule.forEach((function(t,i){i&&e.rewardRuleDay.push(parseInt(t.day))}));for(var i=[],o=1;o<=t.data.cycle;o++)i.push({day:o});e.showSignDays=i}}})},getSignInfo:function(){var e=this;this.$api.sendRequest({url:"/api/member/info",success:function(t){0==t.code&&(e.timestamp=t.timestamp,e.time=e.$util.timeStampTurnTime(e.timestamp).slice(0,10),e.headimg=t.data.headimg,e.signDaysSeries=t.data.sign_days_series,e.$refs.loadingCover.hide())}})},getIsSign:function(){var e=this;this.$api.sendRequest({url:"/api/membersignin/issign",success:function(t){0==t.code&&(e.hasSign=t.data,e.getSignInfo(),e.getSignPointData(),e.getSignGrowthData())}})},sign:function(){var e=this;0==this.signState&&this.$util.showToast({title:"签到未开启"}),this.hasSign||1!=this.signState||this.$api.sendRequest({url:"/api/membersignin/signin",success:function(t){0==t.code?(e.successTip=t.data,e.$refs.uniPopup.open(),e.getSignInfo(),e.getSignPointData(),e.getSignGrowthData(),e.hasSign=1,e.signDaysSeries=e.signDaysSeries+1):e.$util.showToast({title:t.message})}})},close:function(){this.$refs.uniPopup.close()}},computed:{pointTomorrow:function(){for(var e=this.signDaysSeries+1,t=this.rule[0].point?parseInt(this.rule[0].point):0,i=1;i<this.rule.length;i++){var o=this.rule[i];o.day==e&&o.point&&(t+=parseInt(o.point))}return t},showDay:function(){return 7*parseInt(this.signDaysSeries/7)+1}}};t.default=r},e8f3:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"搜索",history:"历史搜索",hot:"热门搜索",find:"搜索发现",hidefind:"当前搜索发现已隐藏",inputPlaceholder:"搜索商品"};t.lang=o},eb5e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"核销明细"};t.lang=o},ed97:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我要咨询"};t.lang=o},ee67:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,is_point:1,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""},is_open_card:0,member_card_unit:""},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,manjian:[],storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},post_free:{},canLocalDelicery:!0,deliveryWeek:"",out_trade_no:null}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/otherpages/blindBox/fillAddress/fillAddress",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;if(!this.out_trade_no){this.orderCreateData=e.getStorageSync("blindOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))}},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.is_point=1,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);var i=this.orderPaymentData;if(i.recommend_member_card&&(this.orderCreateData.member_card_unit=Object.keys(i.recommend_member_card.charge_rule)[0]),void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(void 0!=i.shop_goods_list.coupon_list&&void 0!=i.shop_goods_list.coupon_list[0]){var n=i.shop_goods_list.coupon_list;this.orderCreateData.coupon.coupon_id=n[0].coupon_id,this.orderCreateData.coupon.coupon_money=n[0].money}if(i.shop_goods_list.promotion.manjian.manjian_info.rule){var d=i.shop_goods_list.promotion.manjian.manjian_info;this.manjian=d;var c=0==d.type?"元":"件";Object.keys(d.rule).forEach((function(e){var i=d.rule[e];if(i.dataList)for(var o=0;o<i.coupon_data.length;o++)i.coupon_data[o].coupon_num=i.coupon_num[o];if(i.limit=0==d.type?parseFloat(i.limit).toFixed(2):parseInt(i.limit),void 0!=i.discount_money&&(void 0==t.manjian.manjian?t.manjian.manjian="购买可享受满"+i.limit+c+"减"+i.discount_money+"元":t.manjian.manjian+="；满"+i.limit+c+"减"+i.discount_money+"元"),void 0!=i.point||void 0!=i.coupon){var r="",a="";void 0!=i.point&&(a="可得"+i.point+"积分"),void 0!=i.coupon&&void 0!=i.coupon_data&&i.coupon_data.forEach((function(e,t){"discount"==e.type?""==r?r="送"+i.coupon_num[t]+"张"+parseFloat(e.discount)+"折优惠券":r+="、送"+i.coupon_num[t]+"张"+parseFloat(e.discount)+"折优惠券":""==r?r="送"+i.coupon_num[t]+"张"+parseFloat(e.money)+"元优惠券":r+="、送"+i.coupon_num[t]+"张"+parseFloat(e.money)+"元优惠券"})),void 0==t.manjian.point_text?t.manjian.point_text="购物满"+i.limit+c+a:t.manjian.point_text+="；满"+i.limit+c+a,void 0==t.manjian.mansong?t.manjian.mansong="购物满"+i.limit+c+r:t.manjian.mansong+="；满"+i.limit+c+r}void 0!=i.free_shipping&&void 0==t.manjian.free_shipping&&(t.manjian.free_shipping="购物满"+i.limit+c+"包邮")}))}if(this.goodsInfo.is_virtual&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var l=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;l.length&&(this.orderCreateData.invoice_content=l[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0)if(7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length)this.deliveryWeek="全天";else{this.timeInfo.showTime=!0;for(var u=this.orderPaymentData.shop_goods_list.local_config.info.time_week,h=!1,f=0;f<u.length;f++)if(f+1<u.length){var p=u[f+1]-u[f];if(p>1){h=!0;break}}var m=["周日","周一","周二","周三","周四","周五","周六"];if(h){var _=[];for(f=0;f<u.length;f++)_.push(m[u[f]]);this.deliveryWeek=_.join("、")}else this.deliveryWeek=m[u[0]]+"至"+m[u[u.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var g=(new Date).getHours().toString(),y=(new Date).getMinutes().toString();1==g.length&&(g="0"+g),1==y.length&&(y="0"+y),this.orderCreateData.buyer_ask_delivery_time=g+":"+y;var v=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(v);var b=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(b);var D=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),S=D.getHours(),k=D.getMinutes(),C=parseInt(this.timeInfo.start_time.split(":")[0]),P=parseInt(this.timeInfo.start_time.split(":")[1]),$=parseInt(this.timeInfo.end_time.split(":")[0]),w=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(C==$&&P==w||((S<C||S==C&&k<P)&&(this.orderCreateData.buyer_ask_delivery_time=(1==C.toString().length?"0"+C:C)+":"+(1==P.toString().length?"0"+P:P)),(S>$||S==$&&k>w)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";i.system_form&&(this.orderPaymentData.system_form=i.system_form),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.coupon_money=t.data.coupon_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.point_money=t.data.point_money,e.orderPaymentData.member_card_money=t.data.member_card_money,e.orderPaymentData.shop_goods_list.promotion=t.data.shop_goods_list.promotion,e.orderPaymentData.shop_goods_list.coupon_list=t.data.shop_goods_list.coupon_list,e.orderPaymentData.shop_goods_list.goods_list=t.data.shop_goods_list.goods_list,e.orderPaymentData.shop_goods_list.max_usable_point=t.data.shop_goods_list.max_usable_point,0==e.orderPaymentData.shop_goods_list.coupon_list.length&&(e.orderCreateData.coupon={}),e.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},dingdna:function(){var e=this;this.$api.sendRequest({url:"/api/ordercreate/payment",data:this.orderCreateData,success:function(t){t.code>=0?(e.post_free=t.data.shop_goods_list.promotion,e.orderPaymentData=t.data,e.orderPaymentData.timestamp=t.timestamp,e.handlePaymentData(),console.log("0000"),e.$refs.loadingCover&&e.$refs.loadingCover.hide()):(e.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){e.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(t){e.$refs.loadingCover&&e.$refs.loadingCover.hide()}})},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/api/ordercreate/create",data:o,success:function(t){e.hideLoading(),t.code>=0?0==i.orderPaymentData.pay_money?i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo"):(i.out_trade_no=t.data,i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1):(""==t.data&&i.$util.showToast({title:t.message}),i.isSub=!1),i.getCartNumber()},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.goodsInfo.is_virtual){if(!this.member_address.mobile)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if("店铺未开启配送时间"==this.deliveryWeek)return this.$util.showToast({title:"店铺未设置配送时间"}),!1;if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}if(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())return!1;if(this.orderPaymentData.system_form){var c=this.$refs.form.verify();if(!c)return!1}return!0},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},openSiteCoupon:function(){this.tempData={coupon:this.$util.deepClone(this.orderPaymentData.coupon)},this.$refs.couponPopup.open()},selectCoupon:function(e){console.log(e),this.orderCreateData.coupon.coupon_id!=e.coupon_id?(this.orderCreateData.coupon.coupon_id=e.coupon_id,this.orderCreateData.coupon.coupon_money=e.money):(this.orderCreateData.coupon.coupon_id=0,this.orderCreateData.coupon.coupon_money="0.00"),Object.assign(this.orderPaymentData,this.orderCreateData),this.$forceUpdate()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},usePoint:function(){this.orderCreateData.is_point?this.orderCreateData.is_point=0:this.orderCreateData.is_point=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},getCartNumber:function(){e.getStorageSync("token")&&this.$store.dispatch("getCartNumber")},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0],this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderCreateData.taxpayer_number="",this.orderCreateData.invoice_content="",this.orderCreateData.invoice_full_address="",this.orderCreateData.invoice_email="",this.orderCalculate(),this.$forceUpdate(),this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this,i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/api/ordercreate/verifyarea",data:i,success:function(i){i.code>=0?(e.setStorageSync("paySource",""),t.verify()&&(t.subscribeMessage(),t.$refs.choosePaymentPopup.open())):1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},subscribeMessage:function(){var t="ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY";this.orderCreateData.delivery&&"store"==this.orderCreateData.delivery.delivery_type&&(t="ORDER_PAY,ORDER_TAKE_DELIVERY"),this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:t},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},selectMemberCard:function(e){this.orderCreateData.is_open_card=1==this.orderCreateData.is_open_card?0:1,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate()},selectMembercardUnit:function(e){this.orderCreateData.member_card_unit=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate()}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)},promotionExits:function(){return!!this.orderPaymentData.shop_goods_list.promotion&&(!!this.orderPaymentData.shop_goods_list.promotion.manjian&&!!this.orderPaymentData.shop_goods_list.promotion.manjian.manjian_info)},promotionList:function(){return this.orderPaymentData.shop_goods_list.promotion},cardChargeType:function(){if(this.orderPaymentData.recommend_member_card){var e=[],t=this.orderPaymentData.recommend_member_card.charge_rule;return Object.keys(t).forEach((function(i,o){switch(i){case"week":e.push({key:i,value:t[i],title:"周卡",unit:"周"});break;case"month":e.push({key:i,value:t[i],title:"月卡",unit:"月"});break;case"quarter":e.push({key:i,value:t[i],title:"季卡",unit:"季"});break;case"year":e.push({key:i,value:t[i],title:"年卡",unit:"年"});break}})),e}}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)},promotion:function(e){var t=[];return e&&Object.keys(e).forEach((function(i){e[i];switch(i){case"manjian":t.push("满减送");break;case"freeshipping":t.push("满额包邮");break}})),t.join(" ")}}};t.default=i}).call(this,i("543d")["default"])},ef62:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的关注"};t.lang=o},efbd:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"拼团分享"};t.lang=o},f0c5:function(e,t,i){"use strict";function o(e,t,i,o,r,a,s,n,d,c){var l,u="function"===typeof e?e.options:e;if(d){u.components||(u.components={});var h=Object.prototype.hasOwnProperty;for(var f in d)h.call(d,f)&&!h.call(u.components,f)&&(u.components[f]=d[f])}if(c&&((c.beforeCreate||(c.beforeCreate=[])).unshift((function(){this[c.__module]=this})),(u.mixins||(u.mixins=[])).push(c)),t&&(u.render=t,u.staticRenderFns=i,u._compiled=!0),o&&(u.functional=!0),a&&(u._scopeId="data-v-"+a),s?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=l):r&&(l=n?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var p=u.render;u.render=function(e,t){return l.call(t),p(e,t)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,l):[l]}return{exports:e,options:u}}i.d(t,"a",(function(){return o}))},f23e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"余额明细"};t.lang=o},f471:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{isIphoneX:!1,orderCreateData:{is_balance:0,pay_password:"",is_invoice:0,invoice_type:1,invoice_title_type:1,is_tax_invoice:0,invoice_title:"",taxpayer_number:"",invoice_content:"",invoice_full_address:"",invoice_email:"",member_address:{mobile:""}},orderPaymentData:{shop_goods_list:{site_name:"",express_type:[],coupon_list:[],invoice:{invoice_content_array:[]}},seckill_info:{name:""},member_account:{balance:0,is_pay_password:0},delivery:{delivery_type:""},member_address:{mobile:""},local_config:{info:{start_time:0,end_time:0,time_week:[]}}},isSub:!1,tempData:null,storeInfo:{storeList:[],currStore:{}},member_address:{mobile:""},timeInfo:{week:0,start_time:0,end_time:0,showTime:!1,showTimeBar:!1},canLocalDelicery:!0,deliveryWeek:"",judge:!0}},methods:{openPopup:function(e){this.$refs[e].open()},closePopup:function(e){this.tempData&&(Object.assign(this.orderCreateData,this.tempData),Object.assign(this.orderPaymentData,this.tempData),this.tempData=null,this.$forceUpdate()),this.$refs[e].close()},selectAddress:function(){var e={back:"/promotionpages/seckill/payment/payment",local:0,type:1};"local"==this.orderPaymentData.delivery.delivery_type&&(e.local=1,e.type=2),this.$util.redirectTo("/otherpages/member/address/address",e)},getOrderPaymentData:function(){var t=this;this.orderCreateData=e.getStorageSync("seckillOrderCreateData");var i=e.getStorageSync("pay_flag");if(this.orderCreateData){var o=this.$util.getLocation();o&&(this.orderCreateData=Object.assign(this.orderCreateData,o));var r=e.getStorageSync("store");r&&(this.orderCreateData.default_store_id=r.store_id),this.$api.sendRequest({url:"/seckill/api/ordercreate/payment",data:this.orderCreateData,success:function(e){e.code>=0?(t.orderPaymentData=e.data,t.orderPaymentData.timestamp=e.timestamp,t.handlePaymentData(),t.$refs.loadingCover&&t.$refs.loadingCover.hide()):(t.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})}else 1==i?e.removeStorageSync("pay_flag"):(this.$util.showToast({title:"未获取到创建订单所需数据！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"reLaunch")}),1500))},handlePaymentData:function(){var t=this;this.orderCreateData.delivery={},this.orderCreateData.coupon={},this.orderCreateData.buyer_message="",this.orderCreateData.is_balance=0,this.orderCreateData.pay_password="",this.orderCreateData.is_invoice=0,this.orderCreateData.invoice_type=1,this.orderCreateData.invoice_title_type=1,this.orderCreateData.is_tax_invoice=0,this.orderCreateData.invoice_title="",this.orderPaymentData.shop_goods_list.invoice&&(this.orderPaymentData.shop_goods_list.invoice.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type.split(","),this.orderCreateData.invoice_type=this.orderPaymentData.shop_goods_list.invoice.invoice_type[0]);var i=this.orderPaymentData;if(void 0!=i.shop_goods_list.express_type&&void 0!=i.shop_goods_list.express_type[0]){var o=i.shop_goods_list.express_type;this.orderCreateData.delivery.store_id=0;var r=e.getStorageSync("delivery");if(r){var a=r.name,s=r.title;"store"==a&&(i.shop_goods_list.express_type.forEach((function(e){"store"==e.name&&t.storeSelected(e)})),this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""})}else{a=o[0].name;"store"==a&&(this.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""});s=o[0].title}this.orderCreateData.delivery.delivery_type=a,this.orderCreateData.delivery.delivery_type_name=s,"store"==o[0].name&&this.storeSelected(o[0])}if(this.orderPaymentData.is_virtual&&(this.orderCreateData.member_address={mobile:""!=i.member_account.mobile?i.member_account.mobile:""}),this.orderPaymentData.shop_goods_list.invoice){var n=this.orderPaymentData.shop_goods_list.invoice.invoice_content_array;n.length&&(this.orderCreateData.invoice_content=n[0])}if(0==this.orderPaymentData.is_virtual)if(this.orderPaymentData.shop_goods_list.local_config.info&&1==this.orderPaymentData.shop_goods_list.local_config.info.time_is_open){if(this.timeInfo.showTimeBar=!0,0==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||7==this.orderPaymentData.shop_goods_list.local_config.info.time_week.length||this.orderPaymentData.shop_goods_list.local_config.info.time_week.indexOf(this.timeInfo.week)>-1?this.canLocalDelicery=!0:this.canLocalDelicery=!1,0==this.orderPaymentData.shop_goods_list.local_config.info.time_type)this.deliveryWeek="全天";else if(this.orderPaymentData.shop_goods_list.local_config.info.time_week.length>0){this.timeInfo.showTime=!0;for(var d=this.orderPaymentData.shop_goods_list.local_config.info.time_week,c=!1,l=0;l<d.length;l++)if(l+1<d.length){var u=d[l+1]-d[l];if(u>1){c=!0;break}}var h=["周日","周一","周二","周三","周四","周五","周六"];if(c){var f=[];for(l=0;l<d.length;l++)f.push(h[d[l]]);this.deliveryWeek=f.join("、")}else this.deliveryWeek=h[d[0]]+"至"+h[d[d.length-1]]}else this.deliveryWeek="店铺未设置配送时间";var p=(new Date).getHours().toString(),m=(new Date).getMinutes().toString();1==p.length&&(p="0"+p),1==m.length&&(m="0"+m),this.orderCreateData.buyer_ask_delivery_time=p+":"+m;var _=this.orderPaymentData.shop_goods_list.local_config.info.start_time;this.timeInfo.start_time=this.getTimeStr(_);var g=this.orderPaymentData.shop_goods_list.local_config.info.end_time;this.timeInfo.end_time=this.getTimeStr(g);var y=new Date(this.$util.timeStampTurnTime(this.orderPaymentData.timestamp)),v=y.getHours(),b=y.getMinutes(),D=parseInt(this.timeInfo.start_time.split(":")[0]),S=parseInt(this.timeInfo.start_time.split(":")[1]),k=parseInt(this.timeInfo.end_time.split(":")[0]),C=parseInt(this.timeInfo.end_time.split(":")[1]);this.canLocalDelicery&&(D==k&&S==C||((v<D||v==D&&b<S)&&(this.orderCreateData.buyer_ask_delivery_time=(1==D.toString().length?"0"+D:D)+":"+(1==S.toString().length?"0"+S:S)),(v>k||v==k&&b>C)&&(this.canLocalDelicery=!1)))}else this.deliveryWeek="店铺未开启配送时间";Object.assign(this.orderPaymentData,this.orderCreateData),this.orderPaymentData.shop_goods_list.goods_list.forEach((function(e){e.sku_spec_format?e.sku_spec_format=JSON.parse(e.sku_spec_format):e.sku_spec_format=[]})),this.orderCalculate()},getTimeStr:function(e){var t=parseInt(e/3600).toString(),i=parseInt(e%3600/60).toString();return 1==i.length&&(i="0"+i),1==t.length&&(t="0"+t),t+":"+i},orderCalculate:function(){var e=this,t=this.$util.deepClone(this.orderCreateData);t.delivery=JSON.stringify(t.delivery),t.coupon=JSON.stringify(t.coupon),"store"==this.orderCreateData.delivery.delivery_type?t.member_address=JSON.stringify(this.member_address):t.member_address=JSON.stringify(t.member_address),this.$api.sendRequest({url:"/seckill/api/ordercreate/calculate",data:t,success:function(t){t.code>=0?(e.orderPaymentData.member_address=t.data.member_address,e.orderPaymentData.delivery_money=t.data.delivery_money,e.orderPaymentData.invoice_money=t.data.invoice_money,e.orderPaymentData.invoice_delivery_money=t.data.shop_goods_list.invoice_delivery_money,e.orderPaymentData.promotion_money=t.data.promotion_money,e.orderPaymentData.order_money=t.data.order_money,e.orderPaymentData.balance_money=t.data.balance_money,e.orderPaymentData.pay_money=t.data.pay_money,e.orderPaymentData.goods_money=t.data.goods_money,e.orderPaymentData.shop_goods_list.delivery=t.data.shop_goods_list.delivery,e.orderPaymentData.shop_goods_list.delivery_store_info=t.data.shop_goods_list.delivery_store_info,e.judge&&("store"==e.orderPaymentData.delivery.delivery_type?e.storetime("no"):"local"==e.orderPaymentData.delivery.delivery_type&&e.localtime("no"),e.judge=!1),e.createBtn(),e.$forceUpdate()):e.$util.showToast({title:t.message})}})},createBtn:function(){return!("local"==this.orderPaymentData.delivery.delivery_type&&this.orderPaymentData.shop_goods_list.delivery&&this.orderPaymentData.shop_goods_list.delivery.error&&this.orderPaymentData.shop_goods_list.delivery.start_money>this.orderPaymentData.shop_goods_list.goods_money)&&("local"!=this.orderPaymentData.delivery.delivery_type||!this.orderPaymentData.shop_goods_list.delivery||!this.orderPaymentData.shop_goods_list.delivery.error||""===this.orderPaymentData.shop_goods_list.delivery.error)},orderCreate:function(t){var i=this;if(this.verify()){if(this.isSub)return;this.isSub=!0,t&&(this.orderCreateData.pay_password=t);var o=this.$util.deepClone(this.orderCreateData);if(o.delivery=JSON.stringify(o.delivery),o.coupon=JSON.stringify(o.coupon),"store"==this.orderCreateData.delivery.delivery_type?o.member_address=JSON.stringify(this.member_address):o.member_address=JSON.stringify(o.member_address),this.orderPaymentData.system_form){var r={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};o.form_data=JSON.stringify(r)}this.$api.sendRequest({url:"/seckill/api/ordercreate/create",data:o,success:function(t){if(e.hideLoading(),t.code>=0)if(0==i.orderPaymentData.pay_money){switch(i.orderCreateData.delivery.delivery_type){case"express":break;case"store":i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY");break;case"local":break;default:i.$util.subscribeMessage("ORDER_VERIFY_OUT_TIME,VERIFY_CODE_EXPIRE,VERIFY")}i.$util.redirectTo("/otherpages/pay/result/result",{code:t.data},"redirectTo")}else{var o=e.getStorageSync("seckillOrderCreateData");o.out_trade_no=t.data,e.setStorageSync("seckillOrderCreateData",o),i.$refs.choosePaymentPopup.getPayInfo(t.data),i.isSub=!1}else i.isSub=!1,10==t.data.error_code||12==t.data.error_code?e.showModal({title:"订单未创建",content:t.message,confirmText:"去设置",success:function(e){e.confirm&&i.selectAddress()}}):i.$util.showToast({title:t.message})},fail:function(t){e.hideLoading(),i.isSub=!1}})}},verify:function(){if(1==this.orderPaymentData.is_virtual){if(!this.orderCreateData.member_address.mobile.length)return this.$util.showToast({title:"请输入您的手机号码"}),!1;var e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.orderCreateData.member_address.mobile))return this.$util.showToast({title:"请输入正确的手机号码"}),!1}if(0==this.orderPaymentData.is_virtual){if("store"!=this.orderCreateData.delivery.delivery_type&&!this.orderPaymentData.member_address)return this.$util.showToast({title:"请先选择您的收货地址"}),!1;if("store"==this.orderCreateData.delivery.delivery_type){if(!this.orderCreateData.delivery.store_id)return this.$util.showToast({title:"没有可提货的门店,请选择其他配送方式"}),!1;if(!this.member_address.mobile)return this.$util.showToast({title:"请输入预留手机"}),!1;e=/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/;if(!e.test(this.member_address.mobile))return this.$util.showToast({title:"请输入正确的预留手机"}),!1}if("local"==this.orderCreateData.delivery.delivery_type){if(!this.canLocalDelicery)return this.$util.showToast({title:"本店已休息"}),!1;if(o!=a||r!=s){var t=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[0]),i=parseInt(this.orderCreateData.buyer_ask_delivery_time.split(":")[1]),o=parseInt(this.timeInfo.start_time.split(":")[0]),r=parseInt(this.timeInfo.start_time.split(":")[1]),a=parseInt(this.timeInfo.end_time.split(":")[0]),s=parseInt(this.timeInfo.end_time.split(":")[1]);if(t<o||t==o&&i<r)return this.$util.showToast({title:"送达时间不能小于配送开始时间"}),!1;if(!(t>o&&t<a||t==o&&i>r||t==o&&i>=r&&t<a))return this.$util.showToast({title:"送达时间范围：开始时间~结束时间"}),!1}}var n=!0;for(var d in this.orderCreateData.delivery){if("{}"==JSON.stringify(this.orderCreateData.delivery[d])){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"未设置配送方式'});break}if("store"==this.orderCreateData.delivery[d].delivery_type&&0==this.orderCreateData.delivery[d].store_id){n=!1,this.$util.showToast({title:'店铺"'+this.orderPaymentData.shop_goods_list[d].site_name+'"没有可提货的门店,请选择其他配送方式'});break}}if(!n)return!1}return!(1==this.orderCreateData.is_invoice&&!this.invoiceVerify())},openSitePromotion:function(){this.$refs.sitePromotionPopup.open()},openSiteDelivery:function(){this.tempData={delivery:this.$util.deepClone(this.orderPaymentData.delivery)},this.$refs.deliveryPopup.open()},selectDeliveryType:function(t){e.setStorageSync("delivery",{title:t.title,name:t.name}),this.orderCreateData.delivery.delivery_type=t.name,this.orderCreateData.delivery.delivery_type_name=t.title,"store"==t.name&&(this.storeSelected(t),this.member_address.mobile||(this.member_address.mobile=""!=this.orderPaymentData.member_account.mobile?this.orderPaymentData.member_account.mobile:"")),Object.assign(this.orderPaymentData,this.orderCreateData),this.judge=!0,this.orderCalculate(),this.$forceUpdate()},storeSelected:function(t){if(this.storeInfo.storeList=t.store_list,!(this.orderCreateData.delivery.store_id>0)){var i=e.getStorageSync("store");i&&t.store_id==i.store_id?(this.storeInfo.currStore=i,this.orderCreateData.delivery.store_id=this.storeInfo.currStore.store_id):void 0!=t.store_list[0]?(this.storeInfo.currStore=t.store_list[0],this.orderCreateData.delivery.store_id=t.store_list[0].store_id):this.storeInfo.currStore=null}},selectPickupPoint:function(e){this.orderCreateData.delivery.store_id=e.store_id,this.storeInfo.currStore=e,Object.assign(this.orderPaymentData,this.orderCreateData),this.orderCalculate(),this.$forceUpdate(),this.$refs["deliveryPopup"].close()},popupConfirm:function(e){this.orderCalculate(),this.$forceUpdate(),this.tempData=null,this.$refs[e].close()},useBalance:function(){this.orderCreateData.is_balance?this.orderCreateData.is_balance=0:this.orderCreateData.is_balance=1,this.orderCalculate(),this.$forceUpdate()},imageError:function(e){this.orderPaymentData.shop_goods_list.goods_list[e].sku_image=this.$util.getDefaultImage().default_goods_img,this.$forceUpdate()},changeIsInvoice:function(){0==this.orderCreateData.is_invoice?this.orderCreateData.is_invoice=1:this.orderCreateData.is_invoice=0,this.orderCalculate(),this.$forceUpdate()},changeInvoiceType:function(e){this.orderCreateData.invoice_type=e,this.orderCalculate(),this.$forceUpdate()},changeInvoiceTitleType:function(e){this.orderCreateData.invoice_title_type=e,this.orderCalculate(),this.$forceUpdate()},changeIsTaxInvoice:function(){0==this.orderCreateData.is_tax_invoice?this.orderCreateData.is_tax_invoice=1:this.orderCreateData.is_tax_invoice=0,this.$forceUpdate()},changeInvoiceContent:function(e){this.orderCreateData.invoice_content=e,this.$forceUpdate()},invoiceVerify:function(){if(!this.orderCreateData.invoice_title)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票抬头"}),!1;if(!this.orderCreateData.taxpayer_number&&2==this.orderCreateData.invoice_title_type)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写纳税人识别号"}),!1;if(1==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_full_address&&1==this.orderPaymentData.is_virtual)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写发票邮寄地址"}),!1;if(2==this.orderCreateData.invoice_type&&!this.orderCreateData.invoice_email)return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写邮箱"}),!1;if(2==this.orderCreateData.invoice_type){var e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.orderCreateData.invoice_email))return this.$refs.invoicePopup.open(),this.$util.showToast({title:"请填写正确的邮箱"}),!1}return!!this.orderCreateData.invoice_content||(this.$refs.invoicePopup.open(),this.$util.showToast({title:"请选择发票内容"}),!1)},saveInvoice:function(){1==this.orderCreateData.is_invoice?this.invoiceVerify()&&this.closePopup("invoicePopup"):this.closePopup("invoicePopup")},bindTimeChange:function(e){var t=e.detail.value;this.orderCreateData.buyer_ask_delivery_time=t,this.orderCalculate(),this.$forceUpdate()},getTime:function(){var e=["0","1","2","3","4","5","6"],t=(new Date).getDay();this.timeInfo.week=e[t]},closeInvoicePopup:function(){this.$refs.invoicePopup.close()},navigateTo:function(e){this.$util.redirectTo("/pages/goods/detail/detail",{sku_id:e})},openChoosePayment:function(){var t=this,i=this.$util.deepClone(this.orderCreateData);if(i.delivery=JSON.stringify(i.delivery),i.coupon=JSON.stringify(i.coupon),"store"==this.orderCreateData.delivery.delivery_type?i.member_address=JSON.stringify(this.member_address):i.member_address=JSON.stringify(i.member_address),this.orderPaymentData.system_form){var o={form_id:this.orderPaymentData.system_form.id,form_data:this.$util.deepClone(this.$refs.form.verify())};i.form_data=JSON.stringify(o)}this.$api.sendRequest({url:"/seckill/api/ordercreate/verifyareaorstock",data:i,success:function(i){if(i.code>=0){if(e.setStorageSync("paySource",""),t.verify()){switch(t.orderCreateData.delivery.delivery_type){case"express":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;case"store":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY");break;case"local":t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY,ORDER_DELIVERY");break;default:t.$util.subscribeMessage("ORDER_URGE_PAYMENT,ORDER_PAY")}t.$refs.choosePaymentPopup.open()}}else 1==i.data.error_code||11==i.data.error_code?t.$util.showToast({title:i.message}):10!=i.data.error_code&&12!=i.data.error_code||e.showModal({title:"订单未创建",content:i.message,confirmText:"去设置",success:function(e){e.confirm&&t.selectAddress()}})}})},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(t){t.data.length&&e.requestSubscribeMessage({tmplIds:t.data,success:function(e){},fail:function(e){console.log("fail",e)}})}})},localtime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={time_type:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_type,end_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).end_time,start_time:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).start_time,time_week:this.$util.deepClone(this.orderPaymentData.shop_goods_list.local_config.info).time_week},i={delivery:this.orderCreateData.delivery,dataTime:t};this.$refs.TimePopup.open(i,e)},storetime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.orderPaymentData.shop_goods_list.delivery_store_info){var t=JSON.parse(this.orderPaymentData.shop_goods_list.delivery_store_info),i={time_type:this.$util.deepClone(t).time_type,end_time:this.$util.deepClone(t).end_time,start_time:this.$util.deepClone(t).start_time,time_week:this.$util.deepClone(t).time_week},o={delivery:this.orderCreateData.delivery,dataTime:i};this.$refs.TimePopup.open(o,e),this.$forceUpdate()}},selectTime:function(e){if(e.data&&e.data.month){var t=new Date,i=t.getFullYear(),o=e.data.month.split("月"),r=o[0],a=o[1].split("日")[0];this.orderCreateData.buyer_ask_delivery_time=i+"-"+r+"-"+a+" "+e.data.time+":00","今天"==e.data.title||"明天"==e.data.title?this.orderCreateData.buyer_ask_delivery_title=e.data.title+"("+e.data.time+")":this.orderCreateData.buyer_ask_delivery_title=e.data.month+"("+e.data.time+")",this.orderCalculate(),this.$forceUpdate()}}},onShow:function(){this.$langConfig.refresh(),e.getStorageSync("addressBack")&&e.removeStorageSync("addressBack"),e.getStorageSync("token")?this.getOrderPaymentData():this.$util.redirectTo("/otherpages/login/login/login"),e.getStorageSync("seckillOrderCreateData")&&e.getStorageSync("seckillOrderCreateData").out_trade_no&&this.$util.redirectTo("/pages/order/list/list",{status:"waitpay"},"redirectTo"),this.judge=!0,this.getTime(),this.isIphoneX=this.$util.uniappIsIPhoneX()},onHide:function(){this.$refs.loadingCover&&this.$refs.loadingCover.show()},computed:{balanceDeduct:function(){return this.orderPaymentData.member_account.balance_total<=parseFloat(this.orderPaymentData.order_money).toFixed(2)?parseFloat(this.orderPaymentData.member_account.balance_total).toFixed(2):parseFloat(this.orderPaymentData.order_money).toFixed(2)}},filters:{moneyFormat:function(e){return parseFloat(e).toFixed(2)}}};t.default=i}).call(this,i("543d")["default"])},fd32:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"提现详情"};t.lang=o},ff13:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lang=void 0;var o={title:"我的消息"};t.lang=o}}]);