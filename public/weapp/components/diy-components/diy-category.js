(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/diy-components/diy-category"],{"098b":function(t,e,i){},"133d":function(t,e,i){"use strict";i.r(e);var n=i("4e21"),o=i("751d");for(var r in o)"default"!==r&&function(t){i.d(e,t,(function(){return o[t]}))}(r);i("db2b");var s,c=i("f0c5"),a=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=a.exports},"4e21":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var n={diyCategoryItem:function(){return i.e("components/diy-components/diy-category-item").then(i.bind(null,"8675"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.categoryTree&&!t.categoryTree.length?t.$util.img("public/uniapp/category/empty.png"):null);t._isMounted||(t.e0=function(e){return t.$util.redirectTo("/pages_tool/goods/search")},t.e1=function(e){return t.$util.redirectTo("/pages/goods/cart")}),t.$mp.data=Object.assign({},{$root:{g0:i}})},r=[]},"751d":function(t,e,i){"use strict";i.r(e);var n=i("e3c5"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=o.a},db2b:function(t,e,i){"use strict";var n=i("098b"),o=i.n(n);o.a},e3c5:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o,r,s=function(){Promise.all([i.e("common/vendor"),i.e("components/ns-goods-sku/ns-goods-sku-category")]).then(function(){return resolve(i("449f"))}.bind(null,i)).catch(i.oe)},c={components:{nsGoodsSkuCategory:s},name:"diy-category",props:{value:{type:Object,default:function(){return{}}}},data:function(){return{select:0,categoryId:"category-0",categoryTree:null,scrollLock:!1,triggered:!0,heightArea:[],isSub:!1,token:null,carIconList:{},endTips:0,cartAnimation:{},loadType:""}},created:function(){this.getCategoryTree(),this.$store.dispatch("getCartNumber"),this.token=t.getStorageSync("token"),this.loadType=1==this.value.goodsLevel&&"all"==this.value.loadType?"all":"part"},mounted:function(){var e=this;o=t.createSelectorQuery().in(this),o.select(".content-wrap").boundingClientRect((function(t){t&&(n=t.height)})).exec(),setTimeout((function(){o.select(".end-tips").boundingClientRect((function(t){t&&t.top>n&&(e.endTips=1)})).exec(),o.select(".cart-icon").boundingClientRect((function(t){t&&(r=t)})).exec(),1==e.value.template&&e.getHeightArea(-1)}),500)},computed:{cartMoney:function(){var t=parseFloat(this.$store.state.cartMoney).toFixed(2);return t.split(".")},cartNumber:function(){return this.$store.state.cartNumber}},methods:{pageShow:function(){this.$store.dispatch("getCartNumber"),this.token=t.getStorageSync("token"),this.heightArea.length||this.getHeightArea(-1)},getHeightArea:function(t){var e=[];o.selectAll(".content-wrap .child-category").boundingClientRect((function(t){t&&t.length&&t.forEach((function(t,i){0==i?e.push([0,t.height]):e.push([e[i-1][1],e[i-1][1]+t.height])}))})).exec(),this.heightArea=e,-1!=t&&t<this.categoryTree.length-1&&this.$refs.categoryItem[t+1].getGoodsList()},getCategoryTree:function(){var t=this;this.$api.sendRequest({url:"/api/goodscategory/tree",data:{level:3},success:function(e){0==e.code&&(t.categoryTree=e.data)}})},switchOneCategory:function(t){t>=this.categoryTree.length||(this.select=t,this.categoryId="category-"+t,this.scrollLock=!0)},touchStart:function(){this.scrollLock=!1},listenScroll:function(t){if(!this.scrollLock){var e=t.detail.scrollTop;if(this.heightArea.length){for(var i=0;i<this.heightArea.length;i++)if(e>=this.heightArea[i][0]&&e<=this.heightArea[i][1]){this.select=i;break}1!=this.value.template&&"all"==this.value.loadType&&this.heightArea[this.select][1]-e-n<300&&this.$refs.categoryItem[this.select].getGoodsList()}}},onRefresh:function(){this.triggered=!1},onRestore:function(){this.triggered="restore"},toLogin:function(){this.$emit("tologin")},selectSku:function(t,e){var i=this;this.$api.sendRequest({url:"/api/goodssku/getinfoforcategory",data:{sku_id:t.sku_id},success:function(t){var e=t.data;e.unit=e.unit||"ä»¶",e.show_price=e.discount_price,e.sku_spec_format&&(e.sku_spec_format=JSON.parse(e.sku_spec_format)),e.goods_spec_format&&(e.goods_spec_format=JSON.parse(e.goods_spec_format)),i.$refs.skuSelect.show("join_cart",e,(function(){}))}})},settlement:function(){var e=this,i=Object.keys(this.$store.state.cartList),n=[];i.length&&!this.isSub&&(this.isSub=!0,i.forEach((function(t){n.push(e.$store.state.cartList[t].cart_id)})),t.removeStorageSync("delivery"),t.setStorage({key:"orderCreateData",data:{cart_ids:n.toString()},success:function(){e.$util.redirectTo("/pages/order/payment"),e.isSub=!1}}))},addCartPoint:function(t,e){if(2==this.value.template||value.quickBuy){var i=(new Date).getTime();this.$set(this.carIconList,i,{left:t,top:e,index:0,bezierPos:this.$util.bezier([{x:t,y:e},{x:t-200,y:t-120},{x:r.left+10,y:r.top}],6).bezier_points,timer:null}),this.startAnimation(i)}},startAnimation:function(e){var i=this,n=this.carIconList[e].bezierPos,o=this.carIconList[e].index;this.carIconList[e].timer=setInterval((function(){if(o<6)i.carIconList[e].left=n[o].x,i.carIconList[e].top=n[o].y,o++;else{clearInterval(i.carIconList[e].timer),delete i.carIconList[e],i.$forceUpdate(),setTimeout((function(){i.$store.commit("setCartChange")}),100);var r=t.createAnimation({duration:200,timingFunction:"ease"});r.scale(1.2).step(),i.cartAnimation=r.export(),setTimeout((function(){r.scale(1).step(),i.cartAnimation=r.export()}),300)}}),50)}}};e.default=c}).call(this,i("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/diy-components/diy-category-create-component',
    {
        'components/diy-components/diy-category-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("133d"))
        })
    },
    [['components/diy-components/diy-category-create-component']]
]);
