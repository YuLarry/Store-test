(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages_promotion/bargain/launch"],{"1de8":function(i,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return e}));var e={uniCountDown:function(){return t.e("components/uni-count-down/uni-count-down").then(t.bind(null,"1339"))},uniPopup:function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"92aa"))},loadingCover:function(){return t.e("components/loading-cover/loading-cover").then(t.bind(null,"790a"))},nsLogin:function(){return t.e("components/ns-login/ns-login").then(t.bind(null,"2893"))}},o=function(){var i=this,n=i.$createElement,t=(i._self._c,i.$util.img("public/uniapp/bargain/bargain_background1.png")),e=i.$util.img("public/uniapp/bargain/bargain_background.png"),o=""==i.info.headimg?i.$util.img(i.$util.getDefaultImage().head):null,a=""!=i.info.headimg?i.$util.img(i.info.headimg):null,r=i._f("cover")(i.info.nickname),u=i.$util.img(i.info.sku_image,{size:"mid"}),c=i.$lang("common.currencySymbol"),g=i.$lang("common.currencySymbol"),s=i._f("moneyFormat")(i.info.curr_price),l=i.$util.img("public/uniapp/bargain/bargain_progress.png"),d=i.bargainRecord.length?i.__map(i.bargainRecord,(function(n,t){var e=i.__get_orig(n),o=t<4&&""==n.headimg?i.$util.img(i.$util.getDefaultImage().head):null,a=t<4&&""!=n.headimg?i.$util.img(n.headimg):null;return{$orig:e,g6:o,g7:a}})):null,p=i.$util.img("public/uniapp/bargain/bargain_left.png"),f=i.$util.img("public/uniapp/bargain/bargain_right.png"),h=i.$util.img("public/uniapp/bargain/bargain_kanjia.png"),m=i.$util.img("public/uniapp/bargain/bargain_friend.png"),b=i.$util.img("public/uniapp/bargain/bargain_good.png"),_=i.$util.img("public/uniapp/bargain/bargain_left.png"),$=i.$util.img("public/uniapp/bargain/bargain_right.png"),v=i.bargainRecord.length?i.__map(i.bargainRecord,(function(n,t){var e=i.__get_orig(n),o=""==n.headimg?i.$util.img(i.$util.getDefaultImage().head):null,a=""!=n.headimg?i.$util.img(n.headimg):null,r=i._f("cover")(n.nickname);return{$orig:e,g15:o,g16:a,f2:r}})):null,y=i.$util.img("public/uniapp/bargain/coin.png");i._isMounted||(i.e0=function(n){return i.$util.redirectTo("/pages_promotion/bargain/list")},i.e1=function(n){return i.$util.redirectTo("/pages_promotion/bargain/list")},i.e2=function(n){return i.$util.redirectTo("/pages_promotion/bargain/list")},i.e3=function(n){return i.$util.redirectTo("/pages_promotion/bargain/list")},i.e4=function(n){return i.$util.redirectTo("/pages_promotion/bargain/list")},i.e5=function(n){return i.$util.redirectTo("/pages_promotion/bargain/list")}),i.$mp.data=Object.assign({},{$root:{g0:t,g1:e,g2:o,g3:a,f0:r,g4:u,m0:c,m1:g,f1:s,g5:l,l0:d,g8:p,g9:f,g10:h,g11:m,g12:b,g13:_,g14:$,l1:v,g17:y}})},a=[]},"25b7":function(i,n,t){"use strict";var e=t("5b25"),o=t.n(e);o.a},"281c":function(i,n,t){"use strict";var e=t("5b7d"),o=t.n(e);o.a},4679:function(i,n,t){"use strict";(function(i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e=function(){Promise.all([t.e("common/vendor"),t.e("components/l-time/l-time")]).then(function(){return resolve(t("9050"))}.bind(null,t)).catch(t.oe)},o=function(){t.e("components/uni-popup/uni-popup").then(function(){return resolve(t("92aa"))}.bind(null,t)).catch(t.oe)},a={components:{LTime:e,uniPopup:o},data:function(){return{windowHeight:0,id:0,info:{headimg:""},bargainRecord:[],page:1,totalPage:1,load:!1,timeMachine:null,memberId:0,bargainMoney:"0.00",token:null}},onLoad:function(i){this.getHeight(),i.id&&(this.id=i.id)},computed:{cutMoney:function(){return this.info.price-this.info.curr_price},surplusMoney:function(){return this.info.curr_price-this.info.floor_price},progress:function(){var i=this.info.price-this.info.floor_price,n=parseInt(this.cutMoney/i*100);return isNaN(n)?0:n}},onShow:function(){var n=this;this.getBargainInfo(),i.getStorageSync("token")&&this.$util.getMemberId().then((function(t){n.memberId=t,n.token=i.getStorageSync("token"),n.info.launch_id&&n.setPublicShare()}))},onReady:function(){var i=this;if(!this.addonIsExist.bargain)return this.$util.showToast({title:"商家未开启砍价",mask:!0,duration:2e3}),void setTimeout((function(){i.$util.redirectTo("/pages/index/index",{},"redirectTo")}),2e3)},methods:{getHeight:function(){var n=this;i.getSystemInfo({success:function(i){n.windowHeight=i.windowHeight-44,n.iphoneX&&(n.windowHeight=n.windowHeight-33)}})},getBargainInfo:function(){var i=this;this.$api.sendRequest({url:"/bargain/api/bargain/info",data:{id:this.id},success:function(n){0==n.code?(i.info=n.data,i.getBargainRecord(1),0==i.info.status&&(i.timeMachine=i.$util.countDown(i.info.end_time-n.timestamp)),i.setPublicShare(),i.$refs.loadingCover&&i.$refs.loadingCover.hide()):i.$util.redirectTo("/pages_promotion/bargain/my_bargain")},fail:function(n){i.$refs.loadingCover&&i.$refs.loadingCover.hide()}})},getBargainRecord:function(i){var n=this;this.load||(this.load=!0,this.$api.sendRequest({url:"/bargain/api/bargain/record",data:{page:i,id:this.info.launch_id},success:function(t){n.load=!1,n.totalPage=t.data.page_count,n.page=i,0==t.code&&t.data.list.length&&(n.bargainRecord=1==i?t.data.list:n.bargainRecord.concat(t.data.list))}}))},scrolltolower:function(){var i=this.page+1;!this.load&&i<=this.totalPage&&this.getBargainRecord(i)},buyNow:function(){var n=this;i.setStorage({key:"bargainOrderCreateData",data:{launch_id:this.info.launch_id},success:function(){n.$util.redirectTo("/pages_promotion/bargain/payment")}})},bargain:function(){var n=this;i.getStorageSync("token")?this.$api.sendRequest({url:"/bargain/api/bargain/bargain",data:{id:this.info.launch_id},success:function(i){0==i.code&&(n.bargainMoney=parseFloat(i.data.bargain_money).toFixed(2),n.$refs.uniPopup.open(),n.getBargainInfo())}}):this.$refs.login.open("/pages_promotion/bargain/launch?id="+this.id)},closePopup:function(){this.$refs.uniPopup.close()},openSharePopup:function(){this.$refs.sharePopup.open()},closeSharePopup:function(){this.$refs.sharePopup.close()},copyUrl:function(){var i=this,n="嘿！朋友就差你这一刀了，帮一下忙呗~"+this.$config.h5Domain+"/pages_promotion/bargain/launch?id="+this.id;this.memberId&&(n+="&source_member="+this.memberId),this.$util.copy(n,(function(){i.closeSharePopup()}))},toBargainRecode:function(){var n=i.createSelectorQuery().select(".bargin_introduction");n.boundingClientRect((function(n){i.pageScrollTo({duration:100,scrollTop:n.top+100})})).exec()},setPublicShare:function(){var i=this.$config.h5Domain+"/pages_promotion/bargain/launch?id="+this.id;this.memberId&&(i+="&source_member="+this.memberId),this.$util.setPublicShare({title:this.info.sku_name,desc:"嘿！朋友就差你这一刀了，帮一下忙呗~",link:i,imgUrl:this.info.sku_image})}},filters:{cover:function(i){return"string"==typeof i&&i.length>0?i.substr(0,1)+"******"+i.substr(-1):""}},onShareAppMessage:function(){var i="/pages_promotion/bargain/launch?id="+this.id;return this.memberId&&(i+="&source_member="+this.memberId),{title:"嘿！朋友就差你这一刀了，帮一下忙呗~",imageUrl:this.$util.img(this.info.sku_image,{size:"big"}),path:i,success:function(i){},fail:function(i){}}},onReachBottom:function(){this.scrolltolower()}};n.default=a}).call(this,t("543d")["default"])},"5b25":function(i,n,t){},"5b7d":function(i,n,t){},"6c46":function(i,n,t){"use strict";t.r(n);var e=t("1de8"),o=t("7888");for(var a in o)"default"!==a&&function(i){t.d(n,i,(function(){return o[i]}))}(a);t("25b7"),t("281c");var r,u=t("f0c5"),c=Object(u["a"])(o["default"],e["b"],e["c"],!1,null,"4a221c64",null,!1,e["a"],r);n["default"]=c.exports},7888:function(i,n,t){"use strict";t.r(n);var e=t("4679"),o=t.n(e);for(var a in e)"default"!==a&&function(i){t.d(n,i,(function(){return e[i]}))}(a);n["default"]=o.a},e70d:function(i,n,t){"use strict";(function(i){t("34b0");e(t("66fd"));var n=e(t("6c46"));function e(i){return i&&i.__esModule?i:{default:i}}wx.__webpack_require_UNI_MP_PLUGIN__=t,i(n.default)}).call(this,t("543d")["createPage"])}},[["e70d","common/runtime","common/vendor"]]]);