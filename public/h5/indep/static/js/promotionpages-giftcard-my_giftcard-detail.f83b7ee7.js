(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["promotionpages-giftcard-my_giftcard-detail"],{"11d0":function(t,i,a){"use strict";var e;a.d(i,"b",(function(){return n})),a.d(i,"c",(function(){return o})),a.d(i,"a",(function(){return e}));var n=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("v-uni-view",{staticClass:"uni-numbox",class:{small:"small"==t.size}},[a("v-uni-button",{staticClass:"decrease",class:{disabled:t.inputValue<=t.min||t.disabled,small:"small"==t.size},attrs:{type:"default"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._calcValue("minus")}}},[t._v("-")]),a("v-uni-input",{staticClass:"uni-input uni-numbox__value",class:{small:"small"==t.size},attrs:{disabled:t.disabled,type:"number"},on:{input:function(i){arguments[0]=i=t.$handleEvent(i),t._onInput.apply(void 0,arguments)},blur:function(i){arguments[0]=i=t.$handleEvent(i),t._onInput.apply(void 0,arguments)}},model:{value:t.inputValue,callback:function(i){t.inputValue=i},expression:"inputValue"}}),a("v-uni-button",{staticClass:"increase",class:{disabled:t.inputValue>=t.max||t.disabled,small:"small"==t.size},attrs:{type:"default"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._calcValue("plus")}}},[t._v("+")])],1)},o=[]},"161a":function(t,i,a){"use strict";a.r(i);var e=a("a99a"),n=a.n(e);for(var o in e)"default"!==o&&function(t){a.d(i,t,(function(){return e[t]}))}(o);i["default"]=n.a},1667:function(t,i,a){"use strict";var e=a("6a8a"),n=a.n(e);n.a},2656:function(t,i,a){var e=a("24fb");i=e(!1),i.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n */.card-item[data-v-05b446f7]{padding:%?54?% %?30?% %?34?% %?30?%;background:url(https://cs.b2c.niuteam.cn/upload/uniapp/giftcard/detail/index.png) no-repeat 0 0/100% 50%}.card-item .card-content[data-v-05b446f7]{padding:%?30?% %?50?%;border-radius:%?15?%}.card-item .card-content .card-name[data-v-05b446f7]{margin-bottom:%?50?%;font-size:%?48?%;color:#fff}.card-item .card-content .card-use[data-v-05b446f7]{color:#fff}.card-item .card-content .card-num[data-v-05b446f7]{margin-top:%?30?%;line-height:%?20?%;color:#fff}.card-info[data-v-05b446f7]{margin:%?20?% %?30?%;padding:%?10?% %?30?%;background:#fff}.card-info .info[data-v-05b446f7]{padding:%?24?% 0;border-bottom:%?1?% solid #f5f5f5}.card-info .info .num-input[data-v-05b446f7]{margin-left:%?46?%}.card-info .info1 span[data-v-05b446f7]{margin-left:%?30?%}.card-info .info2 span[data-v-05b446f7]{margin-left:%?80?%}.card-info .info3 span[data-v-05b446f7]{margin-left:%?100?%}.bottom[data-v-05b446f7]{position:fixed;bottom:%?0?%;width:%?800?%;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:flex;background:#fff;padding:%?20?%}.bottom .bottom-left[data-v-05b446f7]{width:%?400?%;line-height:%?80?%}.bottom .bottom-left span[data-v-05b446f7]{color:#ff4544;font-size:%?35?%;font-weight:600}.bottom .bottom-right[data-v-05b446f7]{width:%?400?%}.bottom .bottom-right uni-button[data-v-05b446f7]{width:%?320?%;height:%?80?%;line-height:%?80?%}.giftcard-goods[data-v-05b446f7]{margin:%?20?% %?30?%}.giftcard-goods .giftcard-goods-list[data-v-05b446f7]{padding-bottom:%?120?%}.giftcard-goods .giftcard-goods-item[data-v-05b446f7]{display:-webkit-box;display:-webkit-flex;display:flex;margin:%?20?% 0;background-color:#fff;padding:%?26?%;border-radius:%?10?%}.giftcard-goods .giftcard-goods-item uni-image[data-v-05b446f7]{height:%?200?%;width:%?200?%;margin-right:%?20?%}.giftcard-goods .giftcard-goods-item .giftcard-info-wrap[data-v-05b446f7]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.giftcard-goods .giftcard-goods-item .giftcard-info-wrap .info-title[data-v-05b446f7]{word-break:break-all;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;\r\n  /* 这里是超出几行省略 */overflow:hidden}.giftcard-goods .giftcard-goods-item .giftcard-info-wrap .price[data-v-05b446f7], .giftcard-goods .giftcard-goods-item .giftcard-info-wrap .unit[data-v-05b446f7]{display:inline-block}.giftcard-goods .giftcard-goods-item .giftcard-info-wrap .price[data-v-05b446f7]{font-size:%?32?%;font-weight:700}.card-warn[data-v-05b446f7]{margin:%?20?% %?30?%;display:-webkit-box;display:-webkit-flex;display:flex;height:%?80?%;background:#fff1e5;padding:0 %?20?%;border-radius:%?10?%;position:relative}.card-warn .warn[data-v-05b446f7]{background-color:#fa5b14;border-radius:50%;height:%?40?%;width:%?40?%;line-height:%?40?%;color:#fff;text-align:center;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.card-warn .content[data-v-05b446f7]{line-height:%?80?%;color:#fa5b14;margin-left:%?50?%}[data-v-05b446f7] .decrease{margin-right:%?10?%!important}[data-v-05b446f7] .increase{margin-left:%?10?%!important}[data-v-05b446f7] .uni-input-input{background:#fff!important;border:%?2?% solid #eee!important;width:92%!important}[data-v-05b446f7] .uni-numbox__value.small{border:none!important}[data-v-05b446f7] .uni-numbox__value{background-color:none!important}',""]),t.exports=i},"3af5":function(t,i,a){"use strict";a("a9e3"),a("ac1f"),a("1276"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e={name:"UniNumberBox",props:{value:{type:[Number,String],default:1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},disabled:{type:Boolean,default:!1},modifyFlag:{type:Boolean,default:!1},size:{type:String,default:"default"},index:{type:Number,default:-1}},data:function(){return{inputValue:0}},watch:{value:function(t){this.inputValue=+t},inputValue:function(t,i,a){+t===+i||this.modifyFlag||this.$emit("change",t,a)}},created:function(){this.inputValue=+this.value},methods:{_calcValue:function(t){if(!this.disabled&&!this.modifyFlag){var i=this._getDecimalScale(),a=this.inputValue*i,e=this.step*i;"minus"===t?a-=e:"plus"===t&&(a+=e),a<this.min||a>this.max?this.$emit("limit",{value:this.inputValue,type:t},this.index):this.inputValue=a/i}},_getDecimalScale:function(){var t=1;return~~this.step!==this.step&&(t=Math.pow(10,(this.step+"").split(".")[1].length)),t},_onInput:function(t){var i=this;setTimeout((function(){var a=t.detail.value;/(^[1-9]\d*$)/.test(a)||(a=i.min),a?(a=+a,a>i.max?a=i.max:a<i.min&&(a=i.min),i.inputValue=a):i.inputValue=0}),0)}}};i.default=e},"652a":function(t,i,a){"use strict";a.d(i,"b",(function(){return n})),a.d(i,"c",(function(){return o})),a.d(i,"a",(function(){return e}));var e={uniNumberBox:a("ae1e").default,loadingCover:a("4c1d").default,nsLogin:a("2bc6").default},n=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("v-uni-view",{},[a("v-uni-view",{staticClass:"card-item margin-bottom"},[a("v-uni-view",{staticClass:"card-content",style:{background:t.$util.img(t.giftcardDetail.card_cover)?"url("+t.$util.img(t.giftcardDetail.card_cover)+") no-repeat 0 0/100% 100%":"url(https://cs.b2c.niuteam.cn/upload/uniapp/giftcard/detail/gitcard_default3.png) no-repeat 0 0/100% 100%"}},[a("v-uni-view",{staticClass:"card-name"},[t._v(t._s(t.giftcardDetail.card_name))]),a("v-uni-view",{staticClass:"card-use"},[t._v("礼品卡权益")]),t.giftcardDetail.balance>0&&t.giftcardDetail.point>0&&t.giftcardDetail.goods_num>0?a("v-uni-view",{staticClass:"card-num"},[t._v("￥"+t._s(t.giftcardDetail.balance)+"+"+t._s(t.giftcardDetail.point)+"积分+商品*"+t._s(t.giftcardDetail.goods_num))]):t.giftcardDetail.balance>0&&0==t.giftcardDetail.point?a("v-uni-view",{staticClass:"card-num"},[t._v("￥"+t._s(t.giftcardDetail.balance))]):0==t.giftcardDetail.balance&&t.giftcardDetail.point>0?a("v-uni-view",{staticClass:"card-num"},[t._v(t._s(t.giftcardDetail.point)+" 积分")]):0==t.giftcardDetail.balance&&0==t.giftcardDetail.point&&t.giftcardDetail.goods_num>0?a("v-uni-view",{staticClass:"card-num"},[t._v("商品*"+t._s(t.giftcardDetail.goods_num))]):t.giftcardDetail.balance>0&&t.giftcardDetail.point>0&&0==t.giftcardDetail.goods_num?a("v-uni-view",{staticClass:"card-num"},[t._v("￥"+t._s(t.giftcardDetail.balance)+"+"+t._s(t.giftcardDetail.point)+"积分")]):t.giftcardDetail.balance>0&&0==t.giftcardDetail.point&&t.giftcardDetail.goods_num>0?a("v-uni-view",{staticClass:"card-num"},[t._v("￥"+t._s(t.giftcardDetail.balance)+"+商品*"+t._s(t.giftcardDetail.goods_num))]):0==t.giftcardDetail.balance&&t.giftcardDetail.point>0&&t.giftcardDetail.goods_num>0?a("v-uni-view",{staticClass:"card-num"},[t._v(t._s(t.giftcardDetail.point)+"积分+商品*"+t._s(t.giftcardDetail.goods_num))]):t._e()],1)],1),a("v-uni-view",{staticClass:"card-warn"},[a("v-uni-view",{staticClass:"warn"},[t._v("!")]),a("v-uni-view",{staticClass:"content"},[t._v("礼品卡不支持退款，请在有效期内使用!")])],1),a("v-uni-view",{staticClass:"card-info"},[a("v-uni-view",{staticClass:"info info1"},[t._v("礼品卡名称："),a("span",[t._v(t._s(t.giftcardDetail.card_name))])]),a("v-uni-view",{staticClass:"info2",staticStyle:{padding:"20rpx 0"}},[a("v-uni-view",{staticClass:"info"},[t._v("销售价："),a("span",[t._v("￥"+t._s(t.giftcardDetail.selling_price))])]),1==t.giftcardDetail.time_type?a("v-uni-view",{staticClass:"info"},[t._v("有效期："),a("span",[t._v("永久有效")])]):2==t.giftcardDetail.time_type?a("v-uni-view",{staticClass:"info"},[t._v("有效期："),a("span",[t._v("有效期限至\n\t\t\t\t\t"+t._s(t.$util.timeStampTurnTime(t.giftcardDetail.youxiao_time)))])]):3==t.giftcardDetail.time_type?a("v-uni-view",{staticClass:"info"},[t._v("有效期："),a("span",[t._v("领取后 "+t._s(t.giftcardDetail.youxiao_day)+" 天有效")])]):t._e()],1),a("v-uni-view",{staticClass:"info"},[t._v("购买数量："),a("uni-number-box",{staticClass:"num-input",attrs:{value:t.num,size:"small",min:1,max:t.max_buy||t.giftcardDetail.card_count},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t.change.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"info info3",staticStyle:{border:"none"}},[t._v("库存："),a("span",[t._v(t._s(t.giftcardDetail.card_count))])])],1),t.giftcardDetail.goods_list?a("v-uni-view",{staticClass:"giftcard-goods"},[a("v-uni-view",{staticClass:"giftcard-goods-list"},t._l(t.giftcardDetail.goods_list,(function(i,e){return a("v-uni-view",{key:e,staticClass:"giftcard-goods-item"},[a("v-uni-view",{staticClass:"giftcart-goods-img"},[a("v-uni-image",{attrs:{src:t.goodsImg(i.sku_image)}})],1),a("v-uni-view",{staticClass:"giftcard-info-wrap"},[a("v-uni-view",{staticClass:"info-title"},[t._v(t._s(i.sku_name))]),a("v-uni-view",{staticClass:"info-price"},[a("v-uni-view",{staticClass:"unit color-base-text"},[t._v("￥")]),a("v-uni-view",{staticClass:"price color-base-text"},[t._v(t._s(i.price))])],1)],1)],1)})),1)],1):t._e(),a("v-uni-view",{staticClass:"bottom"},[a("v-uni-view",{staticClass:"bottom-left"},[t._v("合计："),a("span",[t._v("￥"+t._s(t.num*t.giftcardDetail.selling_price))])]),a("v-uni-view",{staticClass:"bottom-right"},[a("v-uni-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openChoosePayment()}}},[t._v("立即购买")])],1)],1),a("ns-payment",{ref:"choosePaymentPopup",attrs:{payMoney:t.payMoney,isBalance:t.is_balance,balanceDeduct:t.giftcardDetail.selling_price>0&&t.giftcardDetail.member_info.balance_total?t.balanceDeduct:"0"},on:{confirm:function(i){arguments[0]=i=t.$handleEvent(i),t.gotoBuy.apply(void 0,arguments)},useBalance:function(i){arguments[0]=i=t.$handleEvent(i),t.useBalance.apply(void 0,arguments)}}}),a("loading-cover",{ref:"loadingCover"}),a("ns-login",{ref:"login"})],1)},o=[]},"6a8a":function(t,i,a){var e=a("2656");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var n=a("4f06").default;n("ffc70030",e,!0,{sourceMap:!1,shadowMode:!1})},7628:function(t,i,a){var e=a("24fb");i=e(!1),i.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n */.uni-numbox[data-v-250c3aaa]{display:-webkit-inline-box;display:-webkit-inline-flex;display:inline-flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:%?70?%;position:relative}.uni-numbox.small[data-v-250c3aaa]{height:%?44?%}.uni-numbox[data-v-250c3aaa]:after{content:"";position:absolute;-webkit-transform-origin:center;transform-origin:center;box-sizing:border-box;pointer-events:none;top:-50%;left:-50%;right:-50%;bottom:-50%;border-radius:%?12?%;-webkit-transform:scale(.5);transform:scale(.5)}.uni-numbox__minus[data-v-250c3aaa],\r\n.uni-numbox__plus[data-v-250c3aaa]{width:%?40?%;height:%?40?%;border-radius:50%;background-size:100% 100%;background-position:50%}.uni-numbox__value[data-v-250c3aaa]{position:relative;background-color:#f8f8f8;width:%?80?%;height:%?40?%;text-align:center;border:1px solid #eee;display:inline-block;line-height:%?36?%;font-weight:700;margin:0;padding:0;vertical-align:top;min-height:0;border-left:none;border-right:none}.uni-numbox__value.small[data-v-250c3aaa]{width:%?60?%;font-size:%?24?%}.uni-numbox__value[data-v-250c3aaa]:after{content:"";position:absolute;-webkit-transform-origin:center;transform-origin:center;box-sizing:border-box;pointer-events:none;top:-50%;left:-50%;right:-50%;bottom:-50%;border-top-width:0;border-bottom-width:0;-webkit-transform:scale(.5);transform:scale(.5)}.uni-numbox--disabled[data-v-250c3aaa]{color:silver}.uni-numbox uni-button[data-v-250c3aaa]{width:%?40?%;height:%?40?%;display:inline-block;box-sizing:initial;border:1px solid #eee;padding:0;margin:0;border-radius:0;background-color:#fff!important;font-weight:700}.uni-numbox uni-button.disabled[data-v-250c3aaa]{color:#eee}.uni-numbox uni-button.decrease[data-v-250c3aaa]{font-size:%?44?%;line-height:%?32?%}.uni-numbox uni-button.increase[data-v-250c3aaa]{font-size:%?32?%;line-height:%?36?%}',""]),t.exports=i},"8ec2":function(t,i,a){"use strict";var e=a("a559"),n=a.n(e);n.a},a559:function(t,i,a){var e=a("7628");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var n=a("4f06").default;n("55ce50ac",e,!0,{sourceMap:!1,shadowMode:!1})},a99a:function(t,i,a){"use strict";(function(t){var e=a("4ea4");a("4160"),a("c975"),a("b680"),a("acd8"),a("ac1f"),a("1276"),a("159b"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e(a("fa8d")),o={components:{nsPayment:n.default},data:function(){return{order:1,giftcardDetail:{},max_buy:0,num:1,id:"",isSub:!1,is_balance:0,payMoney:1,memberId:0,shareImg:""}},onLoad:function(t){var i=this,a=t.id;if(this.getData(a),this.id=t.id,this.$util.getMemberId().then((function(t){i.memberId=t})).catch((function(t){})),t.source_member&&uni.setStorageSync("source_member",t.source_member),t.scene){var e=decodeURIComponent(t.scene);e=e.split("&"),e.length&&e.forEach((function(t){-1!=t.indexOf("sku_id")&&(i.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&uni.setStorageSync("source_member",t.split("-")[1]),-1!=t.indexOf("is_test")&&uni.setStorageSync("is_test",1)}))}},onShow:function(){this.$langConfig.refresh(),uni.getStorageSync("token")&&uni.getStorageSync("source_member")&&this.$util.onSourceMember(uni.getStorageSync("source_member"))},onShareAppMessage:function(t){var i=this.giftcardDetail.card_name,a=this.$util.getCurrentShareRoute(this.memberId),e=a.path;return{title:i,path:e,imageUrl:this.shareImg,success:function(t){},fail:function(t){}}},onShareTimeline:function(){var t=this.giftcardDetail.card_name,i=this.$util.getCurrentShareRoute(this.memberId),a=i.query;return{title:t,query:a,imageUrl:this.shareImg}},methods:{goodsImg:function(t){var i=t.split(",");return i[0]?this.$util.img(i[0],{size:"mid"}):this.$util.getDefaultImage().default_goods_img},getData:function(t){var i=this;this.$api.sendRequest({url:"/giftcard/api/giftcard/giftcardDetail",data:{id:t},success:function(t){0==t.code&&t.data?(i.giftcardDetail=t.data,i.giftcardDetail.card_cover?i.shareImg=i.$util.img(i.giftcardDetail.card_cover):i.shareImg=i.$util.img("upload/uniapp/blindBox/default.png"),i.max_buy=parseFloat(t.data.max_buy),i.$refs.loadingCover&&i.$refs.loadingCover.hide()):i.$refs.loadingCover&&i.$refs.loadingCover.hide()},fail:function(t){}})},change:function(t){this.num=t},openChoosePayment:function(){if(0!=this.payMoney&&(this.payMoney=this.giftcardDetail.selling_price*this.num),!uni.getStorageSync("token"))return this.$refs.login.open("/promotionpages/giftcard/my_giftcard/detail?id="+this.id),!1;0==this.giftcardDetail.card_count?this.$util.showToast({title:"库存不足"}):(uni.setStorageSync("paySource","giftcard"),this.$refs.choosePaymentPopup.open())},subscribeMessage:function(){this.$api.sendRequest({url:"/weapp/api/weapp/messagetmplids",data:{keywords:"ORDER_PAY,ORDER_DELIVERY,ORDER_TAKE_DELIVERY"},success:function(i){i.data.length&&uni.requestSubscribeMessage({tmplIds:i.data,success:function(t){},fail:function(i){t.log("fail",i)}})}})},gotoBuy:function(){var t=this;this.$api.sendRequest({url:"/giftcard/api/giftcard/createorder",data:{id:this.id,selling_price:this.giftcardDetail.selling_price,num:this.num,order_total_price:this.num*this.giftcardDetail.selling_price,is_balance:this.is_balance},success:function(i){i.data&&0==i.code?0==t.payMoney?t.$util.redirectTo("/otherpages/pay/result/result",{code:i.data},"redirectTo"):(uni.setStorageSync("paySource","giftcard"),t.out_trade_no=i.data,t.$refs.choosePaymentPopup.getPayInfo(i.data),t.isSub=!1):(t.isSub=!1,uni.hideLoading(),t.$util.showToast({title:i.message}))}})},useBalance:function(){this.is_balance?this.is_balance=0:(this.payMoney=0,this.is_balance=1),this.$forceUpdate()}},watch:{is_balance:function(t,i){0==t?this.payMoney=this.giftcardDetail.selling_price*this.num:this.giftcardDetail.member_info.balance_total-this.giftcardDetail.selling_price>=0?this.payMoney=0:this.payMoney=this.giftcardDetail.selling_price-this.giftcardDetail.member_info.balance_total}},computed:{balanceDeduct:function(){if(1==this.giftcardDetail.is_balance)return this.giftcardDetail.member_info.balance_total<=parseFloat(this.giftcardDetail.selling_price).toFixed(2)?parseFloat(this.giftcardDetail.member_info.balance_total).toFixed(2):parseFloat(this.giftcardDetail.selling_price).toFixed(2)*this.num}}};i.default=o}).call(this,a("5a52")["default"])},ae1e:function(t,i,a){"use strict";a.r(i);var e=a("11d0"),n=a("ef0a");for(var o in n)"default"!==o&&function(t){a.d(i,t,(function(){return n[t]}))}(o);a("8ec2");var r,s=a("f0c5"),c=Object(s["a"])(n["default"],e["b"],e["c"],!1,null,"250c3aaa",null,!1,e["a"],r);i["default"]=c.exports},ef0a:function(t,i,a){"use strict";a.r(i);var e=a("3af5"),n=a.n(e);for(var o in e)"default"!==o&&function(t){a.d(i,t,(function(){return e[t]}))}(o);i["default"]=n.a},fe02:function(t,i,a){"use strict";a.r(i);var e=a("652a"),n=a("161a");for(var o in n)"default"!==o&&function(t){a.d(i,t,(function(){return n[t]}))}(o);a("1667");var r,s=a("f0c5"),c=Object(s["a"])(n["default"],e["b"],e["c"],!1,null,"05b446f7",null,!1,e["a"],r);i["default"]=c.exports}}]);