(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_promotion-game-cards"],{"000d":function(t,e,a){"use strict";var n=a("a95a"),i=a.n(n);i.a},"013c":function(t,e,a){"use strict";a("c975"),a("a9e3"),a("acd8"),a("ac1f"),a("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={type:"scrolldone",target:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},currentTarget:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},detail:{}},i={props:{backgroundTextStyle:{type:String,default:"dark",validator:function(t){return-1!==["dark","light"].indexOf(t)}},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created:function(){var t=this,e=getCurrentPages()[0];this.$pageVm=e.$vm||e,uni.onWindowResize((function(e){t.$emit("resize",e)})),this.$pageVm.$on("hook:onPageScroll",(function(e){t.$emit("scroll",e)})),this.$watch("backgroundTextStyle",(function(){t.setBackgroundTextStyle()})),this.$watch((function(){return[t.rootFontSize,t.pageStyle]}),(function(){t.setPageMeta()})),this.$watch((function(){return[t.backgroundColor,t.backgroundColorTop,t.backgroundColorBottom]}),(function(){t.setBackgroundColor()})),this.$watch((function(){return[t.scrollTop,t.scrollDuration]}),(function(){t.pageScrollTo()}))},beforeMount:function(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle(),this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh:function(t,e){t.setStyle({pullToRefresh:{support:e,style:"Android"===plus.os.name?"circle":"default"}})},setPageMeta:function(){uni.setPageMeta({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle:function(){},setBackgroundColor:function(){},pageScrollTo:function(){var t=this,e=String(this.scrollTop);if(-1!==e.indexOf("rpx")&&(e=uni.upx2px(e.replace("rpx",""))),e=parseFloat(e),!isNaN(e)){var a=function a(i){i.scrollTop===e&&(t.$pageVm.$off("hook:onPageScroll",a),t.$emit("scrolldone",n))};uni.pageScrollTo({scrollTop:e,duration:this.scrollDuration,success:function(){t.$pageVm.$on("hook:onPageScroll",a)}})}}}};e.default=i},"0afa":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={pageMeta:a("6d42").default,lTime:a("9050").default,uniPopup:a("92aa").default,loadingCover:a("790a").default,nsLogin:a("2893").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("page-meta",{attrs:{"page-style":t.themeColor}}),a("v-uni-view",{staticClass:"container"},[a("v-uni-view",[a("v-uni-view",{staticClass:"head-wrap"},[a("v-uni-image",{attrs:{src:t.$util.img("public/uniapp/game/cards_head.png"),mode:"widthFix"}}),a("v-uni-view",{staticClass:"rule-mark",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openRulePopup.apply(void 0,arguments)}}},[t._v("规则")])],1),a("v-uni-view",{staticClass:"prize-area"},[a("v-uni-view",{staticClass:"content-wrap"},[a("v-uni-view",[t.showGuide?a("v-uni-view",{staticClass:"guide-wrap"},[1==t.gameInfo.status?[a("v-uni-view",{staticClass:"text"},[t._v("刮开试试手气")]),a("v-uni-view",{staticClass:"btn color-base-bg",class:{disabled:0==t.gameInfo.surplus_num},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.lottery.apply(void 0,arguments)}}},[t._v("点我刮奖"+t._s("("+t.gameInfo.points+"积分)"))])]:0==t.gameInfo.status?[a("v-uni-view",{staticClass:"text"},[t._v("活动尚未开始")])]:[a("v-uni-view",{staticClass:"text"},[t._v("活动已经结束")])]],2):t._e(),a("v-uni-canvas",{staticClass:"canvas",class:{"add-point":1==t.add_point},attrs:{"disable-scroll":!0,"canvas-id":"cardsCanvas",id:"canvas"},on:{touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.touchMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"result-wrap",on:{touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.contentMove.apply(void 0,arguments)}}},[t.result.is_winning?[a("v-uni-view",{staticClass:"title"},[t._v("恭喜您中奖了")]),a("v-uni-view",{staticClass:"text color-base-text"},[t._v(t._s(t.result.award_name))]),t.gameInfo.surplus_num>1?a("v-uni-button",{staticClass:"warn",attrs:{type:"warn"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.again.apply(void 0,arguments)}}},[t._v("再刮一次")]):t._e(),a("v-uni-view",{staticClass:"tips"},[t._v("可到“我的中奖记录”中查看")])]:[a("v-uni-view",{staticClass:"text color-base-text"},[t._v(t._s(t.gameInfo.no_winning_desc))]),t.gameInfo.surplus_num>1?a("v-uni-button",{staticClass:"warn",attrs:{type:"warn"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.again.apply(void 0,arguments)}}},[t._v("再刮一次")]):t._e()]],2)],1)],1),a("v-uni-image",{attrs:{src:t.$util.img("public/uniapp/game/cards_bg.png"),mode:"widthFix"}})],1),a("v-uni-view",{staticClass:"action-text"},[a("v-uni-view",{staticClass:"point"},[t._v("我的积分："+t._s(t.point))]),a("v-uni-view",{staticClass:"record",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$util.redirectTo("/pages_promotion/game/record",{id:t.id})}}},[t._v("我的中奖记录")])],1),t.gameInfo.is_show_winner&&t.gameInfo.draw_record.length?a("v-uni-view",{staticClass:"record-wrap"},[a("v-uni-view",{staticClass:"body-shade"}),a("v-uni-view",{staticClass:"head"},[t._v("中奖名单")]),a("v-uni-view",{staticClass:"body"},[a("v-uni-view",{staticClass:"wrap",class:{animate:t.animate}},t._l(t.gameInfo.draw_record,(function(e,n){return a("v-uni-view",{key:n},[a("v-uni-view",{staticClass:"tit"},[t._v(t._s(t._f("cover")(e.member_nick_name)))]),a("v-uni-view",{staticClass:"txt"},[a("l-time",{attrs:{text:1e3*e.create_time}}),t._v("获得 "+t._s(e.award_name))],1)],1)})),1)],1)],1):t._e()],1),a("uni-popup",{ref:"rulePopup",attrs:{type:"center",maskClick:!1},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.popChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"rule-wrap"},[a("v-uni-view",{staticClass:"content-wrap"},[a("v-uni-image",{staticClass:"rule-head",attrs:{src:t.$util.img("public/uniapp/game/rule_head.png"),mode:"widthFix"}}),a("v-uni-scroll-view",{staticClass:"rule",attrs:{"scroll-y":"true"}},[a("v-uni-view",[a("v-uni-view",{staticClass:"tit"},[t._v("活动时间")]),a("v-uni-view",{staticClass:"text"},[t._v(t._s(t.$util.timeStampTurnTime(t.gameInfo.start_time))+" - "+t._s(t.$util.timeStampTurnTime(t.gameInfo.end_time)))]),a("v-uni-view",{staticClass:"tit"},[t._v("参与规则")]),0==t.gameInfo.join_type?a("v-uni-view",{staticClass:"text"},[t._v("每个用户活动期间共有"+t._s(t.gameInfo.join_frequency)+"次抽奖机会。")]):a("v-uni-view",{staticClass:"text"},[t._v("每个用户活动期间每天都有"+t._s(t.gameInfo.join_frequency)+"次抽奖机会，每天0点更新。")]),a("v-uni-view",{staticClass:"text"},[t._v("每次抽奖需消耗 "+t._s(t.gameInfo.points)+" 积分")]),0!=t.gameInfo.level_id?a("v-uni-view",{staticClass:"text"},[t._v("该活动只有"+t._s(t.gameInfo.level_name)+"等级的会员可参与。")]):t._e(),""!=t.gameInfo.remark?[a("v-uni-view",{staticClass:"tit"},[t._v("活动说明")]),a("v-uni-view",{staticClass:"text"},[t._v(t._s(t.gameInfo.remark))])]:t._e()],2)],1),a("v-uni-text",{staticClass:"iconfont iconroundclose",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeRulePopup.apply(void 0,arguments)}}})],1)],1)],1),a("loading-cover",{ref:"loadingCover"}),a("ns-login",{ref:"login"})],1)],1)},o=[]},1815:function(t,e,a){"use strict";a.r(e);var n=a("0afa"),i=a("7b88");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("f9e1"),a("000d");var r,s=a("f0c5"),u=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"551527a1",null,!1,n["a"],r);e["default"]=u.exports},"2b06":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n */.container[data-v-551527a1]{width:100vw;min-height:100vh;background-image:linear-gradient(#f3623f,#f74222)}.add-point[data-v-551527a1]{pointer-events:none}.head-wrap[data-v-551527a1]{position:relative}.head-wrap uni-image[data-v-551527a1]{width:100%;display:block}.head-wrap .rule-mark[data-v-551527a1]{position:absolute;right:0;top:%?60?%;background-color:#ffe854;color:#ff7908;height:%?60?%;line-height:%?60?%;padding:0 %?30?%;border-top-left-radius:%?60?%;border-bottom-left-radius:%?60?%}.prize-area[data-v-551527a1]{margin:0 auto;width:85%;position:relative;line-height:1;-webkit-transform:translateY(%?-420?%);transform:translateY(%?-420?%)}.prize-area uni-image[data-v-551527a1]{width:100%}.prize-area .content-wrap[data-v-551527a1]{position:absolute;width:%?500?%;height:%?300?%;z-index:4;left:%?70?%;top:%?210?%}.prize-area .content-wrap > uni-view[data-v-551527a1]{position:relative;width:100%;height:100%}.prize-area .canvas-shade[data-v-551527a1]{width:100%;height:100%;position:absolute;z-index:5;background:#e5e5e5}.prize-area .canvas[data-v-551527a1]{width:100%;height:100%;position:absolute;z-index:6}.prize-area .result-wrap[data-v-551527a1]{width:100%;height:100%;position:absolute;left:0;top:0;z-index:3;display:flex;align-items:center;justify-content:center;flex-direction:column;background-color:#fff5e9}.prize-area .result-wrap .title[data-v-551527a1]{font-size:%?28?%;line-height:1}.prize-area .result-wrap .text[data-v-551527a1]{font-size:%?52?%;font-weight:800;text-align:center;line-height:1;margin-top:%?20?%}.prize-area .result-wrap .tips[data-v-551527a1]{font-size:%?24?%;color:#999;line-height:1;margin-top:%?20?%}.prize-area .guide-wrap[data-v-551527a1]{width:100%;height:100%;position:absolute;left:0;top:0;z-index:10;display:flex;flex-direction:column;justify-content:center;align-items:center}.prize-area .guide-wrap .text[data-v-551527a1]{letter-spacing:%?12?%;color:#999}.prize-area .guide-wrap .btn[data-v-551527a1]{line-height:1;padding:%?22?% %?90?%;color:#fff;display:inline-block;border-radius:%?50?%;margin-top:%?10?%}.prize-area .guide-wrap .btn.disabled[data-v-551527a1]{background-color:#ccc!important}.action-text[data-v-551527a1]{margin:%?60?% %?50?% 0 %?50?%;display:flex;-webkit-transform:translateY(%?-420?%);transform:translateY(%?-420?%)}.action-text > uni-view[data-v-551527a1]{flex:1;line-height:1}.action-text .point[data-v-551527a1]{color:#fee331}.action-text .record[data-v-551527a1]{color:#fff;text-align:right}.record-wrap[data-v-551527a1]{-webkit-transform:translateY(%?-420?%);transform:translateY(%?-420?%);margin:%?80?% %?50?% %?30?% %?50?%;border-radius:%?10?%;background-color:#ff6e43;padding:%?12?%;box-shadow:0 .45em 0 #d92a00;position:relative;height:%?430?%}.record-wrap .head[data-v-551527a1]{border:%?6?% solid #ff6e43;box-shadow:inset 0 0 %?10?% 0 #d92a00,0 .45em 0 #d92a00;background-color:#da2b00;position:absolute;z-index:5;text-align:center;width:%?300?%;height:%?70?%;line-height:%?70?%;border-radius:%?70?%;top:0;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:#fff;font-weight:600;letter-spacing:%?4?%}.record-wrap .body-shade[data-v-551527a1]{width:calc(100% - %?24?%);height:%?60?%;top:%?12?%;left:%?12?%;background-color:#da2b00;z-index:5;position:absolute;z-index:2;border-radius:%?8?%}.record-wrap .body[data-v-551527a1]{background-color:#da2b00;border-radius:%?8?%;height:%?340?%;box-shadow:inset 0 0 %?10?% 0 #d92a00;padding:%?60?% %?30?% %?30?% %?30?%;overflow:hidden}.record-wrap .body .wrap > uni-view[data-v-551527a1]{display:flex}.record-wrap .body .wrap.animate[data-v-551527a1]{transition:all 1s ease-in-out;-webkit-transform:translateY(%?-60?%);transform:translateY(%?-60?%)}.record-wrap .body .tit[data-v-551527a1]{line-height:%?60?%;width:%?220?%;color:#fff}.record-wrap .body .txt[data-v-551527a1]{line-height:%?60?%;flex:1;color:#fee331}.remain-box[data-v-551527a1]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.remain[data-v-551527a1]{min-width:%?550?%;height:%?54?%;background:rgba(0,0,0,.1);line-height:%?54?%;border-radius:%?10?%;margin:0 auto;text-align:center;-webkit-transform:translateY(%?-390?%);transform:translateY(%?-390?%);color:#fff;padding:0 %?25?%;font-size:%?24?%}.rule-wrap[data-v-551527a1]{border-radius:%?10?%;background-color:#ffd697;width:80vw;padding:%?12?%;box-sizing:border-box}.rule-wrap .content-wrap[data-v-551527a1]{background-color:#fff2dd;width:100%;border-radius:%?8?%;position:relative}.rule-wrap .content-wrap .rule-head[data-v-551527a1]{width:100%;position:absolute;-webkit-transform:translateY(-50%);transform:translateY(-50%);left:0;top:0}.rule-wrap .content-wrap .rule[data-v-551527a1]{height:%?560?%;padding:%?80?% %?30?% 0 %?30?%;box-sizing:border-box}.rule-wrap .content-wrap .rule .tit[data-v-551527a1]{font-weight:600;color:#da2b00;margin-top:%?10?%}.rule-wrap .content-wrap .rule .text[data-v-551527a1]{font-size:%?26?%;color:#da2b00}.rule-wrap .content-wrap .iconroundclose[data-v-551527a1]{color:#fff;text-align:center;position:absolute;bottom:%?-150?%;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);font-size:%?70?%}.warn[data-v-551527a1]{margin-top:%?20?%;border-radius:%?20?%}',""]),t.exports=e},"363f":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,"[data-v-551527a1] .uni-popup__wrapper.uni-custom .uni-popup__wrapper-box{background:none!important}[data-v-551527a1] .uni-popup__wrapper.uni-custom.center .uni-popup__wrapper-box{overflow:unset}",""]),t.exports=e},4020:function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticStyle:{display:"none"}},[t._t("default")],2)},o=[]},"6d42":function(t,e,a){"use strict";a.r(e);var n=a("4020"),i=a("8f28");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);var r,s=a("f0c5"),u=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);e["default"]=u.exports},"722a":function(t,e,a){"use strict";var n=a("4ea4");a("a9e3"),a("8a79"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("8eac")),o={name:"l-time",props:{text:{type:[String,Number,Date],default:""},maxDate:{type:Boolean,default:!1}},data:function(){return{textVal:this.text}},watch:{text:function(){this.textVal=this.text}},computed:{temp:function(){return this.getText()}},methods:{getText:function(){var t=this,e=i.default.getFormatTime(t.textVal,t.maxDate);return e&&(e.endsWith("刚刚")||e.endsWith("分钟前"))&&setTimeout((function(){var e=t.textVal;t.textVal="",t.textVal=e}),6e4),this.textVal?e:""},onClick:function(){this.$emit("on-tap",this.textVal)}}};e.default=o},"7b88":function(t,e,a){"use strict";a.r(e);var n=a("b35f"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},8543:function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-text",[t._v(t._s(t.temp))])},o=[]},"8a79":function(t,e,a){"use strict";var n=a("23e7"),i=a("06cf").f,o=a("50c4"),r=a("5a34"),s=a("1d80"),u=a("ab13"),c=a("c430"),l="".endsWith,d=Math.min,f=u("endsWith"),p=!c&&!f&&!!function(){var t=i(String.prototype,"endsWith");return t&&!t.writable}();n({target:"String",proto:!0,forced:!p&&!f},{endsWith:function(t){var e=String(s(this));r(t);var a=arguments.length>1?arguments[1]:void 0,n=o(e.length),i=void 0===a?n:d(o(a),n),u=String(t);return l?l.call(e,u,i):e.slice(i-u.length,i)===u}})},"8eac":function(t,e,a){"use strict";a("99af"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,Function.prototype.asyAfter=function(t){var e=this;return function(){var a=e.apply(this,arguments);return"next"===a?t.apply(this,arguments):a}},Date.prototype.pattern=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},a={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+a[this.getDay()+""])),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t};var n=function(t){return/^\[object\s(.*)\]$/.exec(Object.prototype.toString.call(t))[1]},i=function(){},o=i.prototype;o.getUnix=function(){return(new Date).getTime()},o.getTodayUnix=function(){var t=new Date,e="".concat(t.getFullYear(),"/").concat(t.getMonth()+1,"/").concat(t.getDate()," 00:00:00");return new Date(e).getTime()},o.getYearUnix=function(){var t=new Date;return t.setMonth(0),t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.getTime()},o.getLastDate=function(t){if(t){var e=new Date(t);if(e.pattern)return e.pattern("yyyy-MM-dd");var a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate();return e.getFullYear()+"-"+a+"-"+n}};var r=function(t,e){var a=function(t){return t<=0||Math.floor(t/60)<=0?"刚刚":"next"},n=function(t){return t<3600?Math.floor(t/60)+"分钟前":"next"},i=function(t,e){var a=u.getTodayUnix();return t>=3600&&e-a>=0?Math.floor(t/60/60)+"小时前":"next"},o=function(t,e){var a=u.getTodayUnix();return t=(a-e)/1e3,t/86400<=31?Math.ceil(t/86400)+"天前":"next"},r=function(t,e){return u.getLastDate(e)},s=a.asyAfter(n).asyAfter(i).asyAfter(o).asyAfter(r);return s(t,e)},s=new RegExp("-","g");o.getFormatTime=function(t,e){if(!t)return"";switch(n(t)){case"Date":t=t.getTime();break;case"String":t=t.replace(s,"/");default:t=new Date(t).getTime();break}var a=this.getUnix(),i=(this.getYearUnix(),(a-t)/1e3);if(t>a&&e)return this.getLastDate(t);return r(i,t)};var u=new i,c=u;e.default=c},"8f28":function(t,e,a){"use strict";a.r(e);var n=a("013c"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},9050:function(t,e,a){"use strict";a.r(e);var n=a("8543"),i=a("f232");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);var r,s=a("f0c5"),u=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"14871ab2",null,!1,n["a"],r);e["default"]=u.exports},a95a:function(t,e,a){var n=a("363f");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("7742fd54",n,!0,{sourceMap:!1,shadowMode:!1})},b35f:function(t,e,a){"use strict";var n=a("4ea4");a("cb29"),a("4160"),a("c975"),a("e25e"),a("ac1f"),a("1276"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("92aa")),o=n(a("9050")),r={components:{uniPopup:i.default,LTime:o.default},data:function(){return{ctxData:null,ctx:null,ctxW:0,ctxH:0,scaleRatio:1,showGuide:!0,id:0,gameInfo:{no_winning_desc:"",surplus_num:0},result:{is_winning:0},isClick:!1,point:0,animate:!1,scrollTimer:null,token:"",popState:!1,add_point:0,memberId:0,shareImg:""}},onLoad:function(t){var e=this;if(t.id&&(this.id=t.id),this.$util.getMemberId().then((function(t){e.memberId=t})),t.source_member&&uni.setStorageSync("source_member",t.source_member),t.scene){var a=decodeURIComponent(t.scene);a=a.split("&"),a.length&&a.forEach((function(t){-1!=t.indexOf("id")&&(e.id=t.split("-")[1]),-1!=t.indexOf("sku_id")&&(e.skuId=t.split("-")[1]),-1!=t.indexOf("m")&&uni.setStorageSync("source_member",t.split("-")[1]),-1!=t.indexOf("is_test")&&uni.setStorageSync("is_test",1)}))}this.getGameInfo()},onShow:function(){var t=this;if(uni.getStorageSync("token")&&uni.getStorageSync("source_member")&&this.$util.onSourceMember(uni.getStorageSync("source_member")),!this.addonIsExist.cards)return this.$util.showToast({title:"商家未开启刮刮乐",mask:!0,duration:2e3}),void setTimeout((function(){t.$util.redirectTo("/pages/index/index",{},"redirectTo")}),2e3);uni.getStorageSync("token")&&(this.token=uni.getStorageSync("token"),this.getMemberPointInfo())},onShareAppMessage:function(t){var e=this.gameInfo.game_name,a=this.$util.getCurrentShareRoute(this.memberId),n=a.path;return{title:e,path:n,imageUrl:"",success:function(t){},fail:function(t){}}},computed:{storeToken:function(){return this.$store.state.token}},watch:{storeToken:function(t,e){t&&(this.token=uni.getStorageSync("token"),this.getMemberPointInfo(),this.getGameInfo())}},methods:{again:function(){this.$util.redirectTo("/pages_promotion/game/cards",{id:this.id},"redirectTo")},popChange:function(t){this.popState=t.show},getMemberPointInfo:function(){var t=this;this.$api.sendRequest({url:"/api/memberaccount/info",data:{account_type:"point"},success:function(e){e.data&&(t.point=parseInt(e.data.point))}})},createCtx:function(){this.ctx=uni.createCanvasContext("cardsCanvas",this),this.ctx.setFillStyle("#e5e5e5"),this.ctx.fillRect(0,0,this.ctxW,this.ctxH),this.ctx.globalCompositeOperation="destination-out",this.ctx.draw()},contentMove:function(){event.preventDefault(),this.add_point=0},touchMove:function(t){this.add_point=1,t.preventDefault();this.ctxData;this.ctx.beginPath(),this.ctx.arc(t.touches[0].x,t.touches[0].y,10*this.scaleRatio,0,2*Math.PI),this.ctx.globalCompositeOperation="destination-out",this.ctx.setFillStyle("#fff"),this.ctx.fill(),this.ctx.draw(!0)},lottery:function(){var t=this;uni.getStorageSync("token")?1==this.gameInfo.status&&(this.gameInfo.surplus_num<=0?this.$util.showToast({title:"您的抽奖次数已用完"}):this.gameInfo.points>0&&this.point<this.gameInfo.points?this.$util.showToast({title:"积分不足"}):this.isClick||(this.isClick=!0,this.$api.sendRequest({url:"/cards/api/cards/lottery",data:{id:this.id},success:function(e){e.code>=0?(t.showGuide=!1,t.result=e.data,t.point-=t.gameInfo.points,t.gameInfo.surplus_num-=1):t.$util.showToast({title:e.message})}}))):this.$refs.login.open("/pages_promotion/game/cards?id="+this.id)},getGameInfo:function(){var t=this;this.$api.sendRequest({url:"/cards/api/cards/info",data:{id:this.id},success:function(e){e.code>=0&&e.data?(t.gameInfo=e.data,t.$refs.loadingCover&&t.$refs.loadingCover.hide(),t.gameInfo.is_show_winner&&t.gameInfo.draw_record.length>6&&(t.scrollTimer=setInterval(t.scrollRecord,2e3))):(t.$util.showToast({title:"未获取到活动信息！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index",{},"reLaunch")}),1500))},fail:function(e){t.$util.showToast({title:"未获取到活动信息！"}),setTimeout((function(){t.$util.redirectTo("/pages/index/index",{},"reLaunch")}),1500)}})},openRulePopup:function(){this.$refs.rulePopup.open()},closeRulePopup:function(){this.$refs.rulePopup.close()},scrollRecord:function(){var t=this;this.animate=!0,setTimeout((function(){t.gameInfo.draw_record.push(t.gameInfo.draw_record[0]),t.gameInfo.draw_record.shift(),t.animate=!1}),1e3)},reCards:function(){var t=this;if(!this.showGuide){var e={ctxData:null,ctx:null,ctxW:0,ctxH:0,scaleRatio:1,showGuide:!0,gameInfo:{no_winning_desc:"",surplus_num:0},result:{is_winning:0},isClick:!1,point:0,animate:!1,scrollTimer:null};Object.assign(this.$data,e),this.getGameInfo(),uni.getStorageSync("token")&&this.getMemberPointInfo();var a=uni.createSelectorQuery().in(this);a.select("#canvas").boundingClientRect((function(e){t.ctxData=e,t.ctxW=e.width,t.ctxH=e.height,t.createCtx()})).exec()}}},onReady:function(){var t=this,e=uni.createSelectorQuery().in(this);e.select("#canvas").boundingClientRect((function(e){t.ctxData=e,t.ctxW=e.width,t.ctxH=e.height,t.createCtx()})).exec()},filters:{cover:function(t){return t.substr(0,1)+"******"+t.substr(-1)}},onHide:function(){clearInterval(this.scrollTimer)}};e.default=r},cb29:function(t,e,a){var n=a("23e7"),i=a("81d5"),o=a("44d2");n({target:"Array",proto:!0},{fill:i}),o("fill")},d173:function(t,e,a){var n=a("2b06");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("5bbfa59f",n,!0,{sourceMap:!1,shadowMode:!1})},f232:function(t,e,a){"use strict";a.r(e);var n=a("722a"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},f9e1:function(t,e,a){"use strict";var n=a("d173"),i=a.n(n);i.a}}]);